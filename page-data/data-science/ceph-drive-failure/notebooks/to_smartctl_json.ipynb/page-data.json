{"componentChunkName":"component---src-templates-jupyter-notebook-js","path":"/data-science/ceph-drive-failure/notebooks/to_smartctl_json.ipynb","result":{"data":{"site":{"siteMetadata":{"title":"Operate First"}},"jupyterNotebook":{"id":"35a4c291-f3aa-5f67-a6a0-c07b8780e735 >>> JupyterNotebook","html":"<div class=\"notebook-render\"><div class=\"sc-ifAKCX zMCZx\"><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p>Utility notebook to convert df to smartctl json as it will be used in Ceph diskprediction_local predictor.py</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[1]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">import</span> os\n<span class=\"token\" style=\"color:#0000ff\">import</span> gc\n<span class=\"token\" style=\"color:#0000ff\">import</span> pdb\n<span class=\"token\" style=\"color:#0000ff\">import</span> sys\nSRC_PATH <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&#x27;../src&#x27;</span>\n<span class=\"token\" style=\"color:#0000ff\">if</span> SRC_PATH <span class=\"token\" style=\"color:#0000ff\">not</span> <span class=\"token\" style=\"color:#0000ff\">in</span> sys<span class=\"token\" style=\"color:#393A34\">.</span>path<span class=\"token\" style=\"color:#393A34\">:</span>\n    sys<span class=\"token\" style=\"color:#393A34\">.</span>path<span class=\"token\" style=\"color:#393A34\">.</span>insert<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span> SRC_PATH<span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#0000ff\">import</span> utils\n<span class=\"token\" style=\"color:#0000ff\">import</span> pickle\n<span class=\"token\" style=\"color:#0000ff\">import</span> datetime\n\n<span class=\"token\" style=\"color:#0000ff\">import</span> mlflow\n<span class=\"token\" style=\"color:#0000ff\">import</span> pyarrow\n<span class=\"token\" style=\"color:#0000ff\">import</span> numpy <span class=\"token\" style=\"color:#0000ff\">as</span> np\n<span class=\"token\" style=\"color:#0000ff\">import</span> pandas <span class=\"token\" style=\"color:#0000ff\">as</span> pd\n<span class=\"token\" style=\"color:#0000ff\">import</span> dask<span class=\"token\" style=\"color:#393A34\">.</span>dataframe <span class=\"token\" style=\"color:#0000ff\">as</span> dd\n<span class=\"token\" style=\"color:#0000ff\">from</span> dask<span class=\"token\" style=\"color:#393A34\">.</span>diagnostics <span class=\"token\" style=\"color:#0000ff\">import</span> ProgressBar\n<span class=\"token\" style=\"color:#0000ff\">from</span> dask<span class=\"token\" style=\"color:#393A34\">.</span>distributed <span class=\"token\" style=\"color:#0000ff\">import</span> Client\n\n<span class=\"token\" style=\"color:#0000ff\">import</span> joblib\n<span class=\"token\" style=\"color:#0000ff\">from</span> joblib <span class=\"token\" style=\"color:#0000ff\">import</span> parallel_backend<span class=\"token\" style=\"color:#393A34\">,</span> Parallel<span class=\"token\" style=\"color:#393A34\">,</span> delayed</code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[2]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># client = Client()</span>\npbar <span class=\"token\" style=\"color:#393A34\">=</span> ProgressBar<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\npbar<span class=\"token\" style=\"color:#393A34\">.</span>register<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[3]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># define thresholds as timedelta</span>\nBAD_THRESHOLD_NDAYS <span class=\"token\" style=\"color:#393A34\">=</span> np<span class=\"token\" style=\"color:#393A34\">.</span>timedelta64<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">14</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;D&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span>\nWARNING_THRESHOLD_NDAYS <span class=\"token\" style=\"color:#393A34\">=</span> np<span class=\"token\" style=\"color:#393A34\">.</span>timedelta64<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">42</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;D&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>Get Failed Sers with &gt;6 days</h2></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[4]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># read in raw df</span>\nDATA_ROOT_DIR <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&#x27;/home/kachauha/Downloads/&#x27;</span>\ndf <span class=\"token\" style=\"color:#393A34\">=</span> dd<span class=\"token\" style=\"color:#393A34\">.</span>read_parquet<span class=\"token\" style=\"color:#393A34\">(</span>os<span class=\"token\" style=\"color:#393A34\">.</span>path<span class=\"token\" style=\"color:#393A34\">.</span>join<span class=\"token\" style=\"color:#393A34\">(</span>DATA_ROOT_DIR<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;data_Q1_2019_parquet&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> engine<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;pyarrow&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> index<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">False</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># get failed serials data only</span>\nfailed_sers <span class=\"token\" style=\"color:#393A34\">=</span> df<span class=\"token\" style=\"color:#393A34\">[</span>df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;failure&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">==</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>unique<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># serials that have more than 6days of data</span>\nfail_6day_sers <span class=\"token\" style=\"color:#393A34\">=</span> df<span class=\"token\" style=\"color:#393A34\">[</span>df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isin<span class=\"token\" style=\"color:#393A34\">(</span>failed_sers<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>value_counts<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\nfail_6day_sers <span class=\"token\" style=\"color:#393A34\">=</span> fail_6day_sers<span class=\"token\" style=\"color:#393A34\">[</span>fail_6day_sers <span class=\"token\" style=\"color:#393A34\">&gt;</span> <span class=\"token\" style=\"color:#36acaa\">6</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\nwork_6day_sers <span class=\"token\" style=\"color:#393A34\">=</span> df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">~</span>df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isin<span class=\"token\" style=\"color:#393A34\">(</span>failed_sers<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>value_counts<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\nwork_6day_sers <span class=\"token\" style=\"color:#393A34\">=</span> work_6day_sers<span class=\"token\" style=\"color:#393A34\">[</span>work_6day_sers <span class=\"token\" style=\"color:#393A34\">&gt;</span> <span class=\"token\" style=\"color:#36acaa\">6</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># fail_df = df[df[&#x27;serial_number&#x27;].isin(fail_6day_sers.index)]</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># work_df = df[df[&#x27;serial_number&#x27;].isin(work_6day_sers.index)]</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed |  9.9s\n[########################################] | 100% Completed |  9.4s\n[########################################] | 100% Completed | 24.2s\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[5]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># # confirm that, if one entry in row is nan then all of them are</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># (currdf.isna().any()==currdf.isna().all()).all()</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[5]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># convert to dataframe</span>\nwork_6day_sers <span class=\"token\" style=\"color:#393A34\">=</span> work_6day_sers<span class=\"token\" style=\"color:#393A34\">.</span>to_frame<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;count&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span>\nfail_6day_sers <span class=\"token\" style=\"color:#393A34\">=</span> fail_6day_sers<span class=\"token\" style=\"color:#393A34\">.</span>to_frame<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;count&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span>\nfail_6day_sers<span class=\"token\" style=\"color:#393A34\">.</span>head<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>count</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>S301GNWY</th>\n      <td>89</td>\n    </tr>\n    <tr>\n      <th>S2ZYJ9GF302327</th>\n      <td>88</td>\n    </tr>\n    <tr>\n      <th>57GGPD9TT</th>\n      <td>88</td>\n    </tr>\n    <tr>\n      <th>S301NGZN</th>\n      <td>88</td>\n    </tr>\n    <tr>\n      <th>ZCH02Z5J</th>\n      <td>88</td>\n    </tr>\n  </tbody>\n</table>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[29]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># sample a fraction of serials of each frequency category</span>\nsample_sers_vc <span class=\"token\" style=\"color:#393A34\">=</span> work_6day_sers<span class=\"token\" style=\"color:#393A34\">.</span>groupby<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;count&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">apply</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#0000ff\">lambda</span> g<span class=\"token\" style=\"color:#393A34\">:</span> g<span class=\"token\" style=\"color:#393A34\">.</span>sample<span class=\"token\" style=\"color:#393A34\">(</span>frac<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0.025</span><span class=\"token\" style=\"color:#393A34\">/</span><span class=\"token\" style=\"color:#36acaa\">7</span><span class=\"token\" style=\"color:#393A34\">,</span> random_state<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">42</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>index<span class=\"token\" style=\"color:#393A34\">)</span>\nwork_sample_sers <span class=\"token\" style=\"color:#393A34\">=</span> np<span class=\"token\" style=\"color:#393A34\">.</span>unique<span class=\"token\" style=\"color:#393A34\">(</span>np<span class=\"token\" style=\"color:#393A34\">.</span>hstack<span class=\"token\" style=\"color:#393A34\">(</span>sample_sers_vc<span class=\"token\" style=\"color:#393A34\">.</span>values<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>tolist<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>work_sample_sers<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>401</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[30]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># sample a fraction of serials of each frequency category</span>\nsample_sers_vc <span class=\"token\" style=\"color:#393A34\">=</span> fail_6day_sers<span class=\"token\" style=\"color:#393A34\">.</span>groupby<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;count&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">apply</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#0000ff\">lambda</span> g<span class=\"token\" style=\"color:#393A34\">:</span> g<span class=\"token\" style=\"color:#393A34\">.</span>sample<span class=\"token\" style=\"color:#393A34\">(</span>frac<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0.075</span><span class=\"token\" style=\"color:#393A34\">/</span><span class=\"token\" style=\"color:#36acaa\">1.5</span><span class=\"token\" style=\"color:#393A34\">,</span> random_state<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">42</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>index<span class=\"token\" style=\"color:#393A34\">)</span>\nfail_sample_sers <span class=\"token\" style=\"color:#393A34\">=</span> np<span class=\"token\" style=\"color:#393A34\">.</span>unique<span class=\"token\" style=\"color:#393A34\">(</span>np<span class=\"token\" style=\"color:#393A34\">.</span>hstack<span class=\"token\" style=\"color:#393A34\">(</span>sample_sers_vc<span class=\"token\" style=\"color:#393A34\">.</span>values<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>tolist<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>fail_sample_sers<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>4</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[31]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># ratio of working to fail drives</span>\n<span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>work_sample_sers<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">/</span> <span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>work_sample_sers<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">+</span> <span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>fail_sample_sers<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>0.9901234567901235</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>Convert to smartctl json and save</h2></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[32]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># timestamp to save data with</span>\nts <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">str</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">int</span><span class=\"token\" style=\"color:#393A34\">(</span>datetime<span class=\"token\" style=\"color:#393A34\">.</span>datetime<span class=\"token\" style=\"color:#393A34\">.</span>now<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>timestamp<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[34]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">fail_sample_sers_df <span class=\"token\" style=\"color:#393A34\">=</span> df<span class=\"token\" style=\"color:#393A34\">[</span>df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isin<span class=\"token\" style=\"color:#393A34\">(</span>fail_sample_sers<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\nall_fail_sers_dict <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#0000ff\">for</span> iser<span class=\"token\" style=\"color:#393A34\">,</span> ser <span class=\"token\" style=\"color:#0000ff\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token\" style=\"color:#393A34\">(</span>fail_sample_sers<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&#x27;Converting serial </span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>ser<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">, </span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">+</span>iser<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">/</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>fail_sample_sers<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">&#x27;</span></span><span class=\"token\" style=\"color:#393A34\">)</span>\n    currdf <span class=\"token\" style=\"color:#393A34\">=</span> fail_sample_sers_df<span class=\"token\" style=\"color:#393A34\">[</span>fail_sample_sers_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">==</span>ser<span class=\"token\" style=\"color:#393A34\">]</span>\n\n    <span class=\"token\" style=\"color:#008000;font-style:italic\"># keep only cols that have all non nan values</span>\n    isnotnancol <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">~</span>currdf<span class=\"token\" style=\"color:#393A34\">.</span>isna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">all</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    isnotnancol <span class=\"token\" style=\"color:#393A34\">=</span> isnotnancol<span class=\"token\" style=\"color:#393A34\">[</span>isnotnancol<span class=\"token\" style=\"color:#393A34\">==</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>index\n    currdf <span class=\"token\" style=\"color:#393A34\">=</span> currdf<span class=\"token\" style=\"color:#393A34\">[</span>isnotnancol<span class=\"token\" style=\"color:#393A34\">]</span>\n    <span class=\"token\" style=\"color:#0000ff\">if</span> currdf<span class=\"token\" style=\"color:#393A34\">.</span>isna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">any</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">any</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&#x27;nans found in </span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>ser<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">. Skipping adding its data&#x27;</span></span><span class=\"token\" style=\"color:#393A34\">)</span>\n        <span class=\"token\" style=\"color:#0000ff\">continue</span>\n\n    <span class=\"token\" style=\"color:#008000;font-style:italic\"># assuming this data is not corrupted</span>\n    <span class=\"token\" style=\"color:#008000;font-style:italic\"># and therefore is same across all rows</span>\n    model <span class=\"token\" style=\"color:#393A34\">=</span> currdf<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;model&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>iloc<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span>\n    cap <span class=\"token\" style=\"color:#393A34\">=</span> currdf<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;capacity_bytes&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>iloc<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span>\n\n    <span class=\"token\" style=\"color:#008000;font-style:italic\"># build up dict datewise</span>\n    attr_ids <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">set</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">int</span><span class=\"token\" style=\"color:#393A34\">(</span>col<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">6</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">4</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#0000ff\">for</span> col <span class=\"token\" style=\"color:#0000ff\">in</span> currdf<span class=\"token\" style=\"color:#393A34\">.</span>columns <span class=\"token\" style=\"color:#0000ff\">if</span> col<span class=\"token\" style=\"color:#393A34\">.</span>endswith<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    serdict <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    <span class=\"token\" style=\"color:#0000ff\">for</span> _<span class=\"token\" style=\"color:#393A34\">,</span> rowdata <span class=\"token\" style=\"color:#0000ff\">in</span> currdf<span class=\"token\" style=\"color:#393A34\">.</span>iterrows<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        <span class=\"token\" style=\"color:#008000;font-style:italic\"># init datedict</span>\n        datedict <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">{</span>\n            <span class=\"token\" style=\"color:#A31515\">&#x27;model_name&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> model<span class=\"token\" style=\"color:#393A34\">,</span>\n            <span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> ser<span class=\"token\" style=\"color:#393A34\">,</span>\n            <span class=\"token\" style=\"color:#A31515\">&#x27;model_family&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> model<span class=\"token\" style=\"color:#393A34\">,</span>\n            <span class=\"token\" style=\"color:#A31515\">&#x27;user_capacity&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;bytes&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> cap<span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            <span class=\"token\" style=\"color:#A31515\">&#x27;ata_smart_attributes&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;table&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">None</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">*</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>attr_ids<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">}</span>\n        <span class=\"token\" style=\"color:#393A34\">}</span>\n        <span class=\"token\" style=\"color:#0000ff\">for</span> i<span class=\"token\" style=\"color:#393A34\">,</span> aid <span class=\"token\" style=\"color:#0000ff\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token\" style=\"color:#393A34\">(</span>attr_ids<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n            datedict<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;ata_smart_attributes&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;table&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span>i<span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;id&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> aid<span class=\"token\" style=\"color:#393A34\">,</span>\n                                                            <span class=\"token\" style=\"color:#A31515\">&#x27;value&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> rowdata<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&#x27;smart_</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>aid<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">_normalized&#x27;</span></span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span>\n                                                            <span class=\"token\" style=\"color:#A31515\">&#x27;raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;value&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> rowdata<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&#x27;smart_</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>aid<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">_raw&#x27;</span></span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span>\n                                                                    <span class=\"token\" style=\"color:#A31515\">&#x27;string&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token builtin\">str</span><span class=\"token\" style=\"color:#393A34\">(</span>rowdata<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&#x27;smart_</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>aid<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">_raw&#x27;</span></span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">}</span>\n        serdict<span class=\"token\" style=\"color:#393A34\">[</span>rowdata<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;date&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">=</span> datedict\n    all_fail_sers_dict<span class=\"token\" style=\"color:#393A34\">[</span>ser<span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">=</span> serdict</code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>Converting serial Z305758R, 1/4\n[########################################] | 100% Completed | 10.5s\nConverting serial ZA1818RN, 2/4\n[########################################] | 100% Completed | 10.2s\nConverting serial ZCH02LQX, 3/4\n[########################################] | 100% Completed |  9.8s\nConverting serial ZJV009V2, 4/4\n[########################################] | 100% Completed | 10.6s\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[35]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">with</span> <span class=\"token builtin\">open</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&#x27;q1_2019_failed_drive_datas_</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>ts<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">.pkl&#x27;</span></span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;wb&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#0000ff\">as</span> f<span class=\"token\" style=\"color:#393A34\">:</span>\n    pickle<span class=\"token\" style=\"color:#393A34\">.</span>dump<span class=\"token\" style=\"color:#393A34\">(</span>all_fail_sers_dict<span class=\"token\" style=\"color:#393A34\">,</span> f<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[36]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">work_sample_sers_df <span class=\"token\" style=\"color:#393A34\">=</span> df<span class=\"token\" style=\"color:#393A34\">[</span>df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isin<span class=\"token\" style=\"color:#393A34\">(</span>work_sample_sers<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\nall_work_sers_dict <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#0000ff\">for</span> iser<span class=\"token\" style=\"color:#393A34\">,</span> ser <span class=\"token\" style=\"color:#0000ff\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token\" style=\"color:#393A34\">(</span>work_sample_sers<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&#x27;Converting serial </span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>ser<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">, </span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">+</span>iser<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">/</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>work_sample_sers<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">&#x27;</span></span><span class=\"token\" style=\"color:#393A34\">)</span>\n    currdf <span class=\"token\" style=\"color:#393A34\">=</span> work_sample_sers_df<span class=\"token\" style=\"color:#393A34\">[</span>work_sample_sers_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">==</span>ser<span class=\"token\" style=\"color:#393A34\">]</span>\n\n    <span class=\"token\" style=\"color:#008000;font-style:italic\"># keep only cols that have at least one non nan value</span>\n    isnotnancol <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">~</span>currdf<span class=\"token\" style=\"color:#393A34\">.</span>isna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">all</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    isnotnancol <span class=\"token\" style=\"color:#393A34\">=</span> isnotnancol<span class=\"token\" style=\"color:#393A34\">[</span>isnotnancol<span class=\"token\" style=\"color:#393A34\">==</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>index\n    currdf <span class=\"token\" style=\"color:#393A34\">=</span> currdf<span class=\"token\" style=\"color:#393A34\">[</span>isnotnancol<span class=\"token\" style=\"color:#393A34\">]</span>\n    <span class=\"token\" style=\"color:#0000ff\">if</span> currdf<span class=\"token\" style=\"color:#393A34\">.</span>isna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">any</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">any</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&#x27;nans found in </span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>ser<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">. Skipping adding its data&#x27;</span></span><span class=\"token\" style=\"color:#393A34\">)</span>\n        <span class=\"token\" style=\"color:#0000ff\">continue</span>\n\n    <span class=\"token\" style=\"color:#008000;font-style:italic\"># assuming this data is not corrupted</span>\n    <span class=\"token\" style=\"color:#008000;font-style:italic\"># and therefore is same across all rows</span>\n    model <span class=\"token\" style=\"color:#393A34\">=</span> currdf<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;model&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>iloc<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span>\n    cap <span class=\"token\" style=\"color:#393A34\">=</span> currdf<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;capacity_bytes&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>iloc<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span>\n\n    <span class=\"token\" style=\"color:#008000;font-style:italic\"># build up dict datewise</span>\n    attr_ids <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">set</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">int</span><span class=\"token\" style=\"color:#393A34\">(</span>col<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">6</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">4</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#0000ff\">for</span> col <span class=\"token\" style=\"color:#0000ff\">in</span> currdf<span class=\"token\" style=\"color:#393A34\">.</span>columns <span class=\"token\" style=\"color:#0000ff\">if</span> col<span class=\"token\" style=\"color:#393A34\">.</span>endswith<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    serdict <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    <span class=\"token\" style=\"color:#0000ff\">for</span> _<span class=\"token\" style=\"color:#393A34\">,</span> rowdata <span class=\"token\" style=\"color:#0000ff\">in</span> currdf<span class=\"token\" style=\"color:#393A34\">.</span>iterrows<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        <span class=\"token\" style=\"color:#008000;font-style:italic\"># init datedict</span>\n        datedict <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">{</span>\n            <span class=\"token\" style=\"color:#A31515\">&#x27;model_name&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> model<span class=\"token\" style=\"color:#393A34\">,</span>\n            <span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> ser<span class=\"token\" style=\"color:#393A34\">,</span>\n            <span class=\"token\" style=\"color:#A31515\">&#x27;model_family&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> model<span class=\"token\" style=\"color:#393A34\">,</span>\n            <span class=\"token\" style=\"color:#A31515\">&#x27;user_capacity&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;bytes&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> cap<span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            <span class=\"token\" style=\"color:#A31515\">&#x27;ata_smart_attributes&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;table&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">None</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">*</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span>attr_ids<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">}</span>\n        <span class=\"token\" style=\"color:#393A34\">}</span>\n        <span class=\"token\" style=\"color:#0000ff\">for</span> i<span class=\"token\" style=\"color:#393A34\">,</span> aid <span class=\"token\" style=\"color:#0000ff\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token\" style=\"color:#393A34\">(</span>attr_ids<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n            datedict<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;ata_smart_attributes&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;table&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span>i<span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;id&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> aid<span class=\"token\" style=\"color:#393A34\">,</span>\n                                                            <span class=\"token\" style=\"color:#A31515\">&#x27;value&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> rowdata<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&#x27;smart_</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>aid<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">_normalized&#x27;</span></span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span>\n                                                            <span class=\"token\" style=\"color:#A31515\">&#x27;raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;value&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> rowdata<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&#x27;smart_</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>aid<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">_raw&#x27;</span></span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span>\n                                                                    <span class=\"token\" style=\"color:#A31515\">&#x27;string&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token builtin\">str</span><span class=\"token\" style=\"color:#393A34\">(</span>rowdata<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&#x27;smart_</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>aid<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">_raw&#x27;</span></span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">}</span>\n        serdict<span class=\"token\" style=\"color:#393A34\">[</span>rowdata<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;date&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">=</span> datedict\n    all_work_sers_dict<span class=\"token\" style=\"color:#393A34\">[</span>ser<span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">=</span> serdict</code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed | 10.1s\nConverting serial 564ESIZES, 1/401\nConverting serial 78B0A00AF97G, 2/401\nConverting serial 78B0A05BF97G, 3/401\nConverting serial 78C0A04GF97G, 4/401\nnans found in 78C0A04GF97G. Skipping adding its data\nConverting serial 84BGK000FMYB, 5/401\nConverting serial 88P0A062F97G, 6/401\nConverting serial 88P0A06JF97G, 7/401\nConverting serial 8CGDKMWH, 8/401\nConverting serial 8CGDR5SH, 9/401\nConverting serial 8HJKA0KH, 10/401\nConverting serial 8HJPTXBH, 11/401\nConverting serial 8HKADH9H, 12/401\nConverting serial AAG1PLUH, 13/401\nConverting serial AAG2SUKH, 14/401\nConverting serial AAG2WSYH, 15/401\nConverting serial AAG6B7DH, 16/401\nConverting serial AAG6DT9H, 17/401\nConverting serial AAG6KW1H, 18/401\nConverting serial AAG6TG5H, 19/401\nnans found in AAG6TG5H. Skipping adding its data\nConverting serial AAG6Z3AH, 20/401\nConverting serial AAG73ZWH, 21/401\nConverting serial PL1331LAGA0LNH, 22/401\nConverting serial PL1331LAGA0WNH, 23/401\nConverting serial PL1331LAGA6E0H, 24/401\nConverting serial PL1331LAGBZ1VH, 25/401\nConverting serial PL1331LAGLZK8H, 26/401\nConverting serial PL1331LAGM1HKH, 27/401\nConverting serial PL1331LAGM2U5H, 28/401\nConverting serial PL1331LAGM2X0H, 29/401\nConverting serial PL1331LAGM390H, 30/401\nConverting serial PL1331LAGRAHTH, 31/401\nConverting serial PL1331LAGRDLHH, 32/401\nConverting serial PL1331LAGRS2GH, 33/401\nConverting serial PL1331LAGS1UXH, 34/401\nConverting serial PL1331LAGSPH5H, 35/401\nConverting serial PL1331LAGSX6KH, 36/401\nConverting serial PL1331LAGT3TPH, 37/401\nConverting serial PL1331LAGTWEEH, 38/401\nConverting serial PL1331LAGU37LH, 39/401\nConverting serial PL1331LAH15XZH, 40/401\nConverting serial PL1331LAH3PZ5H, 41/401\nConverting serial PL1331LAHBGKUH, 42/401\nConverting serial PL1331LAHBGTMH, 43/401\nConverting serial PL1331LAHBVGAH, 44/401\nConverting serial PL1331LAHBZ8BH, 45/401\nConverting serial PL1331LAHBZSWH, 46/401\nConverting serial PL1331LAHBZYZH, 47/401\nConverting serial PL1331LAHD13GH, 48/401\nConverting serial PL1331LAHD19KH, 49/401\nConverting serial PL1331LAHD1A3H, 50/401\nConverting serial PL1331LAHD1PBH, 51/401\nConverting serial PL1331LAHD20MH, 52/401\nConverting serial PL1331LAHD342H, 53/401\nConverting serial PL1331LAHD3NSH, 54/401\nConverting serial PL1331LAHD435H, 55/401\nConverting serial PL1331LAHD4SLH, 56/401\nConverting serial PL1331LAHD4XVH, 57/401\nConverting serial PL1331LAHD608H, 58/401\nConverting serial PL1331LAHD6WPH, 59/401\nConverting serial PL1331LAHD8HZH, 60/401\nConverting serial PL1331LAHD9H3H, 61/401\nConverting serial PL1331LAHE8YHH, 62/401\nConverting serial PL1331LAHEPT9H, 63/401\nConverting serial PL1331LAHG1JDH, 64/401\nConverting serial PL1331LAHGVU5H, 65/401\nConverting serial PL1331LAHGY94H, 66/401\nConverting serial PL2331LAGMDUSJ, 67/401\nConverting serial PL2331LAGN7E4J, 68/401\nConverting serial PL2331LAGSTB0J, 69/401\nConverting serial PL2331LAGSUJPJ, 70/401\nConverting serial PL2331LAGUJLEJ, 71/401\nConverting serial PL2331LAGUM4DJ, 72/401\nConverting serial PL2331LAH3A3BJ, 73/401\nConverting serial PL2331LAH3D34J, 74/401\nConverting serial PL2331LAH3WP9J, 75/401\nConverting serial PL2331LAH3Z89J, 76/401\nConverting serial PL2331LAH427VJ, 77/401\nConverting serial PL2331LAH453TJ, 78/401\nConverting serial PL2331LAH6SNZJ, 79/401\nConverting serial PL2331LAHB9TEJ, 80/401\nConverting serial PL2331LAHBSYMJ, 81/401\nConverting serial PL2331LAHBWU5J, 82/401\nConverting serial PL2331LAHBX22J, 83/401\nConverting serial PL2331LAHD9T5J, 84/401\nConverting serial PL2331LAHD9VHJ, 85/401\nConverting serial PL2331LAHDAU6J, 86/401\nConverting serial PL2331LAHDAWKJ, 87/401\nConverting serial PL2331LAHDBHYJ, 88/401\nConverting serial PL2331LAHDBSEJ, 89/401\nConverting serial PL2331LAHDD2SJ, 90/401\nConverting serial PL2331LAHDE6BJ, 91/401\nConverting serial PL2331LAHDEDJJ, 92/401\nConverting serial PL2331LAHDEV5J, 93/401\nConverting serial PL2331LAHDKS3J, 94/401\nConverting serial PL2331LAHDKXGJ, 95/401\nConverting serial PL2331LAHDMJ2J, 96/401\nConverting serial PL2331LAHDSBUJ, 97/401\nConverting serial PL2331LAHDSURJ, 98/401\nConverting serial PL2331LAHDUBNJ, 99/401\nConverting serial PL2331LAHDUJMJ, 100/401\nConverting serial PL2331LAHDURGJ, 101/401\nConverting serial PL2331LAHDUV4J, 102/401\nConverting serial PL2331LAHDWBRJ, 103/401\nConverting serial PL2331LAHDX7LJ, 104/401\nConverting serial S2ZYJ9DFA03923, 105/401\nConverting serial S2ZYJ9FG404780, 106/401\nConverting serial S300GE0B, 107/401\nConverting serial S300VLH5, 108/401\nConverting serial S300WEXQ, 109/401\nConverting serial S300XB11, 110/401\nConverting serial S300XCC2, 111/401\nConverting serial S300XRA6, 112/401\nConverting serial S300YBSR, 113/401\nConverting serial S300YBZ2, 114/401\nConverting serial S300Z480, 115/401\nConverting serial S300Z4TV, 116/401\nConverting serial S300Z51A, 117/401\nConverting serial S300Z5JC, 118/401\nConverting serial S300Z675, 119/401\nConverting serial S300Z69T, 120/401\nConverting serial S300Z6S6, 121/401\nConverting serial S300Z9T5, 122/401\nConverting serial S3010ME1, 123/401\nConverting serial S301GQN7, 124/401\nConverting serial S301KZG2, 125/401\nConverting serial S301PRNQ, 126/401\nConverting serial VKGJE29X, 127/401\nConverting serial VKGKNY7X, 128/401\nConverting serial VKGMGPHX, 129/401\nConverting serial WD-WX11D4423536, 130/401\nConverting serial Z3021P52, 131/401\nConverting serial Z302527M, 132/401\nConverting serial Z302594V, 133/401\nConverting serial Z3025PK9, 134/401\nConverting serial Z3025VZN, 135/401\nConverting serial Z3029ATT, 136/401\nConverting serial Z302A0ZC, 137/401\nConverting serial Z302AL5T, 138/401\nConverting serial Z302B1NQ, 139/401\nConverting serial Z302BSD9, 140/401\nConverting serial Z302EPW1, 141/401\nConverting serial Z302F27G, 142/401\nConverting serial Z302SW2G, 143/401\nConverting serial Z302SW4G, 144/401\nConverting serial Z302SX6Q, 145/401\nConverting serial Z302SX6V, 146/401\nConverting serial Z302SZCL, 147/401\nConverting serial Z302SZGS, 148/401\nConverting serial Z302T8KW, 149/401\nConverting serial Z302T8SV, 150/401\nConverting serial Z303H7G4, 151/401\nConverting serial Z3040E9R, 152/401\nConverting serial Z3041KBE, 153/401\nConverting serial Z304HKH4, 154/401\nConverting serial Z304HKX4, 155/401\nConverting serial Z304HVZN, 156/401\nConverting serial Z304HZ07, 157/401\nConverting serial Z304JFZ5, 158/401\nConverting serial Z304JGCZ, 159/401\nConverting serial Z304JXBH, 160/401\nConverting serial Z304KC96, 161/401\nConverting serial Z304KC9E, 162/401\nConverting serial Z304KDG1, 163/401\nConverting serial Z304L852, 164/401\nConverting serial Z304L8JR, 165/401\nConverting serial Z304L8TL, 166/401\nConverting serial Z304L9LH, 167/401\nConverting serial Z3051S6X, 168/401\nConverting serial Z3053JWR, 169/401\nConverting serial Z3054F3Q, 170/401\nConverting serial Z3058RQG, 171/401\nConverting serial Z3059D3M, 172/401\nConverting serial Z305AQSS, 173/401\nConverting serial Z305AQTL, 174/401\nConverting serial Z305AT8A, 175/401\nConverting serial Z305CK8N, 176/401\nConverting serial Z305D2MJ, 177/401\nConverting serial Z305D2MP, 178/401\nConverting serial Z305D6HY, 179/401\nConverting serial Z305D6P8, 180/401\nConverting serial Z305DELL, 181/401\nConverting serial Z305DW4S, 182/401\nConverting serial Z305ERGD, 183/401\nConverting serial Z305FABX, 184/401\nConverting serial Z305FS96, 185/401\nConverting serial Z305GS5Z, 186/401\nConverting serial Z305GTZK, 187/401\nConverting serial Z305GVYY, 188/401\nConverting serial Z305GXH9, 189/401\nConverting serial Z305HHRJ, 190/401\nConverting serial Z305K1XJ, 191/401\nConverting serial Z305MH7V, 192/401\nConverting serial Z305PHE9, 193/401\nConverting serial Z4D04CDQ, 194/401\nConverting serial Z4D05WD3, 195/401\nConverting serial Z4D0630L, 196/401\nConverting serial Z4D06978, 197/401\nConverting serial Z4D07DT2, 198/401\nConverting serial Z4D082B4, 199/401\nConverting serial Z4D08R88, 200/401\nConverting serial ZA10B8S2, 201/401\nConverting serial ZA10BH4W, 202/401\nConverting serial ZA10J21N, 203/401\nConverting serial ZA10RYDX, 204/401\nConverting serial ZA10WT1V, 205/401\nConverting serial ZA111G44, 206/401\nConverting serial ZA115TZC, 207/401\nConverting serial ZA11LZ0A, 208/401\nConverting serial ZA11MY2T, 209/401\nConverting serial ZA11PEHA, 210/401\nConverting serial ZA11TLS5, 211/401\nConverting serial ZA11YGNJ, 212/401\nConverting serial ZA11YKEB, 213/401\nConverting serial ZA120A6R, 214/401\nConverting serial ZA120G0B, 215/401\nConverting serial ZA121AAA, 216/401\nConverting serial ZA12470C, 217/401\nConverting serial ZA124BJW, 218/401\nConverting serial ZA1261W3, 219/401\nConverting serial ZA127XY7, 220/401\nConverting serial ZA1299CJ, 221/401\nConverting serial ZA12B3N1, 222/401\nConverting serial ZA12JTE1, 223/401\nConverting serial ZA12KEDL, 224/401\nConverting serial ZA12KEE9, 225/401\nConverting serial ZA12KEF4, 226/401\nConverting serial ZA12KZ31, 227/401\nConverting serial ZA12Q5VK, 228/401\nConverting serial ZA12Q659, 229/401\nConverting serial ZA12RAJS, 230/401\nConverting serial ZA12RB8F, 231/401\nConverting serial ZA12Z6R3, 232/401\nConverting serial ZA134MV9, 233/401\nConverting serial ZA13F72K, 234/401\nConverting serial ZA13GZDS, 235/401\nConverting serial ZA13GZEC, 236/401\nConverting serial ZA13R36L, 237/401\nConverting serial ZA13R3VE, 238/401\nConverting serial ZA13YPBB, 239/401\nConverting serial ZA13YPEA, 240/401\nConverting serial ZA13YPT8, 241/401\nConverting serial ZA13Z81Q, 242/401\nConverting serial ZA13ZBAD, 243/401\nConverting serial ZA13ZBDN, 244/401\nConverting serial ZA13ZRX4, 245/401\nConverting serial ZA13ZRYR, 246/401\nConverting serial ZA13ZSWN, 247/401\nConverting serial ZA1438LN, 248/401\nConverting serial ZA143CTC, 249/401\nConverting serial ZA144SXN, 250/401\nConverting serial ZA149FZM, 251/401\nConverting serial ZA14DM03, 252/401\nConverting serial ZA14ECN5, 253/401\nConverting serial ZA14ECSD, 254/401\nConverting serial ZA14F2T2, 255/401\nConverting serial ZA153S8K, 256/401\nConverting serial ZA154VEP, 257/401\nConverting serial ZA15533N, 258/401\nConverting serial ZA1659HC, 259/401\nConverting serial ZA16DE98, 260/401\nConverting serial ZA16DT2R, 261/401\nConverting serial ZA16DT38, 262/401\nConverting serial ZA16EEH0, 263/401\nConverting serial ZA16K90Z, 264/401\nConverting serial ZA16T4WV, 265/401\nConverting serial ZA172BW5, 266/401\nConverting serial ZA174BM5, 267/401\nConverting serial ZA174H86, 268/401\nConverting serial ZA174KAK, 269/401\nConverting serial ZA174MMA, 270/401\nConverting serial ZA17AAWH, 271/401\nConverting serial ZA180QCP, 272/401\nConverting serial ZA180QE0, 273/401\nConverting serial ZA180XWK, 274/401\nConverting serial ZA180YKM, 275/401\nConverting serial ZA180YSN, 276/401\nConverting serial ZA180ZHZ, 277/401\nConverting serial ZA1810K9, 278/401\nConverting serial ZA1814BX, 279/401\nConverting serial ZA1814HT, 280/401\nConverting serial ZA1818M2, 281/401\nConverting serial ZA1819FJ, 282/401\nConverting serial ZA181JHT, 283/401\nConverting serial ZA189HWB, 284/401\nConverting serial ZA189JCD, 285/401\nConverting serial ZA189K8F, 286/401\nConverting serial ZA189MJ6, 287/401\nConverting serial ZA18A81R, 288/401\nConverting serial ZA18BV2A, 289/401\nConverting serial ZA18CDE1, 290/401\nConverting serial ZA18CF1J, 291/401\nConverting serial ZA213PTK, 292/401\nConverting serial ZA216WYH, 293/401\nConverting serial ZA219169, 294/401\nConverting serial ZA21A9YH, 295/401\nConverting serial ZA21DTL2, 296/401\nConverting serial ZA21DYW4, 297/401\nConverting serial ZA21E28Q, 298/401\nConverting serial ZCH01680, 299/401\nConverting serial ZCH037K5, 300/401\nConverting serial ZCH04RTE, 301/401\nConverting serial ZCH05YKE, 302/401\nConverting serial ZCH06FA0, 303/401\nConverting serial ZCH06H7W, 304/401\nConverting serial ZCH06HGC, 305/401\nConverting serial ZCH06KVY, 306/401\nConverting serial ZCH06L19, 307/401\nConverting serial ZCH06LCR, 308/401\nConverting serial ZCH06V01, 309/401\nConverting serial ZCH06W02, 310/401\nConverting serial ZCH06WP4, 311/401\nConverting serial ZCH06YQ9, 312/401\nConverting serial ZCH07066, 313/401\nConverting serial ZCH070Q6, 314/401\nConverting serial ZCH0727F, 315/401\nConverting serial ZCH073FK, 316/401\nConverting serial ZCH076ZY, 317/401\nConverting serial ZCH07F2C, 318/401\nConverting serial ZCH07FNB, 319/401\nConverting serial ZCH07H9A, 320/401\nConverting serial ZCH07N5V, 321/401\nConverting serial ZCH07S0Y, 322/401\nConverting serial ZCH07W5E, 323/401\nConverting serial ZCH0802V, 324/401\nConverting serial ZCH0814L, 325/401\nConverting serial ZCH0819Y, 326/401\nConverting serial ZCH081NG, 327/401\nConverting serial ZCH084B8, 328/401\nConverting serial ZCH08A75, 329/401\nConverting serial ZCH08BJA, 330/401\nConverting serial ZCH09EHX, 331/401\nConverting serial ZCH09H38, 332/401\nConverting serial ZCH09N5K, 333/401\nConverting serial ZCH09RJS, 334/401\nConverting serial ZCH0A2KT, 335/401\nConverting serial ZCH0AJQJ, 336/401\nConverting serial ZCH0BNB1, 337/401\nConverting serial ZCH0BWR3, 338/401\nConverting serial ZCH0CCQH, 339/401\nConverting serial ZCH0CFRV, 340/401\nConverting serial ZCH0CK61, 341/401\nConverting serial ZCH0CK7H, 342/401\nConverting serial ZCH0CYKD, 343/401\nConverting serial ZCH0CYVL, 344/401\nConverting serial ZCH0DMRG, 345/401\nConverting serial ZGY11AM6, 346/401\nConverting serial ZJV001H3, 347/401\nConverting serial ZJV005HL, 348/401\nConverting serial ZJV009XQ, 349/401\nConverting serial ZJV00DFD, 350/401\nConverting serial ZJV00W69, 351/401\nConverting serial ZJV01W6Y, 352/401\nConverting serial ZJV01XXD, 353/401\nConverting serial ZJV02WR1, 354/401\nConverting serial ZJV03FBC, 355/401\nConverting serial ZJV03JBP, 356/401\nConverting serial ZJV03JRR, 357/401\nConverting serial ZJV03VRW, 358/401\nConverting serial ZJV04QKG, 359/401\nConverting serial ZJV0BC8D, 360/401\nConverting serial ZJV0BP0Y, 361/401\nConverting serial ZJV0CPE4, 362/401\nConverting serial ZJV0H9QS, 363/401\nConverting serial ZJV0HC09, 364/401\nConverting serial ZJV0HKJV, 365/401\nConverting serial ZJV0JK62, 366/401\nConverting serial ZJV0LCED, 367/401\nConverting serial ZJV0NZ8P, 368/401\nConverting serial ZJV0PBTC, 369/401\nConverting serial ZJV0TC6H, 370/401\nConverting serial ZJV0TC6T, 371/401\nConverting serial ZJV0TQT8, 372/401\nConverting serial ZJV0WBY6, 373/401\nConverting serial ZJV0WEYQ, 374/401\nConverting serial ZJV0WF7H, 375/401\nConverting serial ZJV0WGSZ, 376/401\nConverting serial ZJV10J7P, 377/401\nConverting serial ZJV10QVQ, 378/401\nConverting serial ZJV10SSH, 379/401\nConverting serial ZJV1144F, 380/401\nConverting serial ZJV116KV, 381/401\nConverting serial ZJV1CGTV, 382/401\nConverting serial ZJV1CGXS, 383/401\nConverting serial ZJV1CGZY, 384/401\nConverting serial ZJV1CS2R, 385/401\nConverting serial ZJV1CSEZ, 386/401\nConverting serial ZJV1GZ4X, 387/401\nConverting serial ZJV1KY1H, 388/401\nConverting serial ZJV1ZKT4, 389/401\nConverting serial ZJV1ZL1Y, 390/401\nConverting serial ZJV2DSMV, 391/401\nConverting serial ZJV2E0W0, 392/401\nConverting serial ZJV2E4DD, 393/401\nConverting serial ZJV2E87R, 394/401\nConverting serial ZJV2EF2F, 395/401\nConverting serial ZJV2EMVV, 396/401\nConverting serial ZJV2EN7B, 397/401\nConverting serial ZJV2ENKP, 398/401\nConverting serial ZJV2EQD3, 399/401\nConverting serial ZJV2ESBY, 400/401\nConverting serial ZJV2FRZT, 401/401\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[37]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">with</span> <span class=\"token builtin\">open</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token string-interpolation\"><span class=\"token\" style=\"color:#A31515\">f&#x27;q1_2019_working_drive_datas_</span><span class=\"token interpolation\"><span class=\"token\" style=\"color:#393A34\">{</span>ts<span class=\"token\" style=\"color:#393A34\">}</span></span><span class=\"token\" style=\"color:#A31515\">.pkl&#x27;</span></span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;wb&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#0000ff\">as</span> f<span class=\"token\" style=\"color:#393A34\">:</span>\n    pickle<span class=\"token\" style=\"color:#393A34\">.</span>dump<span class=\"token\" style=\"color:#393A34\">(</span>all_work_sers_dict<span class=\"token\" style=\"color:#393A34\">,</span> f<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[ ]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"></code></pre></div></div></div></div>","fields":{"srcLink":"https://github.com/aicoe-aiops/ceph_drive_failure/blob/master/notebooks/to_smartctl_json.ipynb"}}},"pageContext":{"id":"35a4c291-f3aa-5f67-a6a0-c07b8780e735 >>> JupyterNotebook"}},"staticQueryHashes":["117426894","3000541721"]}