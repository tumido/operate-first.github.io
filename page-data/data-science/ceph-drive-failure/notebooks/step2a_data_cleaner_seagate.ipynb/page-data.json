{"componentChunkName":"component---src-templates-jupyter-notebook-js","path":"/data-science/ceph-drive-failure/notebooks/step2a_data_cleaner_seagate.ipynb","result":{"data":{"site":{"siteMetadata":{"title":"Operate First"}},"jupyterNotebook":{"id":"503f4e39-c0d1-5c65-9b67-d8cec746d84a >>> JupyterNotebook","html":"<div class=\"notebook-render\"><div class=\"sc-ifAKCX zMCZx\"><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h1>Step 2: Clean Up Data</h1>\n<p>In the previous step, the data was explored and it was found that the patterns in the data are quite different for each vendor. Therefore, in this notebook the data is cleaned up and analyzed for a specific vendor - Seagate. Seagate is chosen because it forms the majority in the backblaze dataset (~7M out of ~9M points).</p>\n<p>The clean up in this notebook mainly consists of removing/replacing NaN values intelligently.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[10]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">import</span> gc\n<span class=\"token\" style=\"color:#0000ff\">import</span> os\n<span class=\"token\" style=\"color:#0000ff\">import</span> sys\nSRC_PATH <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&#x27;../src&#x27;</span>\n<span class=\"token\" style=\"color:#0000ff\">if</span> SRC_PATH <span class=\"token\" style=\"color:#0000ff\">not</span> <span class=\"token\" style=\"color:#0000ff\">in</span> sys<span class=\"token\" style=\"color:#393A34\">.</span>path<span class=\"token\" style=\"color:#393A34\">:</span>\n    sys<span class=\"token\" style=\"color:#393A34\">.</span>path<span class=\"token\" style=\"color:#393A34\">.</span>insert<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span> SRC_PATH<span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#0000ff\">import</span> utils\n\n<span class=\"token\" style=\"color:#0000ff\">import</span> numpy <span class=\"token\" style=\"color:#0000ff\">as</span> np\n<span class=\"token\" style=\"color:#0000ff\">import</span> pandas <span class=\"token\" style=\"color:#0000ff\">as</span> pd\n<span class=\"token\" style=\"color:#0000ff\">import</span> dask<span class=\"token\" style=\"color:#393A34\">.</span>dataframe <span class=\"token\" style=\"color:#0000ff\">as</span> dd\n<span class=\"token\" style=\"color:#0000ff\">from</span> dask<span class=\"token\" style=\"color:#393A34\">.</span>diagnostics <span class=\"token\" style=\"color:#0000ff\">import</span> ProgressBar\n\n<span class=\"token\" style=\"color:#0000ff\">from</span> matplotlib <span class=\"token\" style=\"color:#0000ff\">import</span> pyplot <span class=\"token\" style=\"color:#0000ff\">as</span> plt\n<span class=\"token\" style=\"color:#0000ff\">import</span> seaborn <span class=\"token\" style=\"color:#0000ff\">as</span> sns<span class=\"token\" style=\"color:#393A34\">;</span> sns<span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">set</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[2]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># register progress bar for compute calls in dask so we have an estimate of how long task will take</span>\npbar <span class=\"token\" style=\"color:#393A34\">=</span> ProgressBar<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\npbar<span class=\"token\" style=\"color:#393A34\">.</span>register<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[3]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># inferred int32 types cause a type mismatch (int vs float) error when dask sees a null value</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># null values cannot be interpreted as ints</span>\ncustom_dtypes <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">{</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;date&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;object&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;serial_number&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;object&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;model&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;object&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;capacity_bytes&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;failure&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_1_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_1_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_2_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_2_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_3_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_3_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_4_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_4_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_5_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_5_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_7_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_7_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_8_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_8_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_9_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_9_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_10_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_10_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_11_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_11_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_12_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_12_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_13_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_13_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_15_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_15_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_16_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_16_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_17_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_17_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_22_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_22_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_23_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_23_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_24_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_24_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_168_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_168_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_170_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_170_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_173_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_173_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_174_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_174_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_177_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_177_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_179_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_179_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_181_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_181_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_182_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_182_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_183_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_183_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_184_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_184_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_187_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_187_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_188_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_188_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_189_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_189_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_190_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_190_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_191_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_191_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_192_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_192_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_193_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_193_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_194_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_194_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_195_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_195_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_196_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_196_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_197_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_197_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_198_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_198_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_199_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_199_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_200_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_200_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_201_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_201_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_218_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_218_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_220_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_220_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_222_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_222_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_223_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_223_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_224_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_224_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_225_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_225_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_226_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_226_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_231_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_231_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_232_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_232_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_233_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_233_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_235_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_235_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_240_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_240_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_241_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_241_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_242_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_242_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_250_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_250_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_251_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_251_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_252_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_252_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_254_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_254_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_255_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_255_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n<span class=\"token\" style=\"color:#393A34\">}</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[4]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># read all the data into one dataframe</span>\nDATA_DIR <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&#x27;/home/kachauha/Downloads/data_Q3_2018&#x27;</span>\ndf <span class=\"token\" style=\"color:#393A34\">=</span> dd<span class=\"token\" style=\"color:#393A34\">.</span>read_csv<span class=\"token\" style=\"color:#393A34\">(</span>os<span class=\"token\" style=\"color:#393A34\">.</span>path<span class=\"token\" style=\"color:#393A34\">.</span>join<span class=\"token\" style=\"color:#393A34\">(</span>DATA_DIR<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;*.csv&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> dtype<span class=\"token\" style=\"color:#393A34\">=</span>custom_dtypes<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[5]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># get the seagate data</span>\nseagate_df <span class=\"token\" style=\"color:#393A34\">=</span> df<span class=\"token\" style=\"color:#393A34\">[</span>df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;model&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">str</span><span class=\"token\" style=\"color:#393A34\">.</span>startswith<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;S&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[6]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># get the serial numbers for all the failed hard drives</span>\nfailed_serials <span class=\"token\" style=\"color:#393A34\">=</span> seagate_df<span class=\"token\" style=\"color:#393A34\">[</span>seagate_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;failure&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">==</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed | 36.1s\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p><strong>NOTE:</strong> Can also add date of failure, and its model to failed_serials (and working_serials) if it will be helpful for preprocessing in the future.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[15]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># get the serial numbers for all the failed hard drives, date of failure, and its model</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># multiple entries will exist per serial number since it will be a time series. get only the last one</span>\nworking_serials <span class=\"token\" style=\"color:#393A34\">=</span> seagate_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">~</span>seagate_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isin<span class=\"token\" style=\"color:#393A34\">(</span>failed_serials<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span>\\\n                    <span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span>\\\n                    <span class=\"token\" style=\"color:#393A34\">.</span>drop_duplicates<span class=\"token\" style=\"color:#393A34\">(</span>keep<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;last&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span>\\\n                    <span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed | 51.3s\n</span></code><pre><code><span>2203    Z300XGTR\n4389    Z300XA99\n4900    Z3015BTR\n6971    Z300WWNK\n8459    Z30149AZ\nName: serial_number, dtype: object</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p><strong>NOTE:</strong> We can probably get away with not calculating working serials and instead using not failed_serials for indexing. this will be much faster and efficient since we are searching in ~300 drives as oppospsed to ~80k drives.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>Ensure Unique Indices</h2>\n<p>Having a unique index per entry (e.g. 2018-10-01 Z305B2QN) will make data processing less prone to errors. It will also expand the variety of merging and groupby operations that can be done on the data while still keeping it a dask dataframe (vs pandas dataframe). This is because some operations in dask require do not support duplicate indices.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[7]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># # are there any duplicate indices? [SPOILER ALERT] yes</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># tmp = seagate_df.index.compute()</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># tmp.duplicated().any()    # True</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># # can reset indices do the job?</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># # no. see dask docs. indices are duplicated across dask partitions</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># seagate_df = seagate_df.reset_index(drop=True)</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># tmp = seagate_df.index.compute()</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># tmp.duplicated().any()    # True</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[8]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># proof of duplicate indices</span>\nseagate_df<span class=\"token\" style=\"color:#393A34\">.</span>loc<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>head<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed | 44.1s\n</span></code><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>date</th>\n      <th>serial_number</th>\n      <th>model</th>\n      <th>capacity_bytes</th>\n      <th>failure</th>\n      <th>smart_1_normalized</th>\n      <th>smart_1_raw</th>\n      <th>smart_2_normalized</th>\n      <th>smart_2_raw</th>\n      <th>smart_3_normalized</th>\n      <th>...</th>\n      <th>smart_250_normalized</th>\n      <th>smart_250_raw</th>\n      <th>smart_251_normalized</th>\n      <th>smart_251_raw</th>\n      <th>smart_252_normalized</th>\n      <th>smart_252_raw</th>\n      <th>smart_254_normalized</th>\n      <th>smart_254_raw</th>\n      <th>smart_255_normalized</th>\n      <th>smart_255_raw</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2018-10-01</td>\n      <td>Z305B2QN</td>\n      <td>ST4000DM000</td>\n      <td>4.000787e+12</td>\n      <td>0.0</td>\n      <td>117.0</td>\n      <td>148579456.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>91.0</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>0</th>\n      <td>2018-10-02</td>\n      <td>Z305B2QN</td>\n      <td>ST4000DM000</td>\n      <td>4.000787e+12</td>\n      <td>0.0</td>\n      <td>119.0</td>\n      <td>221256160.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>91.0</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>0</th>\n      <td>2018-10-03</td>\n      <td>Z305B2QN</td>\n      <td>ST4000DM000</td>\n      <td>4.000787e+12</td>\n      <td>0.0</td>\n      <td>109.0</td>\n      <td>23013144.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>91.0</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>0</th>\n      <td>2018-10-04</td>\n      <td>Z305B2QN</td>\n      <td>ST4000DM000</td>\n      <td>4.000787e+12</td>\n      <td>0.0</td>\n      <td>118.0</td>\n      <td>170005376.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>91.0</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>0</th>\n      <td>2018-10-05</td>\n      <td>Z305B2QN</td>\n      <td>ST4000DM000</td>\n      <td>4.000787e+12</td>\n      <td>0.0</td>\n      <td>119.0</td>\n      <td>221968208.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>91.0</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 129 columns</p>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p><strong>RESULT:</strong> There does not seem to be a way to remove duplication. It will limit ops in some ways, but we&#x27;ll have to get around them.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>Manual Feature Selection</h2>\n<p>Previous work done in this area strongly suggests not all stats are equally important. Backblaze suggests five, wikipedia suggests nine, and IBM research suggests a bunch. Make a superset of all these stats and work with those for now. Using too many features can be a rabbit hole we don&#x27;t wanna go down in.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[7]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># work with critical columns for now</span>\nCRITICAL_STATS <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">7</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">9</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">184</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">187</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">188</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">189</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">190</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">193</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">194</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">196</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">197</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">198</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">201</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">240</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">241</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">242</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#008000;font-style:italic\"># NOTE: 201 is all nans</span>\ncrit_cols_raw <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;smart_{}_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">format</span><span class=\"token\" style=\"color:#393A34\">(</span>i<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#0000ff\">for</span> i <span class=\"token\" style=\"color:#0000ff\">in</span> CRITICAL_STATS<span class=\"token\" style=\"color:#393A34\">]</span>\ncrit_cols_normalized <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;smart_{}_normalized&#x27;</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">format</span><span class=\"token\" style=\"color:#393A34\">(</span>i<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#0000ff\">for</span> i <span class=\"token\" style=\"color:#0000ff\">in</span> CRITICAL_STATS<span class=\"token\" style=\"color:#393A34\">]</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>Find Patterns in NaNs and Clean Accordingly</h2>\n<p><strong>TODO:</strong> unsure of reason for nans in 195, 191, 189crit, 184crit</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[8]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># these are the columns analyzed and nans are accounted for these (see https://trello.com/c/tjFl6RHf)</span>\ndone_stats <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">2</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">8</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">11</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">196</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">223</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">225</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">250</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">251</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">252</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">16</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">17</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">168</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">170</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">173</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">174</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">177</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">218</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">231</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">232</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">233</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">235</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">254</span><span class=\"token\" style=\"color:#393A34\">,</span>\n             <span class=\"token\" style=\"color:#36acaa\">183</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">200</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">195</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">191</span><span class=\"token\" style=\"color:#393A34\">]</span>\ndone_cols <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;smart_{}_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">format</span><span class=\"token\" style=\"color:#393A34\">(</span>i<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#0000ff\">for</span> i <span class=\"token\" style=\"color:#0000ff\">in</span> done_stats<span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">+</span> <span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;smart_{}_normalized&#x27;</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">format</span><span class=\"token\" style=\"color:#393A34\">(</span>i<span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#0000ff\">for</span> i <span class=\"token\" style=\"color:#0000ff\">in</span> done_stats<span class=\"token\" style=\"color:#393A34\">]</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># the columns to keep for analysis</span>\nkeep_cols <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;date&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;capacity_bytes&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;failure&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">+</span> crit_cols_raw <span class=\"token\" style=\"color:#393A34\">+</span> crit_cols_normalized\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># dummy value to replace nans</span>\nDUMMY_VALUE <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">100</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[9]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># copy of df on which to perform cleaning tasks</span>\nclean_df <span class=\"token\" style=\"color:#393A34\">=</span> seagate_df<span class=\"token\" style=\"color:#393A34\">[</span>keep_cols<span class=\"token\" style=\"color:#393A34\">]</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># meta data for later use</span>\ninitial_shape <span class=\"token\" style=\"color:#393A34\">=</span> dd<span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span>clean_df<span class=\"token\" style=\"color:#393A34\">.</span>shape<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span>\nnum_total_datapts <span class=\"token\" style=\"color:#393A34\">=</span> initial_shape<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span>\n<span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;Initial shape =&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> initial_shape<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed | 39.0s\nInitial shape = (7150568, 42)\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[12]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># how bad is the nan situation for critical columns? get counts as a percent of total</span>\nseagate_nans <span class=\"token\" style=\"color:#393A34\">=</span> utils<span class=\"token\" style=\"color:#393A34\">.</span>get_nan_count_percent<span class=\"token\" style=\"color:#393A34\">(</span>clean_df<span class=\"token\" style=\"color:#393A34\">,</span> num_total_datapts<span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\">###################################################################</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># # this chunk of code is used to get cols with the same percent of</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># # nan values</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># val = None</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># for k, v in seagate_nanpercent.iteritems():</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     if v &gt; 0.999197 and v &lt; 0.999199:</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#         if val is None:</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#             val = v</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#         print(k)</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#         print(v)</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#         if v == val:</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#             print(&#x27;same as val&#x27;)</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#         else:</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#             print(&#x27;different&#x27;)</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">###################################################################</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># show only values which at least some nans</span>\nseagate_nans<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">(</span>seagate_nans<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;percent&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">!=</span> <span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">&amp;</span> <span class=\"token\" style=\"color:#393A34\">(</span>seagate_nans<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;percent&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">!=</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>sort_values<span class=\"token\" style=\"color:#393A34\">(</span>by<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;percent&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> ascending<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">False</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed | 37.7s\n</span></code><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>count</th>\n      <th>percent</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>smart_196_raw</th>\n      <td>7093452</td>\n      <td>0.992012</td>\n    </tr>\n    <tr>\n      <th>smart_196_normalized</th>\n      <td>7093452</td>\n      <td>0.992012</td>\n    </tr>\n    <tr>\n      <th>smart_184_raw</th>\n      <td>2267653</td>\n      <td>0.317129</td>\n    </tr>\n    <tr>\n      <th>smart_189_normalized</th>\n      <td>2267653</td>\n      <td>0.317129</td>\n    </tr>\n    <tr>\n      <th>smart_189_raw</th>\n      <td>2267653</td>\n      <td>0.317129</td>\n    </tr>\n    <tr>\n      <th>smart_184_normalized</th>\n      <td>2267653</td>\n      <td>0.317129</td>\n    </tr>\n    <tr>\n      <th>smart_242_normalized</th>\n      <td>59004</td>\n      <td>0.008252</td>\n    </tr>\n    <tr>\n      <th>smart_241_raw</th>\n      <td>59004</td>\n      <td>0.008252</td>\n    </tr>\n    <tr>\n      <th>smart_241_normalized</th>\n      <td>59004</td>\n      <td>0.008252</td>\n    </tr>\n    <tr>\n      <th>smart_240_normalized</th>\n      <td>59004</td>\n      <td>0.008252</td>\n    </tr>\n    <tr>\n      <th>smart_242_raw</th>\n      <td>59004</td>\n      <td>0.008252</td>\n    </tr>\n    <tr>\n      <th>smart_240_raw</th>\n      <td>59004</td>\n      <td>0.008252</td>\n    </tr>\n    <tr>\n      <th>smart_193_normalized</th>\n      <td>57843</td>\n      <td>0.008089</td>\n    </tr>\n    <tr>\n      <th>smart_193_raw</th>\n      <td>57843</td>\n      <td>0.008089</td>\n    </tr>\n    <tr>\n      <th>smart_188_normalized</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n    <tr>\n      <th>smart_190_normalized</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n    <tr>\n      <th>smart_187_normalized</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n    <tr>\n      <th>smart_190_raw</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n    <tr>\n      <th>smart_188_raw</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n    <tr>\n      <th>smart_187_raw</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n    <tr>\n      <th>smart_194_normalized</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_198_normalized</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_197_normalized</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_1_raw</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_10_normalized</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_9_normalized</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_7_normalized</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_5_normalized</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_5_raw</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_198_raw</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_197_raw</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_194_raw</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_10_raw</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_9_raw</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_7_raw</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_1_normalized</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n  </tbody>\n</table>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h3>Part 1: Drop Columns Where Most Entries Are Nan</h3></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[13]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># drop columns that are all nans. NOTE: dropna on axis=1 is not supported in dask yet</span>\nMAJORITY_THRESHOLD <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">0.99</span>\nclean_df <span class=\"token\" style=\"color:#393A34\">=</span> clean_df<span class=\"token\" style=\"color:#393A34\">.</span>drop<span class=\"token\" style=\"color:#393A34\">(</span>seagate_nans<span class=\"token\" style=\"color:#393A34\">[</span>seagate_nans<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;percent&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">&gt;</span> MAJORITY_THRESHOLD<span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>index<span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> axis<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\ndd<span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span>clean_df<span class=\"token\" style=\"color:#393A34\">.</span>shape<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed | 37.2s\n[########################################] | 100% Completed | 39.3s\n</span></code><pre><code><span>((7150568, 38),)</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h3>Part 2: Drop The Small Amount Of Rows Which Are Nans in Big Amount of Columns</h3></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[15]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># get the data points where 193 is null. inspect it for patterns</span>\nnan193_df <span class=\"token\" style=\"color:#393A34\">=</span> clean_df<span class=\"token\" style=\"color:#393A34\">[</span>clean_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;smart_193_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># number of nans in this subset as a percentage of nans in the overall data</span>\nutils<span class=\"token\" style=\"color:#393A34\">.</span>get_nan_count_percent<span class=\"token\" style=\"color:#393A34\">(</span>nan193_df<span class=\"token\" style=\"color:#393A34\">,</span> num_total_datapts<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>count</th>\n      <th>percent</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>date</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>serial_number</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>capacity_bytes</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>failure</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_1_raw</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_5_raw</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_7_raw</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_9_raw</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_10_raw</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_184_raw</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n    <tr>\n      <th>smart_187_raw</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n    <tr>\n      <th>smart_188_raw</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n    <tr>\n      <th>smart_189_raw</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n    <tr>\n      <th>smart_190_raw</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n    <tr>\n      <th>smart_193_raw</th>\n      <td>57843</td>\n      <td>0.008089</td>\n    </tr>\n    <tr>\n      <th>smart_194_raw</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_197_raw</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_198_raw</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_240_raw</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n    <tr>\n      <th>smart_241_raw</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n    <tr>\n      <th>smart_242_raw</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n    <tr>\n      <th>smart_1_normalized</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_5_normalized</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_7_normalized</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_9_normalized</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_10_normalized</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_184_normalized</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n    <tr>\n      <th>smart_187_normalized</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n    <tr>\n      <th>smart_188_normalized</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n    <tr>\n      <th>smart_189_normalized</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n    <tr>\n      <th>smart_190_normalized</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n    <tr>\n      <th>smart_193_normalized</th>\n      <td>57843</td>\n      <td>0.008089</td>\n    </tr>\n    <tr>\n      <th>smart_194_normalized</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_197_normalized</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_198_normalized</th>\n      <td>61</td>\n      <td>0.000009</td>\n    </tr>\n    <tr>\n      <th>smart_240_normalized</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n    <tr>\n      <th>smart_241_normalized</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n    <tr>\n      <th>smart_242_normalized</th>\n      <td>57177</td>\n      <td>0.007996</td>\n    </tr>\n  </tbody>\n</table>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[65]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># number of wokring vs failed in overall df</span>\nseagate_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;failure&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>value_counts<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed | 45.4s\n</span></code><pre><code><span>0.0    7151837\n1.0        341\nName: failure, dtype: int64</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[ ]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># number of working vs failed drives in subset</span>\nnan193_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;failure&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>value_counts<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[16]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># do the failed drives report nans only on the last day?</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># to figure this, get num of rows we have for failed sers</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># if &gt;1 that means failed drives reported nan on other days as well</span>\nsers <span class=\"token\" style=\"color:#393A34\">=</span> nan193_df<span class=\"token\" style=\"color:#393A34\">[</span>nan193_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;failure&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">==</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span>\nnan193_df<span class=\"token\" style=\"color:#393A34\">[</span>nan193_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isin<span class=\"token\" style=\"color:#393A34\">(</span>sers<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>value_counts<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>S2ZYJ9GGB01005    76\nS2ZYJ9FFB18436    59\nS2ZYJ9AF511164    45\nS2ZYJ9FG405070    44\nS2ZYJ9CFC01455    14\nS2ZYJ9DFA03939    13\nS2ZYJ9GGB01009    10\nS2ZYJ9DFA03934     7\nName: serial_number, dtype: int64</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p><strong>RESULT:</strong> All the nans in 1, 5, 7, 10, 187, 188, 190, 194, 197, 198 in the main dataset are coming from the subset of rows where 193 is null. And so do almost all of the nans in 240, 241, 242. Therefore, it makes sense to drop all such rows.</p>\n<p>However, the caveat is that among these obs there are failure obs, which are EXTREMELY precious. Additionally, it is not the case that a failed drive reports nans only on the day it fails. So as a compromise, drop rows iff they do not belong to a drive that has failed.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[17]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># retain columns iff they belong to a working drive or have non null values for 193 (and 1, 5, 7 .. by extension)</span>\nclean_df <span class=\"token\" style=\"color:#393A34\">=</span> clean_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">~</span>clean_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;smart_193_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">|</span> clean_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isin<span class=\"token\" style=\"color:#393A34\">(</span>sers<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span>\n\n<span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span>dd<span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span>clean_df<span class=\"token\" style=\"color:#393A34\">.</span>shape<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span>\nutils<span class=\"token\" style=\"color:#393A34\">.</span>get_nan_count_percent<span class=\"token\" style=\"color:#393A34\">(</span>clean_df<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed | 39.6s\n(7092993, 38)\n[########################################] | 100% Completed | 38.1s\n[########################################] | 100% Completed | 39.1s\n</span></code><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>count</th>\n      <th>percent</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>date</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>serial_number</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>capacity_bytes</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>failure</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_1_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_5_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_7_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_9_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_10_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_184_raw</th>\n      <td>2210744</td>\n      <td>0.311680</td>\n    </tr>\n    <tr>\n      <th>smart_187_raw</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_188_raw</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_189_raw</th>\n      <td>2210744</td>\n      <td>0.311680</td>\n    </tr>\n    <tr>\n      <th>smart_190_raw</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_193_raw</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_194_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_197_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_198_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_240_raw</th>\n      <td>2095</td>\n      <td>0.000295</td>\n    </tr>\n    <tr>\n      <th>smart_241_raw</th>\n      <td>2095</td>\n      <td>0.000295</td>\n    </tr>\n    <tr>\n      <th>smart_242_raw</th>\n      <td>2095</td>\n      <td>0.000295</td>\n    </tr>\n    <tr>\n      <th>smart_1_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_5_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_7_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_9_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_10_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_184_normalized</th>\n      <td>2210744</td>\n      <td>0.311680</td>\n    </tr>\n    <tr>\n      <th>smart_187_normalized</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_188_normalized</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_189_normalized</th>\n      <td>2210744</td>\n      <td>0.311680</td>\n    </tr>\n    <tr>\n      <th>smart_190_normalized</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_193_normalized</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_194_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_197_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_198_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_240_normalized</th>\n      <td>2095</td>\n      <td>0.000295</td>\n    </tr>\n    <tr>\n      <th>smart_241_normalized</th>\n      <td>2095</td>\n      <td>0.000295</td>\n    </tr>\n    <tr>\n      <th>smart_242_normalized</th>\n      <td>2095</td>\n      <td>0.000295</td>\n    </tr>\n  </tbody>\n</table>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[18]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># collect garbage</span>\n<span class=\"token\" style=\"color:#0000ff\">del</span> nan193_df\n<span class=\"token\" style=\"color:#0000ff\">del</span> sers\ngc<span class=\"token\" style=\"color:#393A34\">.</span>collect<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>1101</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h3>Part 3: Fill Dummy Value Where Nans Are Indicative Features</h3>\n<p>One reason for nans is that some attributes (Head Flying Hours, LBA written, LBA read) are not applicable to this specific type of drive (Momentus). In such cases, the model should know that there exist drives that do not have these values. So these observations cannot be dropped.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[19]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># get the data points where 240 is null. inspect it for patterns</span>\nnan240_df <span class=\"token\" style=\"color:#393A34\">=</span> clean_df<span class=\"token\" style=\"color:#393A34\">[</span>clean_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;smart_240_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># number of nans in this subset as a percentage of nans in the original overall data</span>\nutils<span class=\"token\" style=\"color:#393A34\">.</span>get_nan_count_percent<span class=\"token\" style=\"color:#393A34\">(</span>nan240_df<span class=\"token\" style=\"color:#393A34\">,</span> num_total_datapts<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>sort_values<span class=\"token\" style=\"color:#393A34\">(</span>by<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;percent&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> ascending<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">False</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed | 40.5s\n</span></code><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>count</th>\n      <th>percent</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>smart_241_raw</th>\n      <td>2095</td>\n      <td>0.000293</td>\n    </tr>\n    <tr>\n      <th>smart_240_raw</th>\n      <td>2095</td>\n      <td>0.000293</td>\n    </tr>\n    <tr>\n      <th>smart_241_normalized</th>\n      <td>2095</td>\n      <td>0.000293</td>\n    </tr>\n    <tr>\n      <th>smart_240_normalized</th>\n      <td>2095</td>\n      <td>0.000293</td>\n    </tr>\n    <tr>\n      <th>smart_242_raw</th>\n      <td>2095</td>\n      <td>0.000293</td>\n    </tr>\n    <tr>\n      <th>smart_242_normalized</th>\n      <td>2095</td>\n      <td>0.000293</td>\n    </tr>\n    <tr>\n      <th>smart_184_normalized</th>\n      <td>268</td>\n      <td>0.000037</td>\n    </tr>\n    <tr>\n      <th>smart_193_normalized</th>\n      <td>268</td>\n      <td>0.000037</td>\n    </tr>\n    <tr>\n      <th>smart_187_normalized</th>\n      <td>268</td>\n      <td>0.000037</td>\n    </tr>\n    <tr>\n      <th>smart_184_raw</th>\n      <td>268</td>\n      <td>0.000037</td>\n    </tr>\n    <tr>\n      <th>smart_187_raw</th>\n      <td>268</td>\n      <td>0.000037</td>\n    </tr>\n    <tr>\n      <th>smart_188_raw</th>\n      <td>268</td>\n      <td>0.000037</td>\n    </tr>\n    <tr>\n      <th>smart_189_raw</th>\n      <td>268</td>\n      <td>0.000037</td>\n    </tr>\n    <tr>\n      <th>smart_190_raw</th>\n      <td>268</td>\n      <td>0.000037</td>\n    </tr>\n    <tr>\n      <th>smart_193_raw</th>\n      <td>268</td>\n      <td>0.000037</td>\n    </tr>\n    <tr>\n      <th>smart_188_normalized</th>\n      <td>268</td>\n      <td>0.000037</td>\n    </tr>\n    <tr>\n      <th>smart_189_normalized</th>\n      <td>268</td>\n      <td>0.000037</td>\n    </tr>\n    <tr>\n      <th>smart_190_normalized</th>\n      <td>268</td>\n      <td>0.000037</td>\n    </tr>\n    <tr>\n      <th>smart_7_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_194_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_197_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_198_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_10_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>capacity_bytes</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>failure</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_5_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_9_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_7_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_9_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_1_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_1_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>serial_number</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_5_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_198_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_197_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_194_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_10_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>date</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p><strong>RESULT:</strong> The nans in this case could be filled with mean, mode, etc. But the reason nans exist is because these drives are somewhat different than others. Therefore it may be better to put a special dummy value (e.g. -100) to let the model know that the values of these attributes are na. Could also possibly add another boolean column to specify isna but this may be memory intensive.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[20]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># fill in dummy values</span>\ncols_to_fill <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;smart_240_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_240_normalized&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_241_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_241_normalized&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_242_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_242_normalized&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># must do it in for loop, dask does not like indexing with list</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># plus, its not straightforward to mask isna of specific columns</span>\n<span class=\"token\" style=\"color:#0000ff\">for</span> col <span class=\"token\" style=\"color:#0000ff\">in</span> cols_to_fill<span class=\"token\" style=\"color:#393A34\">:</span>\n    clean_df<span class=\"token\" style=\"color:#393A34\">[</span>col<span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">=</span> clean_df<span class=\"token\" style=\"color:#393A34\">[</span>col<span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>mask<span class=\"token\" style=\"color:#393A34\">(</span>clean_df<span class=\"token\" style=\"color:#393A34\">[</span>col<span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> DUMMY_VALUE<span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># how are things after this part</span>\n<span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span>dd<span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span>clean_df<span class=\"token\" style=\"color:#393A34\">.</span>shape<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span>\nutils<span class=\"token\" style=\"color:#393A34\">.</span>get_nan_count_percent<span class=\"token\" style=\"color:#393A34\">(</span>clean_df<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed | 51.6s\n(7092993, 38)\n[########################################] | 100% Completed | 44.2s\n[########################################] | 100% Completed | 48.3s\n</span></code><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>count</th>\n      <th>percent</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>date</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>serial_number</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>capacity_bytes</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>failure</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_1_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_5_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_7_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_9_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_10_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_184_raw</th>\n      <td>2210744</td>\n      <td>0.311680</td>\n    </tr>\n    <tr>\n      <th>smart_187_raw</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_188_raw</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_189_raw</th>\n      <td>2210744</td>\n      <td>0.311680</td>\n    </tr>\n    <tr>\n      <th>smart_190_raw</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_193_raw</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_194_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_197_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_198_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_240_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_241_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_242_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_1_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_5_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_7_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_9_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_10_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_184_normalized</th>\n      <td>2210744</td>\n      <td>0.311680</td>\n    </tr>\n    <tr>\n      <th>smart_187_normalized</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_188_normalized</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_189_normalized</th>\n      <td>2210744</td>\n      <td>0.311680</td>\n    </tr>\n    <tr>\n      <th>smart_190_normalized</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_193_normalized</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_194_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_197_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_198_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_240_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_241_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_242_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[21]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">del</span> nan240_df\ngc<span class=\"token\" style=\"color:#393A34\">.</span>collect<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>1914</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h3>Part 4: Tricky Nans</h3>\n<p>What&#x27;s left to deal with is not straightforward. It makes up ~35% of data so it can&#x27;t directly be filled with a dummy value without inspecting first. It also cannot be removed because it is too big of a chunk.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[22]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># get a subset of df to investigate the behavior of cols with too many nans - eg why is smart 184 mostly nans?</span>\nsub <span class=\"token\" style=\"color:#393A34\">=</span> clean_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;date&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_184_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_184_normalized&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_189_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_189_normalized&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[42]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># general description of data in these rows</span>\nsub<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;smart_184_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_184_normalized&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_189_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_189_normalized&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>describe<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed | 48.3s\n</span></code><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>smart_184_raw</th>\n      <th>smart_184_normalized</th>\n      <th>smart_189_raw</th>\n      <th>smart_189_normalized</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>4.635527e+06</td>\n      <td>4.635527e+06</td>\n      <td>4.635527e+06</td>\n      <td>4.635527e+06</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>3.828475e-03</td>\n      <td>9.999624e+01</td>\n      <td>6.583818e+00</td>\n      <td>9.905654e+01</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>3.652030e-01</td>\n      <td>3.652030e-01</td>\n      <td>5.047643e+02</td>\n      <td>5.412950e+00</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>0.000000e+00</td>\n      <td>2.800000e+01</td>\n      <td>0.000000e+00</td>\n      <td>1.000000e+00</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>0.000000e+00</td>\n      <td>1.000000e+02</td>\n      <td>0.000000e+00</td>\n      <td>1.000000e+02</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>0.000000e+00</td>\n      <td>1.000000e+02</td>\n      <td>0.000000e+00</td>\n      <td>1.000000e+02</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>0.000000e+00</td>\n      <td>1.000000e+02</td>\n      <td>0.000000e+00</td>\n      <td>1.000000e+02</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>7.200000e+01</td>\n      <td>1.000000e+02</td>\n      <td>6.553500e+04</td>\n      <td>1.000000e+02</td>\n    </tr>\n  </tbody>\n</table>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p><strong>NOTE:</strong> For the most part, nothing out of the ordinary but std of smart_189_raw is unusually high</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[43]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># histograms to visualize anything unusual</span>\nsub<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;smart_184_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_184_normalized&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_189_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_189_normalized&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>hist<span class=\"token\" style=\"color:#393A34\">(</span>bins<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">50</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed | 47.2s\n</span></code><pre><code><span>array([[&lt;matplotlib.axes._subplots.AxesSubplot object at 0x7faddf364978&gt;,\n        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fadbc7d6860&gt;],\n       [&lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fae006009b0&gt;,\n        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7fadbcb3eb00&gt;]],\n      dtype=object)</span></code></pre><img alt=\"\" src=\"data:image/png;base64,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\n\" class=\"sc-bdVaJa jFcqvn\"/></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[23]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># get the data of the failed drives from the subset and see if there is any pattern in failed vs non failed</span>\nsub_failed <span class=\"token\" style=\"color:#393A34\">=</span> sub<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;date&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_189_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_184_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span>sub<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isin<span class=\"token\" style=\"color:#393A34\">(</span>failed_serials<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span>\nsub_working <span class=\"token\" style=\"color:#393A34\">=</span> sub<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;date&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_189_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_184_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">~</span>sub<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isin<span class=\"token\" style=\"color:#393A34\">(</span>failed_serials<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[24]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># are 184 and 189 simulataneously nan for all drives</span>\n<span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">(</span>sub_failed<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;smart_184_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">==</span> sub_failed<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;smart_189_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">all</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">(</span>sub_working<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;smart_184_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">==</span> sub_working<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;smart_189_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">all</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed | 49.5s\nTrue\n[########################################] | 100% Completed | 49.0s\nTrue\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p><strong>NOTE:</strong> 189 and 184 are nans simulataneously. So we can use just one of the two for indexing into the data for analysis.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[25]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># from the subset, get serial numbers where 184 is nan, for failed drives</span>\nsub_failed_nanserials <span class=\"token\" style=\"color:#393A34\">=</span> sub_failed<span class=\"token\" style=\"color:#393A34\">[</span>sub_failed<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;smart_184_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>unique<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span>sub_failed_nanserials<span class=\"token\" style=\"color:#393A34\">.</span>shape<span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># from the subset, get serial numbers where 184 is nan, for working drives</span>\nsub_working_nanserials <span class=\"token\" style=\"color:#393A34\">=</span> sub_working<span class=\"token\" style=\"color:#393A34\">[</span>sub_working<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;smart_184_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>unique<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span>sub_working_nanserials<span class=\"token\" style=\"color:#393A34\">.</span>shape<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed | 51.2s\n(86,)\n[########################################] | 100% Completed | 53.4s\n(26301,)\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[26]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># how many drives in cleaned version of dataset</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># this should be same as in whole dataset - i.e. we shouldn&#x27;t have removed ALL the data for a drive yet</span>\n<span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span>clean_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>drop_duplicates<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>isin<span class=\"token\" style=\"color:#393A34\">(</span>failed_serials<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span>seagate_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>drop_duplicates<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>isin<span class=\"token\" style=\"color:#393A34\">(</span>failed_serials<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed | 50.5s\n304\n[########################################] | 100% Completed | 42.3s\n304\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p><strong>NOTE:</strong> The number of serial nums where 184 (and 189) is nan is a significant portion of the total number of serial nums. (143 out of 341)</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[27]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># for each serial number, what percentage of values in the time series are nans?</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># this is to confirm a hunch - drives have either all values as nans or no values as nans </span>\nfailed_nanpercent <span class=\"token\" style=\"color:#393A34\">=</span> sub_failed<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_184_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>groupby<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">apply</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#0000ff\">lambda</span> group<span class=\"token\" style=\"color:#393A34\">:</span> group<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;smart_184_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">/</span> group<span class=\"token\" style=\"color:#393A34\">.</span>shape<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span>\nworking_nanpercent <span class=\"token\" style=\"color:#393A34\">=</span> sub_working<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_184_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>groupby<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">apply</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#0000ff\">lambda</span> group<span class=\"token\" style=\"color:#393A34\">:</span> group<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;smart_184_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">/</span> group<span class=\"token\" style=\"color:#393A34\">.</span>shape<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stderr\"><span>/home/kachauha/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/ipykernel_launcher.py:3: UserWarning: `meta` is not specified, inferred from partial data. Please provide `meta` if the result is unexpected.\n  Before: .apply(func)\n  After:  .apply(func, meta={&#x27;x&#x27;: &#x27;f8&#x27;, &#x27;y&#x27;: &#x27;f8&#x27;}) for dataframe result\n  or:     .apply(func, meta=(&#x27;x&#x27;, &#x27;f8&#x27;))            for series result\n  This is separate from the ipykernel package so we can avoid doing imports until\n/home/kachauha/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/ipykernel_launcher.py:4: UserWarning: `meta` is not specified, inferred from partial data. Please provide `meta` if the result is unexpected.\n  Before: .apply(func)\n  After:  .apply(func, meta={&#x27;x&#x27;: &#x27;f8&#x27;, &#x27;y&#x27;: &#x27;f8&#x27;}) for dataframe result\n  or:     .apply(func, meta=(&#x27;x&#x27;, &#x27;f8&#x27;))            for series result\n  after removing the cwd from sys.path.\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[28]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># how many failed drives are there which have neither all-nan nor no-nan</span>\nfailed_nanpercent<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">(</span>failed_nanpercent <span class=\"token\" style=\"color:#393A34\">!=</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">&amp;</span> <span class=\"token\" style=\"color:#393A34\">(</span>failed_nanpercent <span class=\"token\" style=\"color:#393A34\">!=</span> <span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>    <span class=\"token\" style=\"color:#008000;font-style:italic\"># S3010MAK, S3010LHR</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># sub_failed[sub_failed[&#x27;serial_number&#x27;]==&#x27;S3010MAK&#x27;].compute()    # 1 nan value out of 19</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># sub_failed[sub_failed[&#x27;serial_number&#x27;]==&#x27;S3010LHR&#x27;].compute()    # 1 nan value out of 14</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed | 57.0s\n</span></code><pre><code><span>Series([], dtype: float64)</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[29]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># how many working drives are there which have neither all-nan nor no-nan</span>\nworking_nanpercent<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">(</span>working_nanpercent <span class=\"token\" style=\"color:#393A34\">!=</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#393A34\">&amp;</span> <span class=\"token\" style=\"color:#393A34\">(</span>working_nanpercent <span class=\"token\" style=\"color:#393A34\">!=</span> <span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>sort_values<span class=\"token\" style=\"color:#393A34\">(</span>ascending<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">False</span><span class=\"token\" style=\"color:#393A34\">)</span>    <span class=\"token\" style=\"color:#008000;font-style:italic\"># 87 values, max percent 0.011494/1.0</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># sub_working[sub_working[&#x27;serial_number&#x27;]==&#x27;Z4D05N47&#x27;].compute()    # 1 nan value out of 92</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># sub_working[sub_working[&#x27;serial_number&#x27;]==&#x27;S301090L&#x27;].compute()    # 1 nan value out of 87</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># sub_working[sub_working[&#x27;serial_number&#x27;]==&#x27;S300Z4KY&#x27;].compute()    # 1 nan value out of 87</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed |  1min 21.4s\n</span></code><pre><code><span>Series([], dtype: float64)</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p><strong>RESULT:</strong> The hunch was correct. For a given serial number, either all values are nans or less than 1% values are nans (often only one). Therefore we can approach this in a hybrid way.</p>\n<p>For minimal nans, the data can be interpolated or mean/mode/median/forward/backward filled, since this could have likely come from a hiccup in data collection.</p>\n<p>For all-nans, it can be filled with dummy value so that model knows that a particular serial/model provides only nans for this smart stat.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p><strong>Attempt 1:</strong> In the cells below, we try to group by serial number. Then, check if that serial number always reports nans. If yes, then fill it with dummy value and if not, interpolate.</p>\n<p>However, this does not work well with dask dataframe because of duplicate indexing issue.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[110]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># def inter0(group):</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     ret = group.reset_index().interpolate()</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     ret.index = ret[&#x27;index&#x27;]</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     ret.index.name = None</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     ret = ret.drop([&#x27;index&#x27;, &#x27;serial_number&#x27;], axis=1)</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     return ret</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># def inter1(group):</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     breakpoint()</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     return group.interpolate()</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># # tmp = clean_df[[&#x27;serial_number&#x27;, &#x27;smart_184_raw&#x27;]].repartition(npartitions=24)</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># # tmp = tmp.groupby(&#x27;serial_number&#x27;).apply(lambda group: group.interpolate())</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># # tmp = tmp.groupby(&#x27;serial_number&#x27;).apply(interpolate_fun)</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># # tmp = tmp.groupby(&#x27;serial_number&#x27;).apply(lambda group: group.reset_index().ffill())</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># # tmp = tmp.groupby(&#x27;serial_number&#x27;).apply(inter1)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[87]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\">##################### WORKING BUT LESS ACCURATE #####################</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># tmp = clean_df[clean_df[&#x27;serial_number&#x27;].isin([&#x27;S2ZYJ9FG404837&#x27;, &#x27;S2ZYJ9CG107997&#x27;, &#x27;S2ZYJ9CFC01460&#x27;])]</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># res = tmp[[&#x27;serial_number&#x27;, &#x27;smart_184_raw&#x27;]].groupby(&#x27;serial_number&#x27;).apply(lambda group: group.fillna(value=-100))</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># clean_df = clean_df.groupby(&#x27;serial_number&#x27;).apply(lambda group: group.interpolate(method=&#x27;linear&#x27;))</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># clean_df = clean_df.groupby(&#x27;serial_number&#x27;).apply(lambda group: group.fillna(value=DUMMY_VALUE))</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># res = res.groupby(&#x27;serial_number&#x27;).apply(lambda group: group.fillna(value=-100))</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># # interpolate missing values. all-nan columns will be unaffected</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># clean_df = clean_df.groupby(&#x27;serial_number&#x27;).apply(lambda group: group.interpolate(method=&#x27;linear&#x27;))</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># # fill with -100 for the values that are still nan</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># clean_df = clean_df.groupby(&#x27;serial_number&#x27;).apply(lambda group: group.fillna(value=-100))</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">##################### WORKING BUT LESS ACCURATE #####################</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p><strong>Attempt 2:</strong> Instead, lets try to fill na&#x27;s on the entire df, but by using serial number isin. fillna on entire df is known to work ok and not raise the duplicate indices error like the previous cell does.</p>\n<p>First get the serial numbers which always report nan. Then replace those nans with dummy value. Then, apply interpolation/mean/median/mode for the remaining values. Note that this may not be very accurate, since mean/median/mode may be different across models (even though vendor is the same).</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[30]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># get all the serial numbers where 184 is seen to be nan at least once</span>\nnan184_serials <span class=\"token\" style=\"color:#393A34\">=</span> clean_df<span class=\"token\" style=\"color:#393A34\">[</span>clean_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;smart_184_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>unique<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>    <span class=\"token\" style=\"color:#008000;font-style:italic\"># len = 32005</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># of these serial numbers, which ones are the ones for whom 184 is always nan</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># isallnan184_serials = clean_df[[&#x27;serial_number&#x27;, &#x27;smart_184_raw&#x27;]].groupby(&#x27;serial_number&#x27;).apply(lambda g: g[&#x27;smart_184_raw&#x27;].isna().all())    # shape = (83628,)</span>\nisallnan184_serials <span class=\"token\" style=\"color:#393A34\">=</span> clean_df<span class=\"token\" style=\"color:#393A34\">[</span>clean_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isin<span class=\"token\" style=\"color:#393A34\">(</span>nan184_serials<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_184_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span>\nisallnan184_serials <span class=\"token\" style=\"color:#393A34\">=</span> isallnan184_serials<span class=\"token\" style=\"color:#393A34\">.</span>groupby<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">apply</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#0000ff\">lambda</span> g<span class=\"token\" style=\"color:#393A34\">:</span> g<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;smart_184_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">all</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed | 44.0s\n</span></code><code class=\"nteract-display-area-stderr\"><span>/home/kachauha/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/ipykernel_launcher.py:7: UserWarning: `meta` is not specified, inferred from partial data. Please provide `meta` if the result is unexpected.\n  Before: .apply(func)\n  After:  .apply(func, meta={&#x27;x&#x27;: &#x27;f8&#x27;, &#x27;y&#x27;: &#x27;f8&#x27;}) for dataframe result\n  or:     .apply(func, meta=(&#x27;x&#x27;, &#x27;f8&#x27;))            for series result\n  import sys\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[31]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># check which class is minority - this will be used for lookup using isin, for efficiency</span>\nisallnan184_serials<span class=\"token\" style=\"color:#393A34\">.</span>value_counts<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed |  1min  5.7s\n</span></code><pre><code><span>True    26387\ndtype: int64</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[32]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># serial numbers which have all-nans for 184 and 189 and are therefore to be filled with dummy value</span>\ndummyfill_sers <span class=\"token\" style=\"color:#393A34\">=</span> isallnan184_serials<span class=\"token\" style=\"color:#393A34\">[</span>isallnan184_serials <span class=\"token\" style=\"color:#393A34\">==</span> <span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>index<span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\ndummyfill_sers</code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed |  1min  6.7s\n</span></code><pre><code><span>Index([&#x27;ZCH018KV&#x27;, &#x27;ZCH028E0&#x27;, &#x27;ZCH028RH&#x27;, &#x27;ZCH036H8&#x27;, &#x27;ZCH0447E&#x27;, &#x27;ZCH046XA&#x27;,\n       &#x27;ZCH050E0&#x27;, &#x27;ZCH0528B&#x27;, &#x27;ZCH053T4&#x27;, &#x27;ZCH05BTG&#x27;,\n       ...\n       &#x27;ZJV10J7P&#x27;, &#x27;ZJV10J7T&#x27;, &#x27;ZJV10JBM&#x27;, &#x27;ZJV10W3L&#x27;, &#x27;ZJV121MR&#x27;, &#x27;ZJV121QN&#x27;,\n       &#x27;ZJV121XD&#x27;, &#x27;ZJV12R9J&#x27;, &#x27;ZJV137E2&#x27;, &#x27;ZJV1CSL8&#x27;],\n      dtype=&#x27;object&#x27;, name=&#x27;serial_number&#x27;, length=26387)</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[33]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># fill columns with dummy value</span>\ncols_to_fill <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;smart_184_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_184_normalized&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_189_raw&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;smart_189_normalized&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span>\n<span class=\"token\" style=\"color:#0000ff\">for</span> col <span class=\"token\" style=\"color:#0000ff\">in</span> cols_to_fill<span class=\"token\" style=\"color:#393A34\">:</span>\n    clean_df<span class=\"token\" style=\"color:#393A34\">[</span>col<span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">=</span> clean_df<span class=\"token\" style=\"color:#393A34\">[</span>col<span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>mask<span class=\"token\" style=\"color:#393A34\">(</span>clean_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>isin<span class=\"token\" style=\"color:#393A34\">(</span>dummyfill_sers<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> DUMMY_VALUE<span class=\"token\" style=\"color:#393A34\">)</span>\n    \n<span class=\"token\" style=\"color:#008000;font-style:italic\"># how are things after this part</span>\n<span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span>dd<span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span>clean_df<span class=\"token\" style=\"color:#393A34\">.</span>shape<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span>\nutils<span class=\"token\" style=\"color:#393A34\">.</span>get_nan_count_percent<span class=\"token\" style=\"color:#393A34\">(</span>clean_df<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed | 53.1s\n(7092993, 38)\n[########################################] | 100% Completed | 48.4s\n[########################################] | 100% Completed | 49.0s\n</span></code><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>count</th>\n      <th>percent</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>date</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>serial_number</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>capacity_bytes</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>failure</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_1_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_5_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_7_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_9_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_10_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_184_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_187_raw</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_188_raw</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_189_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_190_raw</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_193_raw</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_194_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_197_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_198_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_240_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_241_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_242_raw</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_1_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_5_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_7_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_9_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_10_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_184_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_187_normalized</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_188_normalized</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_189_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_190_normalized</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_193_normalized</th>\n      <td>268</td>\n      <td>0.000038</td>\n    </tr>\n    <tr>\n      <th>smart_194_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_197_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_198_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_240_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_241_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>smart_242_normalized</th>\n      <td>0</td>\n      <td>0.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[34]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># collect garbage</span>\n<span class=\"token\" style=\"color:#0000ff\">del</span> sub\n<span class=\"token\" style=\"color:#0000ff\">del</span> sub_failed\n<span class=\"token\" style=\"color:#0000ff\">del</span> sub_working\n<span class=\"token\" style=\"color:#0000ff\">del</span> dummyfill_sers\n<span class=\"token\" style=\"color:#0000ff\">del</span> nan184_serials\n<span class=\"token\" style=\"color:#0000ff\">del</span> isallnan184_serials\n<span class=\"token\" style=\"color:#0000ff\">del</span> sub_failed_nanserials\n<span class=\"token\" style=\"color:#0000ff\">del</span> sub_working_nanserials\n<span class=\"token\" style=\"color:#0000ff\">del</span> failed_nanpercent\n<span class=\"token\" style=\"color:#0000ff\">del</span> working_nanpercent\ngc<span class=\"token\" style=\"color:#393A34\">.</span>collect<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>1979</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h3>Part 5: Finalize Remaining Nans</h3>\n<p>Nothing &quot;smart&quot; can be done about the nans that still remain (it may not be worth the effort anyway). So fill these with their mean values.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[35]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># fill nans with mean values</span>\nclean_df <span class=\"token\" style=\"color:#393A34\">=</span> clean_df<span class=\"token\" style=\"color:#393A34\">.</span>fillna<span class=\"token\" style=\"color:#393A34\">(</span>value<span class=\"token\" style=\"color:#393A34\">=</span>clean_df<span class=\"token\" style=\"color:#393A34\">.</span>mean<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;Final shape =&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> dd<span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span>clean_df<span class=\"token\" style=\"color:#393A34\">.</span>shape<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># verify that there are no more nans</span>\nutils<span class=\"token\" style=\"color:#393A34\">.</span>get_nan_count_percent<span class=\"token\" style=\"color:#393A34\">(</span>clean_df<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed | 58.1s\nFinal shape = (7092993, 38)\n[########################################] | 100% Completed | 51.1s\n[########################################] | 100% Completed | 48.9s\n</span></code><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>count</th>\n      <th>percent</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>date</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>serial_number</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>capacity_bytes</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>failure</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_1_raw</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_5_raw</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_7_raw</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_9_raw</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_10_raw</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_184_raw</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_187_raw</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_188_raw</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_189_raw</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_190_raw</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_193_raw</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_194_raw</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_197_raw</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_198_raw</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_240_raw</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_241_raw</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_242_raw</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_1_normalized</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_5_normalized</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_7_normalized</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_9_normalized</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_10_normalized</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_184_normalized</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_187_normalized</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_188_normalized</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_189_normalized</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_190_normalized</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_193_normalized</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_194_normalized</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_197_normalized</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_198_normalized</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_240_normalized</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_241_normalized</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>smart_242_normalized</th>\n      <td>0</td>\n      <td>0.0</td>\n    </tr>\n  </tbody>\n</table>\n</div></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>Repartition and Save</h2>\n<p>The size of dataset may have changed after cleanup, so repartition for efficiency, and then save to disk so that cleanup does not have to be done every time for experimentation.\nAccording to Dask docs, the ideal size of a partition is around 100 MB (source: <a href=\"https://docs.dask.org/en/latest/dataframe-best-practices.html\">https://docs.dask.org/en/latest/dataframe-best-practices.html</a>)</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[36]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># get ideal number of partitions</span>\nPARTITION_SIZE_BYTES <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">100</span> <span class=\"token\" style=\"color:#393A34\">*</span> <span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">**</span><span class=\"token\" style=\"color:#36acaa\">6</span>\nDF_SIZE_BYTES <span class=\"token\" style=\"color:#393A34\">=</span> clean_df<span class=\"token\" style=\"color:#393A34\">.</span>memory_usage<span class=\"token\" style=\"color:#393A34\">(</span>deep<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\nNUM_PARTITIONS <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">int</span><span class=\"token\" style=\"color:#393A34\">(</span>np<span class=\"token\" style=\"color:#393A34\">.</span>ceil<span class=\"token\" style=\"color:#393A34\">(</span>DF_SIZE_BYTES <span class=\"token\" style=\"color:#393A34\">/</span> PARTITION_SIZE_BYTES<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># repartition and save cleaned version of data</span>\nclean_df <span class=\"token\" style=\"color:#393A34\">=</span> clean_df<span class=\"token\" style=\"color:#393A34\">.</span>repartition<span class=\"token\" style=\"color:#393A34\">(</span>npartitions<span class=\"token\" style=\"color:#393A34\">=</span>NUM_PARTITIONS<span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># create save dir as same name as data dir, but suffixed with &quot;_clean&quot;</span>\nhead<span class=\"token\" style=\"color:#393A34\">,</span> tail <span class=\"token\" style=\"color:#393A34\">=</span> os<span class=\"token\" style=\"color:#393A34\">.</span>path<span class=\"token\" style=\"color:#393A34\">.</span>split<span class=\"token\" style=\"color:#393A34\">(</span>os<span class=\"token\" style=\"color:#393A34\">.</span>path<span class=\"token\" style=\"color:#393A34\">.</span>normpath<span class=\"token\" style=\"color:#393A34\">(</span>DATA_DIR<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\nsave_dir <span class=\"token\" style=\"color:#393A34\">=</span> os<span class=\"token\" style=\"color:#393A34\">.</span>path<span class=\"token\" style=\"color:#393A34\">.</span>join<span class=\"token\" style=\"color:#393A34\">(</span>head<span class=\"token\" style=\"color:#393A34\">,</span> tail<span class=\"token\" style=\"color:#393A34\">+</span><span class=\"token\" style=\"color:#A31515\">&#x27;_seagate_clean&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># if path doesnt exist, mkdir</span>\n<span class=\"token\" style=\"color:#0000ff\">if</span> <span class=\"token\" style=\"color:#0000ff\">not</span> os<span class=\"token\" style=\"color:#393A34\">.</span>path<span class=\"token\" style=\"color:#393A34\">.</span>exists<span class=\"token\" style=\"color:#393A34\">(</span>save_dir<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    os<span class=\"token\" style=\"color:#393A34\">.</span>makedirs<span class=\"token\" style=\"color:#393A34\">(</span>save_dir<span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># save partitions</span>\nclean_df<span class=\"token\" style=\"color:#393A34\">.</span>to_csv<span class=\"token\" style=\"color:#393A34\">(</span>os<span class=\"token\" style=\"color:#393A34\">.</span>path<span class=\"token\" style=\"color:#393A34\">.</span>join<span class=\"token\" style=\"color:#393A34\">(</span>save_dir<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;partition_*.csv&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> index<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">False</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>[########################################] | 100% Completed |  1min  1.5s\n[########################################] | 100% Completed |  3min 32.6s\n</span></code><pre><code><span>[&#x27;/home/kachauha/Downloads/data_Q3_2018_seagate_clean/partition_00.csv&#x27;,\n &#x27;/home/kachauha/Downloads/data_Q3_2018_seagate_clean/partition_01.csv&#x27;,\n &#x27;/home/kachauha/Downloads/data_Q3_2018_seagate_clean/partition_02.csv&#x27;,\n &#x27;/home/kachauha/Downloads/data_Q3_2018_seagate_clean/partition_03.csv&#x27;,\n &#x27;/home/kachauha/Downloads/data_Q3_2018_seagate_clean/partition_04.csv&#x27;,\n &#x27;/home/kachauha/Downloads/data_Q3_2018_seagate_clean/partition_05.csv&#x27;,\n &#x27;/home/kachauha/Downloads/data_Q3_2018_seagate_clean/partition_06.csv&#x27;,\n &#x27;/home/kachauha/Downloads/data_Q3_2018_seagate_clean/partition_07.csv&#x27;,\n &#x27;/home/kachauha/Downloads/data_Q3_2018_seagate_clean/partition_08.csv&#x27;,\n &#x27;/home/kachauha/Downloads/data_Q3_2018_seagate_clean/partition_09.csv&#x27;,\n &#x27;/home/kachauha/Downloads/data_Q3_2018_seagate_clean/partition_10.csv&#x27;,\n &#x27;/home/kachauha/Downloads/data_Q3_2018_seagate_clean/partition_11.csv&#x27;,\n &#x27;/home/kachauha/Downloads/data_Q3_2018_seagate_clean/partition_12.csv&#x27;,\n &#x27;/home/kachauha/Downloads/data_Q3_2018_seagate_clean/partition_13.csv&#x27;,\n &#x27;/home/kachauha/Downloads/data_Q3_2018_seagate_clean/partition_14.csv&#x27;,\n &#x27;/home/kachauha/Downloads/data_Q3_2018_seagate_clean/partition_15.csv&#x27;,\n &#x27;/home/kachauha/Downloads/data_Q3_2018_seagate_clean/partition_16.csv&#x27;,\n &#x27;/home/kachauha/Downloads/data_Q3_2018_seagate_clean/partition_17.csv&#x27;,\n &#x27;/home/kachauha/Downloads/data_Q3_2018_seagate_clean/partition_18.csv&#x27;,\n &#x27;/home/kachauha/Downloads/data_Q3_2018_seagate_clean/partition_19.csv&#x27;,\n &#x27;/home/kachauha/Downloads/data_Q3_2018_seagate_clean/partition_20.csv&#x27;]</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[37]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># unregister dask compute call progress bar</span>\npbar<span class=\"token\" style=\"color:#393A34\">.</span>unregister<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[ ]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"></code></pre></div></div></div></div>","fields":{"srcLink":"https://github.com/aicoe-aiops/ceph_drive_failure/blob/master/notebooks/step2a_data_cleaner_seagate.ipynb"}}},"pageContext":{"id":"503f4e39-c0d1-5c65-9b67-d8cec746d84a >>> JupyterNotebook"}},"staticQueryHashes":["117426894","3000541721"]}