{"componentChunkName":"component---src-templates-jupyter-notebook-js","path":"/data-science/ceph-drive-failure/notebooks/step3a_clustering_and_binaryclf.ipynb","result":{"data":{"site":{"siteMetadata":{"title":"Operate First"}},"jupyterNotebook":{"id":"ac38d250-9295-5a52-9981-5d8d165321a7 >>> JupyterNotebook","html":"<div class=\"notebook-render\"><div class=\"sc-ifAKCX zMCZx\"><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h1>Step 3: Clustering + Model Exploration</h1>\n<p>In this notebook, dataset is visualized and clustered, and some classification models are explored.</p>\n<p>First, dimensionality reduction is done using PCA and UMAP. This serves two purposes - to visualize the data, and to try to increase training speed and reduce overfitting.</p>\n<p>Data reduced to 3 dimentions is visualized to get a better understanding of how it is distributed and if there are any intrinsic patterns. This helps in forming the classification strategy. The interactive plots are stored as html files in the img directory.</p>\n<p>Since human-understandable visualization is limited to 3 dimensions, clustering methods are used to look for inherent patterns and clusterings. If well defined clusters are formed, then these methods could also be used for classification.</p>\n<p>Finally, some models are implemented and tested. These include SVM, Adaboost SVM Ensemble, XGBoost, and RGF. The models may or may not be able to learn well from a dataset reduced using PCA or UMAP, but it&#x27;s worth a shot.</p>\n<p>The following models will be explored in future versions:\n1. Neural network\n2. Classifiers based on embeddings learned from semi-supervised UMAP</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[1]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">import</span> os\n<span class=\"token\" style=\"color:#0000ff\">import</span> gc\n<span class=\"token\" style=\"color:#0000ff\">import</span> datetime\n<span class=\"token\" style=\"color:#0000ff\">import</span> cloudpickle\n\n<span class=\"token\" style=\"color:#0000ff\">import</span> numpy <span class=\"token\" style=\"color:#0000ff\">as</span> np\n<span class=\"token\" style=\"color:#0000ff\">import</span> pandas <span class=\"token\" style=\"color:#0000ff\">as</span> pd\n<span class=\"token\" style=\"color:#0000ff\">import</span> dask<span class=\"token\" style=\"color:#393A34\">.</span>array <span class=\"token\" style=\"color:#0000ff\">as</span> da\n<span class=\"token\" style=\"color:#0000ff\">import</span> dask<span class=\"token\" style=\"color:#393A34\">.</span>dataframe <span class=\"token\" style=\"color:#0000ff\">as</span> dd\n\n<span class=\"token\" style=\"color:#0000ff\">from</span> joblib <span class=\"token\" style=\"color:#0000ff\">import</span> parallel_backend</code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[2]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">from</span> matplotlib <span class=\"token\" style=\"color:#0000ff\">import</span> pyplot <span class=\"token\" style=\"color:#0000ff\">as</span> plt\n<span class=\"token\" style=\"color:#0000ff\">import</span> seaborn <span class=\"token\" style=\"color:#0000ff\">as</span> sns\n<span class=\"token\" style=\"color:#0000ff\">import</span> plotly\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># Display all cell outputs</span>\n<span class=\"token\" style=\"color:#0000ff\">from</span> IPython<span class=\"token\" style=\"color:#393A34\">.</span>core<span class=\"token\" style=\"color:#393A34\">.</span>interactiveshell <span class=\"token\" style=\"color:#0000ff\">import</span> InteractiveShell\nInteractiveShell<span class=\"token\" style=\"color:#393A34\">.</span>ast_node_interactivity <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&#x27;all&#x27;</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[3]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># start a local Dask client</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># use the daskboard at http://localhost:8787/status</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># NOTE: ProgressBar does not show up when client is initialized</span>\n<span class=\"token\" style=\"color:#0000ff\">from</span> dask<span class=\"token\" style=\"color:#393A34\">.</span>distributed <span class=\"token\" style=\"color:#0000ff\">import</span> Client \nclient <span class=\"token\" style=\"color:#393A34\">=</span> Client<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stderr\"><span>/home/kachauha/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/distributed/bokeh/core.py:74: UserWarning:\n\n\nPort 8787 is already in use. \nPerhaps you already have a cluster running?\nHosting the diagnostics dashboard on a random port instead.\n\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[4]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># inferred int64 types cause a type mismatch (int vs float) error when dask sees a null value</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># null values cannot be interpreted as ints</span>\ncustom_dtypes <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">{</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;date&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;object&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;serial_number&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;object&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;capacity_bytes&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;failure&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_1_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_1_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_5_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_5_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_7_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_7_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_10_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_10_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_184_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_184_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_187_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_187_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_188_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_188_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_189_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_189_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_190_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_190_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_193_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_193_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_194_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_194_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_197_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_197_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_198_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_198_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_240_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_240_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_241_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_241_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_242_normalized&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#A31515\">&quot;smart_242_raw&quot;</span><span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&quot;float32&quot;</span>\n<span class=\"token\" style=\"color:#393A34\">}</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[5]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># read all the cleaned seagate data into one dataframe</span>\nDATA_DIR <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&quot;/home/kachauha/Downloads/data_Q4_2018_clean&quot;</span>\nseagate_df <span class=\"token\" style=\"color:#393A34\">=</span> dd<span class=\"token\" style=\"color:#393A34\">.</span>read_csv<span class=\"token\" style=\"color:#393A34\">(</span>os<span class=\"token\" style=\"color:#393A34\">.</span>path<span class=\"token\" style=\"color:#393A34\">.</span>join<span class=\"token\" style=\"color:#393A34\">(</span>DATA_DIR<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;*.csv&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> dtype<span class=\"token\" style=\"color:#393A34\">=</span>custom_dtypes<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[6]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># get the serial numbers for all the failed hard drives</span>\nfailed_serials <span class=\"token\" style=\"color:#393A34\">=</span> seagate_df<span class=\"token\" style=\"color:#393A34\">[</span>seagate_df<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;failure&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">==</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>Collapse Time Dimension</h2>\n<p>Most of the classification models discussed cannot be directly applied to time series data, especially considering that the time series may be of different lengths. Therefore, time series are reduced to fixed-length feature vectors.</p>\n<p>The simplest and easiest method of collapsing time dimension is implemented for now. See <a href=\"https://trello.com/c/kIoGk9T1\">https://trello.com/c/kIoGk9T1</a> for a full list of representation techniques that could be explored.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[7]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># collapse time dim, drop cols that are unncessary for train data</span>\nseagate_df_grouped <span class=\"token\" style=\"color:#393A34\">=</span> seagate_df<span class=\"token\" style=\"color:#393A34\">.</span>drop<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;date&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;failure&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span> axis<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>groupby<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;serial_number&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># characterize a time series by simple stats - mean,std,max,min,size,kurtosis</span>\nmeans <span class=\"token\" style=\"color:#393A34\">=</span> seagate_df_grouped<span class=\"token\" style=\"color:#393A34\">.</span>mean<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\nmeans <span class=\"token\" style=\"color:#393A34\">=</span> means<span class=\"token\" style=\"color:#393A34\">.</span>rename<span class=\"token\" style=\"color:#393A34\">(</span>columns<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">{</span>col<span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&#x27;mean_&#x27;</span> <span class=\"token\" style=\"color:#393A34\">+</span> col <span class=\"token\" style=\"color:#0000ff\">for</span> col <span class=\"token\" style=\"color:#0000ff\">in</span> means<span class=\"token\" style=\"color:#393A34\">.</span>columns<span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">)</span>\n\nstds <span class=\"token\" style=\"color:#393A34\">=</span> seagate_df_grouped<span class=\"token\" style=\"color:#393A34\">.</span>std<span class=\"token\" style=\"color:#393A34\">(</span>ddof<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">)</span>\nstds <span class=\"token\" style=\"color:#393A34\">=</span> stds<span class=\"token\" style=\"color:#393A34\">.</span>rename<span class=\"token\" style=\"color:#393A34\">(</span>columns<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">{</span>col<span class=\"token\" style=\"color:#393A34\">:</span> <span class=\"token\" style=\"color:#A31515\">&#x27;std_&#x27;</span> <span class=\"token\" style=\"color:#393A34\">+</span> col <span class=\"token\" style=\"color:#0000ff\">for</span> col <span class=\"token\" style=\"color:#0000ff\">in</span> stds<span class=\"token\" style=\"color:#393A34\">.</span>columns<span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">)</span>\nstds <span class=\"token\" style=\"color:#393A34\">=</span> stds<span class=\"token\" style=\"color:#393A34\">.</span>fillna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">)</span>    <span class=\"token\" style=\"color:#008000;font-style:italic\"># FIXME: std returns nans even for ddof=0</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># maxs = seagate_df_grouped.max()</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># maxs = maxs.rename(columns={col: &#x27;max_&#x27; + col for col in maxs.columns})</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># mins = seagate_df_grouped.min()</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># mins = mins.rename(columns={col: &#x27;min_&#x27; + col for col in mins.columns})</span>\n\ndays <span class=\"token\" style=\"color:#393A34\">=</span> seagate_df_grouped<span class=\"token\" style=\"color:#393A34\">.</span>size<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>to_frame<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;days&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[8]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># join stats into one df</span>\nX_df <span class=\"token\" style=\"color:#393A34\">=</span> means<span class=\"token\" style=\"color:#393A34\">.</span>merge<span class=\"token\" style=\"color:#393A34\">(</span>right<span class=\"token\" style=\"color:#393A34\">=</span>stds<span class=\"token\" style=\"color:#393A34\">,</span> left_index<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">,</span> right_index<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># X_df = X_df.merge(right=maxs, left_index=True, right_index=True)</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># X_df = X_df.merge(right=mins, left_index=True, right_index=True)</span>\nX_df <span class=\"token\" style=\"color:#393A34\">=</span> X_df<span class=\"token\" style=\"color:#393A34\">.</span>merge<span class=\"token\" style=\"color:#393A34\">(</span>right<span class=\"token\" style=\"color:#393A34\">=</span>days<span class=\"token\" style=\"color:#393A34\">,</span> left_index<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">,</span> right_index<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[9]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># convert to dask array - some algos dont like dataframes</span>\nX_arr <span class=\"token\" style=\"color:#393A34\">=</span> X_df<span class=\"token\" style=\"color:#393A34\">.</span>to_dask_array<span class=\"token\" style=\"color:#393A34\">(</span>lengths<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[ ]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># sanity check - ensure no nans</span>\nX_df<span class=\"token\" style=\"color:#393A34\">.</span>isna<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">any</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">any</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[10]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># clean up memory</span>\n<span class=\"token\" style=\"color:#0000ff\">del</span> means\n<span class=\"token\" style=\"color:#0000ff\">del</span> stds\n<span class=\"token\" style=\"color:#0000ff\">del</span> days\ngc<span class=\"token\" style=\"color:#393A34\">.</span>collect<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>1181</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[11]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># get ground truth labels</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># NOTE: dask-xgboost needs this to be dask obejct</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># NOTE: if not converted to dask array, it is of nan shape</span>\nY_arr <span class=\"token\" style=\"color:#393A34\">=</span> da<span class=\"token\" style=\"color:#393A34\">.</span>from_array<span class=\"token\" style=\"color:#393A34\">(</span>X_df<span class=\"token\" style=\"color:#393A34\">.</span>index<span class=\"token\" style=\"color:#393A34\">.</span>isin<span class=\"token\" style=\"color:#393A34\">(</span>failed_serials<span class=\"token\" style=\"color:#393A34\">.</span>values<span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\nY_arr<span class=\"token\" style=\"color:#393A34\">.</span>shape</code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>(82993,)</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[12]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># true if drive had failed. used for indexing into Xtrain dask array</span>\nfailed_idx <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#393A34\">(</span>Y_arr<span class=\"token\" style=\"color:#393A34\">==</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\nfailed_idx<span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>341</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>Preprocess</h2></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[12]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">from</span> dask_ml<span class=\"token\" style=\"color:#393A34\">.</span>preprocessing <span class=\"token\" style=\"color:#0000ff\">import</span> StandardScaler<span class=\"token\" style=\"color:#393A34\">,</span> RobustScaler</code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[13]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">std_scaler <span class=\"token\" style=\"color:#393A34\">=</span> StandardScaler<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># rob_scaler = RobustScaler()</span>\n\nX_arr <span class=\"token\" style=\"color:#393A34\">=</span> std_scaler<span class=\"token\" style=\"color:#393A34\">.</span>fit_transform<span class=\"token\" style=\"color:#393A34\">(</span>X_arr<span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># X = rob_scaler.fit_transform(X)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>Save preprocessed</h2></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[20]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">da<span class=\"token\" style=\"color:#393A34\">.</span>to_npy_stack<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;preprocessed/X_arr&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> X_arr<span class=\"token\" style=\"color:#393A34\">)</span>\nda<span class=\"token\" style=\"color:#393A34\">.</span>to_npy_stack<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;preprocessed/Y_arr&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> Y_arr<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>Visualize</h2></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[19]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">from</span> sklearn<span class=\"token\" style=\"color:#393A34\">.</span>decomposition <span class=\"token\" style=\"color:#0000ff\">import</span> PCA<span class=\"token\" style=\"color:#393A34\">,</span> KernelPCA</code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[23]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># vanilla pca for visualization in 3d</span>\n<span class=\"token\" style=\"color:#0000ff\">with</span> parallel_backend<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;dask&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    pcs <span class=\"token\" style=\"color:#393A34\">=</span> PCA<span class=\"token\" style=\"color:#393A34\">(</span>n_components<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">3</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    X_pca <span class=\"token\" style=\"color:#393A34\">=</span> pcs<span class=\"token\" style=\"color:#393A34\">.</span>fit_transform<span class=\"token\" style=\"color:#393A34\">(</span>X_arr<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[57]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># plot</span>\nworking_pca <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span>\n    mode <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&quot;markers&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    name <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&quot;Working&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token builtin\">type</span> <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&quot;scatter3d&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>    \n    x <span class=\"token\" style=\"color:#393A34\">=</span> X_pca<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">~</span>failed_idx<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    y <span class=\"token\" style=\"color:#393A34\">=</span> X_pca<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">~</span>failed_idx<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    z <span class=\"token\" style=\"color:#393A34\">=</span> X_pca<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">~</span>failed_idx<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">2</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    marker <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span> size<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">2</span><span class=\"token\" style=\"color:#393A34\">,</span> color<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;rgb(0, 0, 200)&quot;</span> <span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#393A34\">)</span>\n\nfailed_pca <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span>\n    mode <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&quot;markers&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    name <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&quot;Failed&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token builtin\">type</span> <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&quot;scatter3d&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>    \n    x <span class=\"token\" style=\"color:#393A34\">=</span> X_pca<span class=\"token\" style=\"color:#393A34\">[</span>failed_idx<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    y <span class=\"token\" style=\"color:#393A34\">=</span> X_pca<span class=\"token\" style=\"color:#393A34\">[</span>failed_idx<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    z <span class=\"token\" style=\"color:#393A34\">=</span> X_pca<span class=\"token\" style=\"color:#393A34\">[</span>failed_idx<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">2</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    marker <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span> size<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">2</span><span class=\"token\" style=\"color:#393A34\">,</span> color<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;rgb(200, 0, 0)&quot;</span> <span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#393A34\">)</span>\n\nlayout_pca <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span>\n    title <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&#x27;Simple Reduction Euclidean PCA&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    scene <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span>\n        xaxis <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span> zeroline<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">False</span> <span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        yaxis <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span> zeroline<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">False</span> <span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        zaxis <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span> zeroline<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">False</span> <span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[56]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">fig <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span> data<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span>working_pca<span class=\"token\" style=\"color:#393A34\">,</span> failed_pca<span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span> layout<span class=\"token\" style=\"color:#393A34\">=</span>layout_pca <span class=\"token\" style=\"color:#393A34\">)</span>\nplotly<span class=\"token\" style=\"color:#393A34\">.</span>offline<span class=\"token\" style=\"color:#393A34\">.</span>plot<span class=\"token\" style=\"color:#393A34\">(</span>fig<span class=\"token\" style=\"color:#393A34\">,</span> filename<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;../reports/figures/pca/seagate_simple_euclidean.html&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> auto_open<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>&#x27;seagate_pca_scatter.html&#x27;</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[ ]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\">#################################################################</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#   KERNEL PCA RUNS OUT OF MEMORY for rbf, sigmoid, cosine      #</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#################################################################</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># # euclidean is not good enough for the dims we have. go nonlinear</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># with parallel_backend(&#x27;dask&#x27;):</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     kpca = KernelPCA(n_components=3, kernel=&#x27;cosine&#x27;, random_state=42)</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     X_kpca = kpca.fit_transform(X_arr)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[ ]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># # plot</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># working_kpca = dict(</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     mode = &quot;markers&quot;,</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     name = &quot;Working&quot;,</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     type = &quot;scatter3d&quot;,    </span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     x = X_kpca[~failed_idx, 0],</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     y = X_kpca[~failed_idx, 1],</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     z = X_kpca[~failed_idx, 2],</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     marker = dict( size=2, color=&quot;rgb(0, 0, 200)&quot; )</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># )</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># failed_kpca = dict(</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     mode = &quot;markers&quot;,</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     name = &quot;Failed&quot;,</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     type = &quot;scatter3d&quot;,    </span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     x = X_kpca[failed_idx, 0],</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     y = X_kpca[failed_idx, 1],</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     z = X_kpca[failed_idx, 2],</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     marker = dict( size=2, color=&quot;rgb(200, 0, 0)&quot; )</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># )</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># layout_kpca = dict(</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     title = &#x27;Simple Reduction RBF PCA&#x27;,</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     scene = dict(</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#         xaxis = dict( zeroline=False ),</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#         yaxis = dict( zeroline=False ),</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#         zaxis = dict( zeroline=False ),</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#     )</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># )</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[ ]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># fig = dict( data=[working_kpca, failed_kpca], layout=layout_kpca )</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># plotly.offline.plot(fig, filename=&#x27;seagate_kpca_rbf.html&#x27;, auto_open=True)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[19]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">from</span> umap <span class=\"token\" style=\"color:#0000ff\">import</span> UMAP</code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[40]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># visualize using umap (tsne may be too expensive)</span>\n<span class=\"token\" style=\"color:#0000ff\">with</span> parallel_backend<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;dask&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    ucs <span class=\"token\" style=\"color:#393A34\">=</span> UMAP<span class=\"token\" style=\"color:#393A34\">(</span>n_components<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">3</span><span class=\"token\" style=\"color:#393A34\">,</span>\n               metric<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;canberra&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n               n_neighbors<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">32</span><span class=\"token\" style=\"color:#393A34\">,</span>\n               random_state<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">42</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    X_umap <span class=\"token\" style=\"color:#393A34\">=</span> ucs<span class=\"token\" style=\"color:#393A34\">.</span>fit_transform<span class=\"token\" style=\"color:#393A34\">(</span>X_arr<span class=\"token\" style=\"color:#393A34\">,</span> y<span class=\"token\" style=\"color:#393A34\">=</span>da<span class=\"token\" style=\"color:#393A34\">.</span>where<span class=\"token\" style=\"color:#393A34\">(</span>Y_arr<span class=\"token\" style=\"color:#393A34\">==</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">,</span> Y_arr<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stderr\"><span>/home/kachauha/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/numba/compiler.py:588: NumbaPerformanceWarning:\n\n</span><span>\nThe keyword argument &#x27;parallel=True&#x27; was specified but no transformation for parallel execution was possible.\n\nTo find out why, try turning on parallel diagnostics, see http://numba.pydata.org/numba-doc/latest/user/parallel.html#diagnostics for help.\n</span><span>\nFile &quot;../../.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/umap/nndescent.py&quot;, line 47:</span><span>\n</span><span>    @numba.njit(parallel=True)\n</span><span>    def nn_descent(\n</span><span>    </span><span>^</span><span>\n</span><span>\n\n/home/kachauha/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/umap/umap_.py:569: NumbaWarning:\n\n</span><span>\nCompilation is falling back to object mode WITH looplifting enabled because Function &quot;categorical_simplicial_set_intersection&quot; failed type inference due to: </span><span>non-precise type pyobject</span><span>\n</span><span>[1] During: typing of argument at /home/kachauha/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/umap/umap_.py (599)</span><span>\n</span><span>\nFile &quot;../../.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/umap/umap_.py&quot;, line 599:</span><span>\n</span><span>def categorical_simplicial_set_intersection(\n    &lt;source elided&gt;\n    &quot;&quot;&quot;\n</span><span>    simplicial_set = simplicial_set.tocoo()\n</span><span>    </span><span>^</span><span>\n</span><span>\n\n/home/kachauha/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/numba/compiler.py:725: NumbaWarning:\n\n</span><span>Function &quot;categorical_simplicial_set_intersection&quot; was compiled in object mode without forceobj=True.\n</span><span>\nFile &quot;../../.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/umap/umap_.py&quot;, line 570:</span><span>\n</span><span>@numba.jit()\n</span><span>def categorical_simplicial_set_intersection(\n</span><span>^</span><span>\n</span><span>\n\n/home/kachauha/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/numba/compiler.py:734: NumbaDeprecationWarning:\n\n</span><span>\nFall-back from the nopython compilation path to the object mode compilation path has been detected, this is deprecated behaviour.\n\nFor more information visit http://numba.pydata.org/numba-doc/latest/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit\n</span><span>\nFile &quot;../../.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/umap/umap_.py&quot;, line 570:</span><span>\n</span><span>@numba.jit()\n</span><span>def categorical_simplicial_set_intersection(\n</span><span>^</span><span>\n</span><span>\n\n/home/kachauha/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/umap/umap_.py:541: NumbaWarning:\n\n</span><span>\nCompilation is falling back to object mode WITH looplifting enabled because Function &quot;reset_local_connectivity&quot; failed type inference due to: </span><span>Untyped global name &#x27;normalize&#x27;:</span><span> </span><span>cannot determine Numba type of &lt;class &#x27;function&#x27;&gt;</span><span>\n</span><span>\nFile &quot;../../.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/umap/umap_.py&quot;, line 560:</span><span>\n</span><span>def reset_local_connectivity(simplicial_set):\n    &lt;source elided&gt;\n    &quot;&quot;&quot;\n</span><span>    simplicial_set = normalize(simplicial_set, norm=&quot;max&quot;)\n</span><span>    </span><span>^</span><span>\n</span><span>\n\n/home/kachauha/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/numba/compiler.py:725: NumbaWarning:\n\n</span><span>Function &quot;reset_local_connectivity&quot; was compiled in object mode without forceobj=True.\n</span><span>\nFile &quot;../../.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/umap/umap_.py&quot;, line 542:</span><span>\n</span><span>@numba.jit()\n</span><span>def reset_local_connectivity(simplicial_set):\n</span><span>^</span><span>\n</span><span>\n\n/home/kachauha/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/numba/compiler.py:734: NumbaDeprecationWarning:\n\n</span><span>\nFall-back from the nopython compilation path to the object mode compilation path has been detected, this is deprecated behaviour.\n\nFor more information visit http://numba.pydata.org/numba-doc/latest/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit\n</span><span>\nFile &quot;../../.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/umap/umap_.py&quot;, line 542:</span><span>\n</span><span>@numba.jit()\n</span><span>def reset_local_connectivity(simplicial_set):\n</span><span>^</span><span>\n</span><span>\n\n/home/kachauha/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/umap/spectral.py:229: UserWarning:\n\nEmbedding a total of 3 separate connected components using meta-embedding (experimental)\n\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[41]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># plot</span>\nworking_umap <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span>\n    mode <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&quot;markers&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    name <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&quot;Working&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token builtin\">type</span> <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&quot;scatter3d&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>    \n    x <span class=\"token\" style=\"color:#393A34\">=</span> X_umap<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">~</span>failed_idx<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    y <span class=\"token\" style=\"color:#393A34\">=</span> X_umap<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">~</span>failed_idx<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    z <span class=\"token\" style=\"color:#393A34\">=</span> X_umap<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">~</span>failed_idx<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">2</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    marker <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span> size<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">2</span><span class=\"token\" style=\"color:#393A34\">,</span> color<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;rgb(0, 0, 200)&quot;</span> <span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#393A34\">)</span>\n\nfailed_umap <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span>\n    mode <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&quot;markers&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    name <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&quot;Failed&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token builtin\">type</span> <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&quot;scatter3d&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span>    \n    x <span class=\"token\" style=\"color:#393A34\">=</span> X_umap<span class=\"token\" style=\"color:#393A34\">[</span>failed_idx<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    y <span class=\"token\" style=\"color:#393A34\">=</span> X_umap<span class=\"token\" style=\"color:#393A34\">[</span>failed_idx<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    z <span class=\"token\" style=\"color:#393A34\">=</span> X_umap<span class=\"token\" style=\"color:#393A34\">[</span>failed_idx<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">2</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    marker <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span> size<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">2</span><span class=\"token\" style=\"color:#393A34\">,</span> color<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;rgb(200, 0, 0)&quot;</span> <span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#393A34\">)</span>\n\nlayout_umap <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span>\n    title <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#A31515\">&#x27;Simple Reduction Canberra UMAP, Semisupervised&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    scene <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span>\n        xaxis <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span> zeroline<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">False</span> <span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        yaxis <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span> zeroline<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">False</span> <span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span>\n        zaxis <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span> zeroline<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">False</span> <span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span>\n    <span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[42]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">fig <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span> data<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span>working_umap<span class=\"token\" style=\"color:#393A34\">,</span> failed_umap<span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span> layout<span class=\"token\" style=\"color:#393A34\">=</span>layout_umap <span class=\"token\" style=\"color:#393A34\">)</span>\nplotly<span class=\"token\" style=\"color:#393A34\">.</span>offline<span class=\"token\" style=\"color:#393A34\">.</span>plot<span class=\"token\" style=\"color:#393A34\">(</span>fig<span class=\"token\" style=\"color:#393A34\">,</span> filename<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;../reports/figures/umap/seagate_n32_canberra_ss.html&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> auto_open<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>&#x27;seagate_umapn32_canberra_ss.html&#x27;</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>Reduce Data</h2>\n<p>Since UMAP seems to be creating useful embeddings, we can use the embeddings as the reduced dataset and classify on that instead. There is some description of this method in the original paper, and a lot of description and documentation in umap-learn</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[156]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># keep 20 out of 67 dimensions</span>\nfeat_reducer <span class=\"token\" style=\"color:#393A34\">=</span> UMAP<span class=\"token\" style=\"color:#393A34\">(</span>n_components<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">20</span><span class=\"token\" style=\"color:#393A34\">,</span> \n                    metric<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;chebyshev&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> \n                    n_neighbors<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">15</span><span class=\"token\" style=\"color:#393A34\">,</span>\n                    random_state<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">42</span><span class=\"token\" style=\"color:#393A34\">)</span>\nX_umap <span class=\"token\" style=\"color:#393A34\">=</span> feat_reducer<span class=\"token\" style=\"color:#393A34\">.</span>fit_transform<span class=\"token\" style=\"color:#393A34\">(</span>X_arr<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stderr\"><span>/home/kachauha/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/numba/compiler.py:588: NumbaPerformanceWarning:\n\n</span><span>\nThe keyword argument &#x27;parallel=True&#x27; was specified but no transformation for parallel execution was possible.\n\nTo find out why, try turning on parallel diagnostics, see http://numba.pydata.org/numba-doc/latest/user/parallel.html#diagnostics for help.\n</span><span>\nFile &quot;../../.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/umap/nndescent.py&quot;, line 47:</span><span>\n</span><span>    @numba.njit(parallel=True)\n</span><span>    def nn_descent(\n</span><span>    </span><span>^</span><span>\n</span><span>\n\n/home/kachauha/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/umap/spectral.py:229: UserWarning:\n\nEmbedding a total of 3 separate connected components using meta-embedding (experimental)\n\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>Dask Model Saving Utility</h2>\n<p>Since models could be either dask models or sklearn models, using just pickle or joblib may not suffice because dask models contain delayed objects. Therefore, models are saved using cloudpickle, which has been tested to work (for trivial cases, at least).</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[14]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">def</span> <span class=\"token\" style=\"color:#393A34\">save_model</span><span class=\"token\" style=\"color:#393A34\">(</span>model<span class=\"token\" style=\"color:#393A34\">,</span> fname<span class=\"token\" style=\"color:#393A34\">,</span> suffix<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">None</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;Serialize and save a dask or sklearn model\n    \n    Arguments:\n        model {dask_ml or sklearn object} -- trained model to save\n        fname {str} -- name of file to write to\n    \n    Keyword Arguments:\n        suffix {str} -- suffix in the filename (default: {None})\n                        This serves as the identifier of the current\n                        state of the model\n                        If not provided, the current timestamp is used\n    &quot;&quot;&quot;</span>\n    <span class=\"token\" style=\"color:#008000;font-style:italic\"># generate default suffix if needed</span>\n    <span class=\"token\" style=\"color:#0000ff\">if</span> suffix <span class=\"token\" style=\"color:#0000ff\">is</span> <span class=\"token\" style=\"color:#36acaa\">None</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        suffix <span class=\"token\" style=\"color:#393A34\">=</span> datetime<span class=\"token\" style=\"color:#393A34\">.</span>datetime<span class=\"token\" style=\"color:#393A34\">.</span>now<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span>strftime<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;%b_%d_%Y_%H_%M_%S&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    \n    <span class=\"token\" style=\"color:#008000;font-style:italic\"># serialize and write</span>\n    <span class=\"token\" style=\"color:#0000ff\">with</span> <span class=\"token builtin\">open</span><span class=\"token\" style=\"color:#393A34\">(</span>fname <span class=\"token\" style=\"color:#393A34\">+</span> <span class=\"token\" style=\"color:#A31515\">&#x27;_&#x27;</span> <span class=\"token\" style=\"color:#393A34\">+</span> suffix <span class=\"token\" style=\"color:#393A34\">+</span> <span class=\"token\" style=\"color:#A31515\">&#x27;.cpkl&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#A31515\">&#x27;wb&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span> <span class=\"token\" style=\"color:#0000ff\">as</span> <span class=\"token builtin\">file</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        cloudpickle<span class=\"token\" style=\"color:#393A34\">.</span>dump<span class=\"token\" style=\"color:#393A34\">(</span>model<span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token builtin\">file</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>Clusters</h2></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[15]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">from</span> sklearn<span class=\"token\" style=\"color:#393A34\">.</span>cluster <span class=\"token\" style=\"color:#0000ff\">import</span> KMeans<span class=\"token\" style=\"color:#393A34\">,</span> SpectralClustering<span class=\"token\" style=\"color:#393A34\">,</span> DBSCAN\n<span class=\"token\" style=\"color:#0000ff\">from</span> sklearn<span class=\"token\" style=\"color:#393A34\">.</span>metrics <span class=\"token\" style=\"color:#0000ff\">import</span> confusion_matrix<span class=\"token\" style=\"color:#393A34\">,</span> homogeneity_completeness_v_measure<span class=\"token\" style=\"color:#393A34\">,</span> precision_recall_fscore_support</code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h3>Distance Based</h3></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[93]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">with</span> parallel_backend<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;dask&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token\" style=\"color:#0000ff\">for</span> k <span class=\"token\" style=\"color:#0000ff\">in</span> <span class=\"token builtin\">range</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">2</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        <span class=\"token\" style=\"color:#008000;font-style:italic\"># find kmeans clusters for current k</span>\n        km <span class=\"token\" style=\"color:#393A34\">=</span> KMeans<span class=\"token\" style=\"color:#393A34\">(</span>n_clusters<span class=\"token\" style=\"color:#393A34\">=</span>k<span class=\"token\" style=\"color:#393A34\">,</span> random_state<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">42</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        km<span class=\"token\" style=\"color:#393A34\">.</span>fit<span class=\"token\" style=\"color:#393A34\">(</span>X_arr<span class=\"token\" style=\"color:#393A34\">)</span>\n        \n        <span class=\"token\" style=\"color:#008000;font-style:italic\"># get metrics for current k</span>\n        h<span class=\"token\" style=\"color:#393A34\">,</span> c<span class=\"token\" style=\"color:#393A34\">,</span> v <span class=\"token\" style=\"color:#393A34\">=</span> homogeneity_completeness_v_measure<span class=\"token\" style=\"color:#393A34\">(</span>Y_train<span class=\"token\" style=\"color:#393A34\">,</span> km<span class=\"token\" style=\"color:#393A34\">.</span>labels_<span class=\"token\" style=\"color:#393A34\">)</span>\n        <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;========================================&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;k={}: H={}, C={}, V={}&quot;</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">format</span><span class=\"token\" style=\"color:#393A34\">(</span>k<span class=\"token\" style=\"color:#393A34\">,</span> h<span class=\"token\" style=\"color:#393A34\">,</span> c<span class=\"token\" style=\"color:#393A34\">,</span> v<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;conf mat:&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span>confusion_matrix<span class=\"token\" style=\"color:#393A34\">(</span>Y_train<span class=\"token\" style=\"color:#393A34\">,</span> km<span class=\"token\" style=\"color:#393A34\">.</span>labels_<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>========================================\nk= 2: H=6.848515299160378e-05, C=1.9800378535589948e-05, V=3.071923405442396e-05\nconf mat:\n[[81119  1533]\n [  336     5]]\n========================================\nk= 3: H=0.00037707201658545404, C=0.00010120982184295491, V=0.0001595853681000266\nconf mat:\n[[81118  1338   196]\n [  336     5     0]\n [    0     0     0]]\n========================================\nk= 4: H=0.0004120967325706981, C=0.00010087610130649623, V=0.00016207763451594342\nconf mat:\n[[81118   908   148   478]\n [  336     4     0     1]\n [    0     0     0     0]\n [    0     0     0     0]]\n========================================\nk= 5: H=0.0004702256468091204, C=0.00011183461948498203, V=0.0001806943690480539\nconf mat:\n[[81089   906   149   478    30]\n [  336     4     0     1     0]\n [    0     0     0     0     0]\n [    0     0     0     0     0]\n [    0     0     0     0     0]]\n========================================\nk= 6: H=0.00044448513054675645, C=9.974303213248817e-05, V=0.00016292539673169366\nconf mat:\n[[81089   624   130   326   454    29]\n [  336     3     0     1     1     0]\n [    0     0     0     0     0     0]\n [    0     0     0     0     0     0]\n [    0     0     0     0     0     0]\n [    0     0     0     0     0     0]]\n========================================\nk= 7: H=0.00047757221853384613, C=0.00010564183528245437, V=0.00017301231105696234\nconf mat:\n[[81089   684    69   272   125   384    29]\n [  336     3     0     1     0     1     0]\n [    0     0     0     0     0     0     0]\n [    0     0     0     0     0     0     0]\n [    0     0     0     0     0     0     0]\n [    0     0     0     0     0     0     0]\n [    0     0     0     0     0     0     0]]\n========================================\nk= 8: H=0.0008230870194975019, C=0.00017629472566943523, V=0.0002903913364560139\nconf mat:\n[[81089   553   106   197   332    29   301    45]\n [  336     2     0     0     1     0     2     0]\n [    0     0     0     0     0     0     0     0]\n [    0     0     0     0     0     0     0     0]\n [    0     0     0     0     0     0     0     0]\n [    0     0     0     0     0     0     0     0]\n [    0     0     0     0     0     0     0     0]\n [    0     0     0     0     0     0     0     0]]\n========================================\nk= 9: H=0.0009658610061478699, C=0.0002026164729450131, V=0.0003349646936674023\nconf mat:\n[[81089   329    94   176    29   275   500   127    33]\n [  336     1     0     0     0     1     3     0     0]\n [    0     0     0     0     0     0     0     0     0]\n [    0     0     0     0     0     0     0     0     0]\n [    0     0     0     0     0     0     0     0     0]\n [    0     0     0     0     0     0     0     0     0]\n [    0     0     0     0     0     0     0     0     0]\n [    0     0     0     0     0     0     0     0     0]\n [    0     0     0     0     0     0     0     0     0]]\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[16]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">with</span> parallel_backend<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;dask&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token\" style=\"color:#0000ff\">for</span> k <span class=\"token\" style=\"color:#0000ff\">in</span> <span class=\"token builtin\">range</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">2</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">6</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        <span class=\"token\" style=\"color:#008000;font-style:italic\"># find kmeans clusters for current k</span>\n        sc <span class=\"token\" style=\"color:#393A34\">=</span> SpectralClustering<span class=\"token\" style=\"color:#393A34\">(</span>n_clusters<span class=\"token\" style=\"color:#393A34\">=</span>k<span class=\"token\" style=\"color:#393A34\">,</span> random_state<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">42</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        sc<span class=\"token\" style=\"color:#393A34\">.</span>fit<span class=\"token\" style=\"color:#393A34\">(</span>X_arr<span class=\"token\" style=\"color:#393A34\">)</span>\n        \n        <span class=\"token\" style=\"color:#008000;font-style:italic\"># get metrics for current k</span>\n        h<span class=\"token\" style=\"color:#393A34\">,</span> c<span class=\"token\" style=\"color:#393A34\">,</span> v <span class=\"token\" style=\"color:#393A34\">=</span> homogeneity_completeness_v_measure<span class=\"token\" style=\"color:#393A34\">(</span>Y_train<span class=\"token\" style=\"color:#393A34\">,</span> sc<span class=\"token\" style=\"color:#393A34\">.</span>labels_<span class=\"token\" style=\"color:#393A34\">)</span>\n        <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;========================================&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;k={}: H={}, C={}, V={}&quot;</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">format</span><span class=\"token\" style=\"color:#393A34\">(</span>k<span class=\"token\" style=\"color:#393A34\">,</span> h<span class=\"token\" style=\"color:#393A34\">,</span> c<span class=\"token\" style=\"color:#393A34\">,</span> v<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;conf mat:&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span>confusion_matrix<span class=\"token\" style=\"color:#393A34\">(</span>Y_train<span class=\"token\" style=\"color:#393A34\">,</span> sc<span class=\"token\" style=\"color:#393A34\">.</span>labels_<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-traceback\"><span style=\"color:rgb(187, 0, 0)\">---------------------------------------------------------------------------</span><span>\n</span><span style=\"color:rgb(187, 0, 0)\">MemoryError</span><span>                               Traceback (most recent call last)\n</span><span style=\"color:rgb(0, 187, 0)\">&lt;ipython-input-16-7411fa244531&gt;</span><span> in </span><span style=\"color:rgb(0, 187, 187)\">&lt;module&gt;</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">      3</span><span>         </span><span style=\"color:rgb(187, 0, 0)\"># find kmeans clusters for current k</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">      4</span><span>         </span><span>sc</span><span> </span><span style=\"color:rgb(0, 0, 187)\">=</span><span> </span><span>SpectralClustering</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>n_clusters</span><span style=\"color:rgb(0, 0, 187)\">=</span><span>k</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>random_state</span><span style=\"color:rgb(0, 0, 187)\">=</span><span style=\"color:rgb(0, 187, 187)\">42</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">----&gt; 5</span><span style=\"color:rgb(187, 0, 0)\">         </span><span>sc</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>fit</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>X_train</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">      6</span><span> </span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">      7</span><span>         </span><span style=\"color:rgb(187, 0, 0)\"># get metrics for current k</span><span>\n\n</span><span style=\"color:rgb(0, 187, 0)\">~/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/sklearn/cluster/spectral.py</span><span> in </span><span style=\"color:rgb(0, 187, 187)\">fit</span><span style=\"color:rgb(0, 0, 187)\">(self, X, y)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    482</span><span>             self.affinity_matrix_ = pairwise_kernels(X, metric=self.affinity,\n</span><span style=\"color:rgb(0, 187, 0)\">    483</span><span>                                                      </span><span>filter_params</span><span style=\"color:rgb(0, 0, 187)\">=</span><span style=\"color:rgb(0, 187, 0)\">True</span><span style=\"color:rgb(0, 0, 187)\">,</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">--&gt; 484</span><span style=\"color:rgb(187, 0, 0)\">                                                      **params)\n</span><span style=\"color:rgb(0, 187, 0)\">    485</span><span> </span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    486</span><span>         </span><span>random_state</span><span> </span><span style=\"color:rgb(0, 0, 187)\">=</span><span> </span><span>check_random_state</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>self</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>random_state</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n\n</span><span style=\"color:rgb(0, 187, 0)\">~/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/sklearn/metrics/pairwise.py</span><span> in </span><span style=\"color:rgb(0, 187, 187)\">pairwise_kernels</span><span style=\"color:rgb(0, 0, 187)\">(X, Y, metric, filter_params, n_jobs, **kwds)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">   1743</span><span>         </span><span style=\"color:rgb(0, 187, 0)\">raise</span><span> </span><span>ValueError</span><span style=\"color:rgb(0, 0, 187)\">(</span><span style=\"color:rgb(0, 0, 187)\">&quot;Unknown kernel %r&quot;</span><span> </span><span style=\"color:rgb(0, 0, 187)\">%</span><span> </span><span>metric</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">   1744</span><span> </span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">-&gt; 1745</span><span style=\"color:rgb(187, 0, 0)\">     </span><span style=\"color:rgb(0, 187, 0)\">return</span><span> </span><span>_parallel_pairwise</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>X</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>Y</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>func</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>n_jobs</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span style=\"color:rgb(0, 0, 187)\">**</span><span>kwds</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">~/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/sklearn/metrics/pairwise.py</span><span> in </span><span style=\"color:rgb(0, 187, 187)\">_parallel_pairwise</span><span style=\"color:rgb(0, 0, 187)\">(X, Y, func, n_jobs, **kwds)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">   1208</span><span>     </span><span style=\"color:rgb(187, 0, 0)\"># enforce a threading backend to prevent data communication overhead</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">   1209</span><span>     </span><span>fd</span><span> </span><span style=\"color:rgb(0, 0, 187)\">=</span><span> </span><span>delayed</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>_dist_wrapper</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">-&gt; 1210</span><span style=\"color:rgb(187, 0, 0)\">     </span><span>ret</span><span> </span><span style=\"color:rgb(0, 0, 187)\">=</span><span> </span><span>np</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>empty</span><span style=\"color:rgb(0, 0, 187)\">(</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>X</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>shape</span><span style=\"color:rgb(0, 0, 187)\">[</span><span style=\"color:rgb(0, 187, 187)\">0</span><span style=\"color:rgb(0, 0, 187)\">]</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>Y</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>shape</span><span style=\"color:rgb(0, 0, 187)\">[</span><span style=\"color:rgb(0, 187, 187)\">0</span><span style=\"color:rgb(0, 0, 187)\">]</span><span style=\"color:rgb(0, 0, 187)\">)</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>dtype</span><span style=\"color:rgb(0, 0, 187)\">=</span><span>dtype</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>order</span><span style=\"color:rgb(0, 0, 187)\">=</span><span style=\"color:rgb(0, 0, 187)\">&#x27;F&#x27;</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">   1211</span><span>     Parallel(backend=&quot;threading&quot;, n_jobs=n_jobs)(\n</span><span style=\"color:rgb(0, 187, 0)\">   1212</span><span>         </span><span>fd</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>func</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>ret</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>s</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>X</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>Y</span><span style=\"color:rgb(0, 0, 187)\">[</span><span>s</span><span style=\"color:rgb(0, 0, 187)\">]</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span style=\"color:rgb(0, 0, 187)\">**</span><span>kwds</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n\n</span><span style=\"color:rgb(187, 0, 0)\">MemoryError</span><span>: </span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h3>Density Based</h3>\n<p>To use density based clkustering, we must find a good metric and its &quot;threshold&quot; value for points belonging in a cluster. This requires tuning.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[25]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">from</span> sklearn<span class=\"token\" style=\"color:#393A34\">.</span>neighbors <span class=\"token\" style=\"color:#0000ff\">import</span> DistanceMetric\nman <span class=\"token\" style=\"color:#393A34\">=</span> DistanceMetric<span class=\"token\" style=\"color:#393A34\">.</span>get_metric<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;manhattan&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span>\nX_df<span class=\"token\" style=\"color:#393A34\">.</span>index<span class=\"token\" style=\"color:#393A34\">.</span>head<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>Index([&#x27;6VDHZ9H9&#x27;, &#x27;6VDHZAKY&#x27;, &#x27;6VDHZATY&#x27;, &#x27;6VDHZAXD&#x27;, &#x27;6VDHZB48&#x27;], dtype=&#x27;object&#x27;, name=&#x27;serial_number&#x27;)</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[36]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">foo <span class=\"token\" style=\"color:#393A34\">=</span> X_df<span class=\"token\" style=\"color:#393A34\">.</span>loc<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;6VDHZAXD&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># bar = X_df.loc[&#x27;6VDHZATY&#x27;, :].compute()</span>\n<span class=\"token\" style=\"color:#0000ff\">import</span> scipy\nscipy<span class=\"token\" style=\"color:#393A34\">.</span>spatial<span class=\"token\" style=\"color:#393A34\">.</span>distance<span class=\"token\" style=\"color:#393A34\">.</span>cityblock<span class=\"token\" style=\"color:#393A34\">(</span>foo<span class=\"token\" style=\"color:#393A34\">,</span> bar<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>38.522346242013505</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[39]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">with</span> parallel_backend<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;dask&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token\" style=\"color:#0000ff\">for</span> epsilon <span class=\"token\" style=\"color:#0000ff\">in</span> <span class=\"token builtin\">range</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">6</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n        <span class=\"token\" style=\"color:#008000;font-style:italic\"># find kmeans clusters for current k</span>\n        db <span class=\"token\" style=\"color:#393A34\">=</span> DBSCAN<span class=\"token\" style=\"color:#393A34\">(</span>metric<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;manhattan&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> eps<span class=\"token\" style=\"color:#393A34\">=</span>epsilon<span class=\"token\" style=\"color:#393A34\">)</span>\n        db<span class=\"token\" style=\"color:#393A34\">.</span>fit<span class=\"token\" style=\"color:#393A34\">(</span>X_arr<span class=\"token\" style=\"color:#393A34\">)</span>\n        \n        <span class=\"token\" style=\"color:#008000;font-style:italic\"># get metrics for current k</span>\n        h<span class=\"token\" style=\"color:#393A34\">,</span> c<span class=\"token\" style=\"color:#393A34\">,</span> v <span class=\"token\" style=\"color:#393A34\">=</span> homogeneity_completeness_v_measure<span class=\"token\" style=\"color:#393A34\">(</span>Y_train<span class=\"token\" style=\"color:#393A34\">,</span> db<span class=\"token\" style=\"color:#393A34\">.</span>labels_<span class=\"token\" style=\"color:#393A34\">)</span>\n        <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;========================================&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;e={}: H={}, C={}, V={}&quot;</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">format</span><span class=\"token\" style=\"color:#393A34\">(</span>epsilon<span class=\"token\" style=\"color:#393A34\">,</span> h<span class=\"token\" style=\"color:#393A34\">,</span> c<span class=\"token\" style=\"color:#393A34\">,</span> v<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;conf mat:&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n        <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span>confusion_matrix<span class=\"token\" style=\"color:#393A34\">(</span>Y_train<span class=\"token\" style=\"color:#393A34\">,</span> db<span class=\"token\" style=\"color:#393A34\">.</span>labels_<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>========================================\ne=1: H=0.0040969275756273325, C=0.0005331403538892181, V=0.0009435012404910959\nconf mat:\n[[    0     0     0 ...     0     0     0]\n [80478     5    11 ...     5     6     4]\n [  341     0     0 ...     0     0     0]\n ...\n [    0     0     0 ...     0     0     0]\n [    0     0     0 ...     0     0     0]\n [    0     0     0 ...     0     0     0]]\n========================================\ne=2: H=0.1669530204593021, C=0.0017809033841935226, V=0.00352421365383619\nconf mat:\n[[    0     0     0 ...     0     0     0]\n [26300 13254   119 ...     5     3     3]\n [  337     1     0 ...     0     0     0]\n ...\n [    0     0     0 ...     0     0     0]\n [    0     0     0 ...     0     0     0]\n [    0     0     0 ...     0     0     0]]\n========================================\ne=3: H=0.32776595457007096, C=0.004098996279768483, V=0.008096735885950135\nconf mat:\n[[    0     0     0 ...     0     0     0]\n [ 8132 16991    21 ...    21     5     5]\n [  331     4     0 ...     0     0     0]\n ...\n [    0     0     0 ...     0     0     0]\n [    0     0     0 ...     0     0     0]\n [    0     0     0 ...     0     0     0]]\n========================================\ne=4: H=0.4098237829785913, C=0.006056014861894233, V=0.011935655126138254\nconf mat:\n[[    0     0     0 ...     0     0     0]\n [ 3825    10 21214 ...     8  1199    32]\n [  321     0     5 ...     0     0     0]\n ...\n [    0     0     0 ...     0     0     0]\n [    0     0     0 ...     0     0     0]\n [    0     0     0 ...     0     0     0]]\n========================================\ne=5: H=0.43639244244612746, C=0.00710538602028686, V=0.013983097823219073\nconf mat:\n[[    0     0     0 ...     0     0     0]\n [ 2300    11 22560 ...    12    12  1199]\n [  305     0    10 ...     0     0     0]\n ...\n [    0     0     0 ...     0     0     0]\n [    0     0     0 ...     0     0     0]\n [    0     0     0 ...     0     0     0]]\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>Split Data for Models</h2>\n<p>Since there is a large class imbalance in the dataset, the splitting must be done such that the percentages of classes in the splits is the same as those in the overall data.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[23]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">from</span> sklearn<span class=\"token\" style=\"color:#393A34\">.</span>model_selection <span class=\"token\" style=\"color:#0000ff\">import</span> train_test_split</code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[24]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># split the original dataset</span>\n<span class=\"token\" style=\"color:#0000ff\">with</span> parallel_backend<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;dask&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    X_train<span class=\"token\" style=\"color:#393A34\">,</span> X_test<span class=\"token\" style=\"color:#393A34\">,</span> Y_train<span class=\"token\" style=\"color:#393A34\">,</span> Y_test <span class=\"token\" style=\"color:#393A34\">=</span> train_test_split<span class=\"token\" style=\"color:#393A34\">(</span>X_arr<span class=\"token\" style=\"color:#393A34\">,</span> Y_arr<span class=\"token\" style=\"color:#393A34\">,</span> stratify<span class=\"token\" style=\"color:#393A34\">=</span>Y_arr<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[ ]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># split the reduced dataset</span>\n<span class=\"token\" style=\"color:#0000ff\">with</span> parallel_backend<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;dask&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    X_train_umap<span class=\"token\" style=\"color:#393A34\">,</span> X_test_umap<span class=\"token\" style=\"color:#393A34\">,</span> Y_train_umap<span class=\"token\" style=\"color:#393A34\">,</span> Y_test_umap <span class=\"token\" style=\"color:#393A34\">=</span> train_test_split<span class=\"token\" style=\"color:#393A34\">(</span>X_umap<span class=\"token\" style=\"color:#393A34\">,</span> Y_arr<span class=\"token\" style=\"color:#393A34\">,</span> stratify<span class=\"token\" style=\"color:#393A34\">=</span>Y_arr<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>NOTE</h2>\n<p>All the following models except svm have been fit on the entire dataset. They all do poorly (cant overfit).</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>XGBoost (vanilla + UMAP reduced)</h2></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[16]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">from</span> dask_ml<span class=\"token\" style=\"color:#393A34\">.</span>xgboost <span class=\"token\" style=\"color:#0000ff\">import</span> XGBClassifier</code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[30]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># vanilla classifier</span>\nxgbc <span class=\"token\" style=\"color:#393A34\">=</span> XGBClassifier<span class=\"token\" style=\"color:#393A34\">(</span>max_depth<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">6</span><span class=\"token\" style=\"color:#393A34\">,</span> random_state<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">42</span><span class=\"token\" style=\"color:#393A34\">)</span>\nxgbc<span class=\"token\" style=\"color:#393A34\">.</span>fit<span class=\"token\" style=\"color:#393A34\">(</span>X_train_arr<span class=\"token\" style=\"color:#393A34\">,</span> Y_train<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>XGBClassifier(base_score=0.5, booster=&#x27;gbtree&#x27;, colsample_bylevel=1,\n              colsample_bynode=1, colsample_bytree=1, gamma=0,\n              learning_rate=0.1, max_delta_step=0, max_depth=6,\n              min_child_weight=1, missing=None, n_estimators=100, n_jobs=1,\n              nthread=None, objective=&#x27;binary:logistic&#x27;, random_state=42,\n              reg_alpha=0, reg_lambda=1, scale_pos_weight=1, seed=None,\n              silent=None, subsample=1, verbosity=1)</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[32]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">preds <span class=\"token\" style=\"color:#393A34\">=</span> xgbc<span class=\"token\" style=\"color:#393A34\">.</span>predict<span class=\"token\" style=\"color:#393A34\">(</span>X_train_arr<span class=\"token\" style=\"color:#393A34\">)</span>\nconfusion_matrix<span class=\"token\" style=\"color:#393A34\">(</span>Y_train<span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> preds<span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>array([[    0, 82652],\n       [    0,   341]])</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[33]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># reduced data classifier</span>\nxgbc_umap <span class=\"token\" style=\"color:#393A34\">=</span> XGBClassifier<span class=\"token\" style=\"color:#393A34\">(</span>max_depth<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">6</span><span class=\"token\" style=\"color:#393A34\">,</span> random_state<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">42</span><span class=\"token\" style=\"color:#393A34\">)</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># xgbc_umap = XGBClassifier(learning_rate=0.1,</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#                                max_depth=3,</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#                                min_child_weight=0.5,</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#                                reg_lambda=0.01,</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#                                reg_alpha=0.01,</span>\n<span class=\"token\" style=\"color:#008000;font-style:italic\">#                                random_state=42)</span>\nxgbc_umap<span class=\"token\" style=\"color:#393A34\">.</span>fit<span class=\"token\" style=\"color:#393A34\">(</span>da<span class=\"token\" style=\"color:#393A34\">.</span>from_array<span class=\"token\" style=\"color:#393A34\">(</span>X_train_umap<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> Y_train<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>XGBClassifier(base_score=0.5, booster=&#x27;gbtree&#x27;, colsample_bylevel=1,\n              colsample_bynode=1, colsample_bytree=1, gamma=0,\n              learning_rate=0.1, max_delta_step=0, max_depth=6,\n              min_child_weight=1, missing=None, n_estimators=100, n_jobs=1,\n              nthread=None, objective=&#x27;binary:logistic&#x27;, random_state=42,\n              reg_alpha=0, reg_lambda=1, scale_pos_weight=1, seed=None,\n              silent=None, subsample=1, verbosity=1)</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[34]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">preds <span class=\"token\" style=\"color:#393A34\">=</span> xgbc_umap<span class=\"token\" style=\"color:#393A34\">.</span>predict<span class=\"token\" style=\"color:#393A34\">(</span>da<span class=\"token\" style=\"color:#393A34\">.</span>from_array<span class=\"token\" style=\"color:#393A34\">(</span>X_train_umap<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span>\nconfusion_matrix<span class=\"token\" style=\"color:#393A34\">(</span>Y_train<span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span> preds<span class=\"token\" style=\"color:#393A34\">.</span>compute<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>array([[    0, 82652],\n       [    0,   341]])</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[35]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">gc<span class=\"token\" style=\"color:#393A34\">.</span>collect<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>2649</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>SVM</h2></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[44]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">from</span> sklearn<span class=\"token\" style=\"color:#393A34\">.</span>svm <span class=\"token\" style=\"color:#0000ff\">import</span> SVC</code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[76]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">with</span> parallel_backend<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;dask&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    svc <span class=\"token\" style=\"color:#393A34\">=</span> SVC<span class=\"token\" style=\"color:#393A34\">(</span>C<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">,</span> class_weight<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;balanced&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> probability<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">,</span> random_state<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">42</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    svc<span class=\"token\" style=\"color:#393A34\">.</span>fit<span class=\"token\" style=\"color:#393A34\">(</span>X_train<span class=\"token\" style=\"color:#393A34\">,</span> Y_train<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stderr\"><span>/home/kachauha/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/sklearn/svm/base.py:193: FutureWarning:\n\nThe default value of gamma will change from &#x27;auto&#x27; to &#x27;scale&#x27; in version 0.22 to account better for unscaled features. Set gamma explicitly to &#x27;auto&#x27; or &#x27;scale&#x27; to avoid this warning.\n\n</span></code><pre><code><span>SVC(C=5, cache_size=200, class_weight=&#x27;balanced&#x27;, coef0=0.0,\n    decision_function_shape=&#x27;ovr&#x27;, degree=3, gamma=&#x27;auto_deprecated&#x27;,\n    kernel=&#x27;rbf&#x27;, max_iter=-1, probability=True, random_state=42,\n    shrinking=True, tol=0.001, verbose=False)</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[77]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">with</span> parallel_backend<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;dask&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    prob_preds_train <span class=\"token\" style=\"color:#393A34\">=</span> svc<span class=\"token\" style=\"color:#393A34\">.</span>predict_proba<span class=\"token\" style=\"color:#393A34\">(</span>X_train<span class=\"token\" style=\"color:#393A34\">)</span>\n    prob_preds_test <span class=\"token\" style=\"color:#393A34\">=</span> svc<span class=\"token\" style=\"color:#393A34\">.</span>predict_proba<span class=\"token\" style=\"color:#393A34\">(</span>X_test<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[78]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># threshold probability for model train on all data = ~0.3</span>\nTRAIN_THRESHOLD_PROBA <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">0.5</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># how well did it fit on the train data</span>\nconfmat_train <span class=\"token\" style=\"color:#393A34\">=</span> confusion_matrix<span class=\"token\" style=\"color:#393A34\">(</span>Y_train<span class=\"token\" style=\"color:#393A34\">,</span> prob_preds_train<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">&gt;</span> TRAIN_THRESHOLD_PROBA<span class=\"token\" style=\"color:#393A34\">)</span>\nsns<span class=\"token\" style=\"color:#393A34\">.</span>heatmap<span class=\"token\" style=\"color:#393A34\">(</span>confmat_train <span class=\"token\" style=\"color:#393A34\">/</span> confmat_train<span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span>axis<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">,</span> keepdims<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            vmin<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            vmax<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            annot<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            cmap<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;Blues&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f0847eeddd8&gt;</span></code></pre><img alt=\"\" src=\"data:image/png;base64,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\n\" class=\"sc-bdVaJa jFcqvn\"/></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[84]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># how well does it generalize</span>\nTEST_THRESHOLD_PROBA <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">0.005</span>\nconfmat_test <span class=\"token\" style=\"color:#393A34\">=</span> confusion_matrix<span class=\"token\" style=\"color:#393A34\">(</span>Y_test<span class=\"token\" style=\"color:#393A34\">,</span> prob_preds_test<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">&gt;</span> TEST_THRESHOLD_PROBA<span class=\"token\" style=\"color:#393A34\">)</span>\nsns<span class=\"token\" style=\"color:#393A34\">.</span>heatmap<span class=\"token\" style=\"color:#393A34\">(</span>confmat_test <span class=\"token\" style=\"color:#393A34\">/</span> confmat_test<span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span>axis<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">,</span> keepdims<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            vmin<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            vmax<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            annot<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            cmap<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;Blues&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f0853382fd0&gt;</span></code></pre><img alt=\"\" src=\"data:image/png;base64,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\n\" class=\"sc-bdVaJa jFcqvn\"/></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[149]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># grid search for best threshold proba</span>\n<span class=\"token\" style=\"color:#0000ff\">for</span> prob <span class=\"token\" style=\"color:#0000ff\">in</span> np<span class=\"token\" style=\"color:#393A34\">.</span>arange<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0.33</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">0.36</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">0.005</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    curr_preds <span class=\"token\" style=\"color:#393A34\">=</span> prob_preds_test<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">&gt;</span> prob\n    p<span class=\"token\" style=\"color:#393A34\">,</span> r<span class=\"token\" style=\"color:#393A34\">,</span> f<span class=\"token\" style=\"color:#393A34\">,</span> _ <span class=\"token\" style=\"color:#393A34\">=</span> precision_recall_fscore_support<span class=\"token\" style=\"color:#393A34\">(</span>y_true<span class=\"token\" style=\"color:#393A34\">=</span>Y_test<span class=\"token\" style=\"color:#393A34\">,</span> y_pred<span class=\"token\" style=\"color:#393A34\">=</span>curr_preds<span class=\"token\" style=\"color:#393A34\">,</span> average<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;binary&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    <span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;p={:2f}, prec={:2f}, rec={:2f}, f={:2f}&#x27;</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">format</span><span class=\"token\" style=\"color:#393A34\">(</span>prob<span class=\"token\" style=\"color:#393A34\">,</span> p<span class=\"token\" style=\"color:#393A34\">,</span> r<span class=\"token\" style=\"color:#393A34\">,</span> f<span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>p=0.330000, prec=0.656716, rec=0.517647, f=0.578947\np=0.335000, prec=0.676923, rec=0.517647, f=0.586667\np=0.340000, prec=0.671875, rec=0.505882, f=0.577181\np=0.345000, prec=0.671875, rec=0.505882, f=0.577181\np=0.350000, prec=0.666667, rec=0.494118, f=0.567568\np=0.355000, prec=0.672131, rec=0.482353, f=0.561644\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>SVM Ensemble</h2></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[43]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">from</span> sklearn<span class=\"token\" style=\"color:#393A34\">.</span>ensemble <span class=\"token\" style=\"color:#0000ff\">import</span> AdaBoostClassifier</code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[ ]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">with</span> parallel_backend<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;dask&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    <span class=\"token\" style=\"color:#008000;font-style:italic\"># init adaboosted ensemble of svm classifiers</span>\n    ada_base_learner <span class=\"token\" style=\"color:#393A34\">=</span> SVC<span class=\"token\" style=\"color:#393A34\">(</span>C<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">2.5</span><span class=\"token\" style=\"color:#393A34\">,</span> class_weight<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;balanced&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span> probability<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">,</span> random_state<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">42</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    ada_clf <span class=\"token\" style=\"color:#393A34\">=</span> AdaBoostClassifier<span class=\"token\" style=\"color:#393A34\">(</span>base_estimator<span class=\"token\" style=\"color:#393A34\">=</span>ada_base_learner<span class=\"token\" style=\"color:#393A34\">,</span>\n                                n_estimators<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">100</span><span class=\"token\" style=\"color:#393A34\">,</span>\n                                learning_rate<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0.5</span><span class=\"token\" style=\"color:#393A34\">,</span>\n                                random_state<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">42</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    <span class=\"token\" style=\"color:#008000;font-style:italic\"># training time</span>\n    ada_clf<span class=\"token\" style=\"color:#393A34\">.</span>fit<span class=\"token\" style=\"color:#393A34\">(</span>X_train<span class=\"token\" style=\"color:#393A34\">,</span> Y_train<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[ ]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># how well did it do</span>\n<span class=\"token\" style=\"color:#0000ff\">with</span> parallel_backend<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;dask&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    ada_probs_train <span class=\"token\" style=\"color:#393A34\">=</span> ada_clf<span class=\"token\" style=\"color:#393A34\">.</span>predict_proba<span class=\"token\" style=\"color:#393A34\">(</span>X_train<span class=\"token\" style=\"color:#393A34\">)</span>\n    ada_probs_test <span class=\"token\" style=\"color:#393A34\">=</span> ada_clf<span class=\"token\" style=\"color:#393A34\">.</span>predict_proba<span class=\"token\" style=\"color:#393A34\">(</span>X_test<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[ ]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">TRAIN_THRESHOLD_PROBA <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">0.5</span>\nada_confmat_train <span class=\"token\" style=\"color:#393A34\">=</span> confusion_matrix<span class=\"token\" style=\"color:#393A34\">(</span>Y_train<span class=\"token\" style=\"color:#393A34\">,</span> ada_probs_train<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">&gt;</span> TRAIN_THRESHOLD_PROBA<span class=\"token\" style=\"color:#393A34\">)</span>\nsns<span class=\"token\" style=\"color:#393A34\">.</span>heatmap<span class=\"token\" style=\"color:#393A34\">(</span>ada_confmat_train <span class=\"token\" style=\"color:#393A34\">/</span> ada_confmat_train<span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span>axis<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">,</span> keepdims<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            vmin<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            vmax<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            annot<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            cmap<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;Blues&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[ ]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">TEST_THRESHOLD_PROBA <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">0.005</span>\nada_confmat_test <span class=\"token\" style=\"color:#393A34\">=</span> confusion_matrix<span class=\"token\" style=\"color:#393A34\">(</span>Y_test<span class=\"token\" style=\"color:#393A34\">,</span> ada_probs_test<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">&gt;</span> TEST_THRESHOLD_PROBA<span class=\"token\" style=\"color:#393A34\">)</span>\nsns<span class=\"token\" style=\"color:#393A34\">.</span>heatmap<span class=\"token\" style=\"color:#393A34\">(</span>ada_confmat_test <span class=\"token\" style=\"color:#393A34\">/</span> ada_confmat_test<span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span>axis<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">,</span> keepdims<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            vmin<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            vmax<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            annot<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            cmap<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;Blues&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>RGF</h2></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[21]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">from</span> rgf<span class=\"token\" style=\"color:#393A34\">.</span>sklearn <span class=\"token\" style=\"color:#0000ff\">import</span> RGFClassifier</code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stderr\"><span>/home/kachauha/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/sklearn/externals/joblib/__init__.py:15: DeprecationWarning:\n\nsklearn.externals.joblib is deprecated in 0.21 and will be removed in 0.23. Please import this functionality directly from joblib, which can be installed with: pip install joblib. If this warning is raised when loading pickled models, you may need to re-serialize those models with scikit-learn 0.21+.\n\n/home/kachauha/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/sklearn/externals/six.py:31: DeprecationWarning:\n\nThe module is deprecated in version 0.21 and will be removed in version 0.23 since we&#x27;ve dropped support for Python 2.7. Please rely on the official version of six (https://pypi.org/project/six/).\n\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[25]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\">rgfc <span class=\"token\" style=\"color:#393A34\">=</span> RGFClassifier<span class=\"token\" style=\"color:#393A34\">(</span>max_leaf<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">5000</span><span class=\"token\" style=\"color:#393A34\">,</span> l2<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1e</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">,</span> learning_rate<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0.01</span><span class=\"token\" style=\"color:#393A34\">)</span>\nrgfc<span class=\"token\" style=\"color:#393A34\">.</span>fit<span class=\"token\" style=\"color:#393A34\">(</span>X_train<span class=\"token\" style=\"color:#393A34\">,</span> Y_train<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-traceback\"><span style=\"color:rgb(187, 0, 0)\">---------------------------------------------------------------------------</span><span>\n</span><span style=\"color:rgb(187, 0, 0)\">KeyboardInterrupt</span><span>                         Traceback (most recent call last)\n</span><span style=\"color:rgb(0, 187, 0)\">&lt;ipython-input-25-5cce4edb81a6&gt;</span><span> in </span><span style=\"color:rgb(0, 187, 187)\">&lt;module&gt;</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">      1</span><span> </span><span>rgfc</span><span> </span><span style=\"color:rgb(0, 0, 187)\">=</span><span> </span><span>RGFClassifier</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>max_leaf</span><span style=\"color:rgb(0, 0, 187)\">=</span><span style=\"color:rgb(0, 187, 187)\">5000</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>l2</span><span style=\"color:rgb(0, 0, 187)\">=</span><span style=\"color:rgb(0, 187, 187)\">1e-10</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>learning_rate</span><span style=\"color:rgb(0, 0, 187)\">=</span><span style=\"color:rgb(0, 187, 187)\">0.01</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">----&gt; 2</span><span style=\"color:rgb(187, 0, 0)\"> </span><span>rgfc</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>fit</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>X_train</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>Y_train</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">~/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/rgf/utils.py</span><span> in </span><span style=\"color:rgb(0, 187, 187)\">fit</span><span style=\"color:rgb(0, 0, 187)\">(self, X, y, sample_weight)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    533</span><span>         </span><span>self</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>_validate_params</span><span style=\"color:rgb(0, 0, 187)\">(</span><span style=\"color:rgb(0, 0, 187)\">**</span><span>self</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>get_params</span><span style=\"color:rgb(0, 0, 187)\">(</span><span style=\"color:rgb(0, 0, 187)\">)</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    534</span><span> </span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">--&gt; 535</span><span style=\"color:rgb(187, 0, 0)\">         </span><span>X</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>y</span><span> </span><span style=\"color:rgb(0, 0, 187)\">=</span><span> </span><span>check_X_y</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>X</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>y</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>accept_sparse</span><span style=\"color:rgb(0, 0, 187)\">=</span><span style=\"color:rgb(0, 187, 0)\">True</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    536</span><span>         </span><span style=\"color:rgb(0, 187, 0)\">if</span><span> </span><span>sp</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>isspmatrix</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>X</span><span style=\"color:rgb(0, 0, 187)\">)</span><span style=\"color:rgb(0, 0, 187)\">:</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    537</span><span>             </span><span>self</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>_is_sparse_train_X</span><span> </span><span style=\"color:rgb(0, 0, 187)\">=</span><span> </span><span style=\"color:rgb(0, 187, 0)\">True</span><span>\n\n</span><span style=\"color:rgb(0, 187, 0)\">~/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/sklearn/utils/validation.py</span><span> in </span><span style=\"color:rgb(0, 187, 187)\">check_X_y</span><span style=\"color:rgb(0, 0, 187)\">(X, y, accept_sparse, accept_large_sparse, dtype, order, copy, force_all_finite, ensure_2d, allow_nd, multi_output, ensure_min_samples, ensure_min_features, y_numeric, warn_on_dtype, estimator)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    717</span><span>                     </span><span>ensure_min_features</span><span style=\"color:rgb(0, 0, 187)\">=</span><span>ensure_min_features</span><span style=\"color:rgb(0, 0, 187)\">,</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    718</span><span>                     </span><span>warn_on_dtype</span><span style=\"color:rgb(0, 0, 187)\">=</span><span>warn_on_dtype</span><span style=\"color:rgb(0, 0, 187)\">,</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">--&gt; 719</span><span style=\"color:rgb(187, 0, 0)\">                     estimator=estimator)\n</span><span style=\"color:rgb(0, 187, 0)\">    720</span><span>     </span><span style=\"color:rgb(0, 187, 0)\">if</span><span> </span><span>multi_output</span><span style=\"color:rgb(0, 0, 187)\">:</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    721</span><span>         y = check_array(y, &#x27;csr&#x27;, force_all_finite=True, ensure_2d=False,\n\n</span><span style=\"color:rgb(0, 187, 0)\">~/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/sklearn/utils/validation.py</span><span> in </span><span style=\"color:rgb(0, 187, 187)\">check_array</span><span style=\"color:rgb(0, 0, 187)\">(array, accept_sparse, accept_large_sparse, dtype, order, copy, force_all_finite, ensure_2d, allow_nd, ensure_min_samples, ensure_min_features, warn_on_dtype, estimator)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    494</span><span>             </span><span style=\"color:rgb(0, 187, 0)\">try</span><span style=\"color:rgb(0, 0, 187)\">:</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    495</span><span>                 </span><span>warnings</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>simplefilter</span><span style=\"color:rgb(0, 0, 187)\">(</span><span style=\"color:rgb(0, 0, 187)\">&#x27;error&#x27;</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>ComplexWarning</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">--&gt; 496</span><span style=\"color:rgb(187, 0, 0)\">                 </span><span>array</span><span> </span><span style=\"color:rgb(0, 0, 187)\">=</span><span> </span><span>np</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>asarray</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>array</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>dtype</span><span style=\"color:rgb(0, 0, 187)\">=</span><span>dtype</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>order</span><span style=\"color:rgb(0, 0, 187)\">=</span><span>order</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    497</span><span>             </span><span style=\"color:rgb(0, 187, 0)\">except</span><span> </span><span>ComplexWarning</span><span style=\"color:rgb(0, 0, 187)\">:</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    498</span><span>                 raise ValueError(&quot;Complex data not supported\\n&quot;\n\n</span><span style=\"color:rgb(0, 187, 0)\">~/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/numpy/core/numeric.py</span><span> in </span><span style=\"color:rgb(0, 187, 187)\">asarray</span><span style=\"color:rgb(0, 0, 187)\">(a, dtype, order)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    536</span><span> </span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    537</span><span>     &quot;&quot;&quot;\n</span><span style=\"color:rgb(0, 187, 0)\">--&gt; 538</span><span style=\"color:rgb(187, 0, 0)\">     </span><span style=\"color:rgb(0, 187, 0)\">return</span><span> </span><span>array</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>a</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>dtype</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>copy</span><span style=\"color:rgb(0, 0, 187)\">=</span><span style=\"color:rgb(0, 187, 0)\">False</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>order</span><span style=\"color:rgb(0, 0, 187)\">=</span><span>order</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    539</span><span> </span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    540</span><span> </span><span>\n\n</span><span style=\"color:rgb(0, 187, 0)\">~/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/dask/array/core.py</span><span> in </span><span style=\"color:rgb(0, 187, 187)\">__array__</span><span style=\"color:rgb(0, 0, 187)\">(self, dtype, **kwargs)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">   1199</span><span> </span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">   1200</span><span>     </span><span style=\"color:rgb(0, 187, 0)\">def</span><span> </span><span>__array__</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>self</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>dtype</span><span style=\"color:rgb(0, 0, 187)\">=</span><span style=\"color:rgb(0, 187, 0)\">None</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span style=\"color:rgb(0, 0, 187)\">**</span><span>kwargs</span><span style=\"color:rgb(0, 0, 187)\">)</span><span style=\"color:rgb(0, 0, 187)\">:</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">-&gt; 1201</span><span style=\"color:rgb(187, 0, 0)\">         </span><span>x</span><span> </span><span style=\"color:rgb(0, 0, 187)\">=</span><span> </span><span>self</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>compute</span><span style=\"color:rgb(0, 0, 187)\">(</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">   1202</span><span>         </span><span style=\"color:rgb(0, 187, 0)\">if</span><span> </span><span>dtype</span><span> </span><span style=\"color:rgb(0, 187, 0)\">and</span><span> </span><span>x</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>dtype</span><span> </span><span style=\"color:rgb(0, 0, 187)\">!=</span><span> </span><span>dtype</span><span style=\"color:rgb(0, 0, 187)\">:</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">   1203</span><span>             </span><span>x</span><span> </span><span style=\"color:rgb(0, 0, 187)\">=</span><span> </span><span>x</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>astype</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>dtype</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n\n</span><span style=\"color:rgb(0, 187, 0)\">~/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/dask/base.py</span><span> in </span><span style=\"color:rgb(0, 187, 187)\">compute</span><span style=\"color:rgb(0, 0, 187)\">(self, **kwargs)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    173</span><span>         </span><span>dask</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>base</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>compute</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    174</span><span>         &quot;&quot;&quot;\n</span><span style=\"color:rgb(0, 187, 0)\">--&gt; 175</span><span style=\"color:rgb(187, 0, 0)\">         </span><span style=\"color:rgb(0, 0, 187)\">(</span><span>result</span><span style=\"color:rgb(0, 0, 187)\">,</span><span style=\"color:rgb(0, 0, 187)\">)</span><span> </span><span style=\"color:rgb(0, 0, 187)\">=</span><span> </span><span>compute</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>self</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>traverse</span><span style=\"color:rgb(0, 0, 187)\">=</span><span style=\"color:rgb(0, 187, 0)\">False</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span style=\"color:rgb(0, 0, 187)\">**</span><span>kwargs</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    176</span><span>         </span><span style=\"color:rgb(0, 187, 0)\">return</span><span> </span><span>result</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    177</span><span> </span><span>\n\n</span><span style=\"color:rgb(0, 187, 0)\">~/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/dask/base.py</span><span> in </span><span style=\"color:rgb(0, 187, 187)\">compute</span><span style=\"color:rgb(0, 0, 187)\">(*args, **kwargs)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    444</span><span>     </span><span>keys</span><span> </span><span style=\"color:rgb(0, 0, 187)\">=</span><span> </span><span style=\"color:rgb(0, 0, 187)\">[</span><span>x</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>__dask_keys__</span><span style=\"color:rgb(0, 0, 187)\">(</span><span style=\"color:rgb(0, 0, 187)\">)</span><span> </span><span style=\"color:rgb(0, 187, 0)\">for</span><span> </span><span>x</span><span> </span><span style=\"color:rgb(0, 187, 0)\">in</span><span> </span><span>collections</span><span style=\"color:rgb(0, 0, 187)\">]</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    445</span><span>     </span><span>postcomputes</span><span> </span><span style=\"color:rgb(0, 0, 187)\">=</span><span> </span><span style=\"color:rgb(0, 0, 187)\">[</span><span>x</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>__dask_postcompute__</span><span style=\"color:rgb(0, 0, 187)\">(</span><span style=\"color:rgb(0, 0, 187)\">)</span><span> </span><span style=\"color:rgb(0, 187, 0)\">for</span><span> </span><span>x</span><span> </span><span style=\"color:rgb(0, 187, 0)\">in</span><span> </span><span>collections</span><span style=\"color:rgb(0, 0, 187)\">]</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">--&gt; 446</span><span style=\"color:rgb(187, 0, 0)\">     </span><span>results</span><span> </span><span style=\"color:rgb(0, 0, 187)\">=</span><span> </span><span>schedule</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>dsk</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>keys</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span style=\"color:rgb(0, 0, 187)\">**</span><span>kwargs</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    447</span><span>     </span><span style=\"color:rgb(0, 187, 0)\">return</span><span> </span><span>repack</span><span style=\"color:rgb(0, 0, 187)\">(</span><span style=\"color:rgb(0, 0, 187)\">[</span><span>f</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>r</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span style=\"color:rgb(0, 0, 187)\">*</span><span>a</span><span style=\"color:rgb(0, 0, 187)\">)</span><span> </span><span style=\"color:rgb(0, 187, 0)\">for</span><span> </span><span>r</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span style=\"color:rgb(0, 0, 187)\">(</span><span>f</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>a</span><span style=\"color:rgb(0, 0, 187)\">)</span><span> </span><span style=\"color:rgb(0, 187, 0)\">in</span><span> </span><span>zip</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>results</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>postcomputes</span><span style=\"color:rgb(0, 0, 187)\">)</span><span style=\"color:rgb(0, 0, 187)\">]</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    448</span><span> </span><span>\n\n</span><span style=\"color:rgb(0, 187, 0)\">~/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/distributed/client.py</span><span> in </span><span style=\"color:rgb(0, 187, 187)\">get</span><span style=\"color:rgb(0, 0, 187)\">(self, dsk, keys, restrictions, loose_restrictions, resources, sync, asynchronous, direct, retries, priority, fifo_timeout, actors, **kwargs)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">   2566</span><span>                     </span><span>should_rejoin</span><span> </span><span style=\"color:rgb(0, 0, 187)\">=</span><span> </span><span style=\"color:rgb(0, 187, 0)\">False</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">   2567</span><span>             </span><span style=\"color:rgb(0, 187, 0)\">try</span><span style=\"color:rgb(0, 0, 187)\">:</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">-&gt; 2568</span><span style=\"color:rgb(187, 0, 0)\">                 </span><span>results</span><span> </span><span style=\"color:rgb(0, 0, 187)\">=</span><span> </span><span>self</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>gather</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>packed</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>asynchronous</span><span style=\"color:rgb(0, 0, 187)\">=</span><span>asynchronous</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>direct</span><span style=\"color:rgb(0, 0, 187)\">=</span><span>direct</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">   2569</span><span>             </span><span style=\"color:rgb(0, 187, 0)\">finally</span><span style=\"color:rgb(0, 0, 187)\">:</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">   2570</span><span>                 </span><span style=\"color:rgb(0, 187, 0)\">for</span><span> </span><span>f</span><span> </span><span style=\"color:rgb(0, 187, 0)\">in</span><span> </span><span>futures</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>values</span><span style=\"color:rgb(0, 0, 187)\">(</span><span style=\"color:rgb(0, 0, 187)\">)</span><span style=\"color:rgb(0, 0, 187)\">:</span><span>\n\n</span><span style=\"color:rgb(0, 187, 0)\">~/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/distributed/client.py</span><span> in </span><span style=\"color:rgb(0, 187, 187)\">gather</span><span style=\"color:rgb(0, 0, 187)\">(self, futures, errors, maxsize, direct, asynchronous)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">   1820</span><span>                 </span><span>direct</span><span style=\"color:rgb(0, 0, 187)\">=</span><span>direct</span><span style=\"color:rgb(0, 0, 187)\">,</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">   1821</span><span>                 </span><span>local_worker</span><span style=\"color:rgb(0, 0, 187)\">=</span><span>local_worker</span><span style=\"color:rgb(0, 0, 187)\">,</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">-&gt; 1822</span><span style=\"color:rgb(187, 0, 0)\">                 </span><span>asynchronous</span><span style=\"color:rgb(0, 0, 187)\">=</span><span>asynchronous</span><span style=\"color:rgb(0, 0, 187)\">,</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">   1823</span><span>             )\n</span><span style=\"color:rgb(0, 187, 0)\">   1824</span><span> </span><span>\n\n</span><span style=\"color:rgb(0, 187, 0)\">~/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/distributed/client.py</span><span> in </span><span style=\"color:rgb(0, 187, 187)\">sync</span><span style=\"color:rgb(0, 0, 187)\">(self, func, *args, **kwargs)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    751</span><span>             </span><span style=\"color:rgb(0, 187, 0)\">return</span><span> </span><span>future</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    752</span><span>         </span><span style=\"color:rgb(0, 187, 0)\">else</span><span style=\"color:rgb(0, 0, 187)\">:</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">--&gt; 753</span><span style=\"color:rgb(187, 0, 0)\">             </span><span style=\"color:rgb(0, 187, 0)\">return</span><span> </span><span>sync</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>self</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>loop</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>func</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span style=\"color:rgb(0, 0, 187)\">*</span><span>args</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span style=\"color:rgb(0, 0, 187)\">**</span><span>kwargs</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    754</span><span> </span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    755</span><span>     </span><span style=\"color:rgb(0, 187, 0)\">def</span><span> </span><span>__repr__</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>self</span><span style=\"color:rgb(0, 0, 187)\">)</span><span style=\"color:rgb(0, 0, 187)\">:</span><span>\n\n</span><span style=\"color:rgb(0, 187, 0)\">~/.local/share/virtualenvs/ceph_drive_failure-3-2yJKyM/lib/python3.7/site-packages/distributed/utils.py</span><span> in </span><span style=\"color:rgb(0, 187, 187)\">sync</span><span style=\"color:rgb(0, 0, 187)\">(loop, func, *args, **kwargs)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    327</span><span>     </span><span style=\"color:rgb(0, 187, 0)\">else</span><span style=\"color:rgb(0, 0, 187)\">:</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    328</span><span>         </span><span style=\"color:rgb(0, 187, 0)\">while</span><span> </span><span style=\"color:rgb(0, 187, 0)\">not</span><span> </span><span>e</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>is_set</span><span style=\"color:rgb(0, 0, 187)\">(</span><span style=\"color:rgb(0, 0, 187)\">)</span><span style=\"color:rgb(0, 0, 187)\">:</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">--&gt; 329</span><span style=\"color:rgb(187, 0, 0)\">             </span><span>e</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>wait</span><span style=\"color:rgb(0, 0, 187)\">(</span><span style=\"color:rgb(0, 187, 187)\">10</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    330</span><span>     </span><span style=\"color:rgb(0, 187, 0)\">if</span><span> </span><span>error</span><span style=\"color:rgb(0, 0, 187)\">[</span><span style=\"color:rgb(0, 187, 187)\">0</span><span style=\"color:rgb(0, 0, 187)\">]</span><span style=\"color:rgb(0, 0, 187)\">:</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    331</span><span>         </span><span>six</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>reraise</span><span style=\"color:rgb(0, 0, 187)\">(</span><span style=\"color:rgb(0, 0, 187)\">*</span><span>error</span><span style=\"color:rgb(0, 0, 187)\">[</span><span style=\"color:rgb(0, 187, 187)\">0</span><span style=\"color:rgb(0, 0, 187)\">]</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n\n</span><span style=\"color:rgb(0, 187, 0)\">/usr/lib64/python3.7/threading.py</span><span> in </span><span style=\"color:rgb(0, 187, 187)\">wait</span><span style=\"color:rgb(0, 0, 187)\">(self, timeout)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    550</span><span>             </span><span>signaled</span><span> </span><span style=\"color:rgb(0, 0, 187)\">=</span><span> </span><span>self</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>_flag</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    551</span><span>             </span><span style=\"color:rgb(0, 187, 0)\">if</span><span> </span><span style=\"color:rgb(0, 187, 0)\">not</span><span> </span><span>signaled</span><span style=\"color:rgb(0, 0, 187)\">:</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">--&gt; 552</span><span style=\"color:rgb(187, 0, 0)\">                 </span><span>signaled</span><span> </span><span style=\"color:rgb(0, 0, 187)\">=</span><span> </span><span>self</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>_cond</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>wait</span><span style=\"color:rgb(0, 0, 187)\">(</span><span>timeout</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    553</span><span>             </span><span style=\"color:rgb(0, 187, 0)\">return</span><span> </span><span>signaled</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    554</span><span> </span><span>\n\n</span><span style=\"color:rgb(0, 187, 0)\">/usr/lib64/python3.7/threading.py</span><span> in </span><span style=\"color:rgb(0, 187, 187)\">wait</span><span style=\"color:rgb(0, 0, 187)\">(self, timeout)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    298</span><span>             </span><span style=\"color:rgb(0, 187, 0)\">else</span><span style=\"color:rgb(0, 0, 187)\">:</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    299</span><span>                 </span><span style=\"color:rgb(0, 187, 0)\">if</span><span> </span><span>timeout</span><span> </span><span style=\"color:rgb(0, 0, 187)\">&gt;</span><span> </span><span style=\"color:rgb(0, 187, 187)\">0</span><span style=\"color:rgb(0, 0, 187)\">:</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">--&gt; 300</span><span style=\"color:rgb(187, 0, 0)\">                     </span><span>gotit</span><span> </span><span style=\"color:rgb(0, 0, 187)\">=</span><span> </span><span>waiter</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>acquire</span><span style=\"color:rgb(0, 0, 187)\">(</span><span style=\"color:rgb(0, 187, 0)\">True</span><span style=\"color:rgb(0, 0, 187)\">,</span><span> </span><span>timeout</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    301</span><span>                 </span><span style=\"color:rgb(0, 187, 0)\">else</span><span style=\"color:rgb(0, 0, 187)\">:</span><span>\n</span><span style=\"color:rgb(0, 187, 0)\">    302</span><span>                     </span><span>gotit</span><span> </span><span style=\"color:rgb(0, 0, 187)\">=</span><span> </span><span>waiter</span><span style=\"color:rgb(0, 0, 187)\">.</span><span>acquire</span><span style=\"color:rgb(0, 0, 187)\">(</span><span style=\"color:rgb(0, 187, 0)\">False</span><span style=\"color:rgb(0, 0, 187)\">)</span><span>\n\n</span><span style=\"color:rgb(187, 0, 0)\">KeyboardInterrupt</span><span>: </span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[27]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#393A34\">%</span><span class=\"token\" style=\"color:#393A34\">%</span>time\n<span class=\"token\" style=\"color:#0000ff\">with</span> parallel_backend<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;dask&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    rgfc <span class=\"token\" style=\"color:#393A34\">=</span> RGFClassifier<span class=\"token\" style=\"color:#393A34\">(</span>max_leaf<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">5000</span><span class=\"token\" style=\"color:#393A34\">,</span> l2<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1e</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">,</span> learning_rate<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0.01</span><span class=\"token\" style=\"color:#393A34\">)</span>\n    rgfc<span class=\"token\" style=\"color:#393A34\">.</span>fit<span class=\"token\" style=\"color:#393A34\">(</span>X_train<span class=\"token\" style=\"color:#393A34\">,</span> Y_train<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs wOXyQ nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>CPU times: user 17.7 s, sys: 2.03 s, total: 19.8 s\nWall time: 6min 59s\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[ ]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">with</span> parallel_backend<span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;dask&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span>\n    rgf_prob_preds_train <span class=\"token\" style=\"color:#393A34\">=</span> rgfc<span class=\"token\" style=\"color:#393A34\">.</span>predict_proba<span class=\"token\" style=\"color:#393A34\">(</span>X_train<span class=\"token\" style=\"color:#393A34\">)</span>\n    rgf_prob_preds_test <span class=\"token\" style=\"color:#393A34\">=</span> rgfc<span class=\"token\" style=\"color:#393A34\">.</span>predict_proba<span class=\"token\" style=\"color:#393A34\">(</span>X_test<span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[ ]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># threshold probability for model test on all data = ~0.3</span>\nTEST_THRESHOLD_PROBA <span class=\"token\" style=\"color:#393A34\">=</span> <span class=\"token\" style=\"color:#36acaa\">0.5</span>\n\n<span class=\"token\" style=\"color:#008000;font-style:italic\"># how well did it fit on the test data</span>\nrgf_confmat_test <span class=\"token\" style=\"color:#393A34\">=</span> confusion_matrix<span class=\"token\" style=\"color:#393A34\">(</span>Y_test<span class=\"token\" style=\"color:#393A34\">,</span> rgf_prob_preds_test<span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">,</span> <span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span> <span class=\"token\" style=\"color:#393A34\">&gt;</span> TEST_THRESHOLD_PROBA<span class=\"token\" style=\"color:#393A34\">)</span>\nsns<span class=\"token\" style=\"color:#393A34\">.</span>heatmap<span class=\"token\" style=\"color:#393A34\">(</span>rgf_confmat_test <span class=\"token\" style=\"color:#393A34\">/</span> rgf_confmat_test<span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span>axis<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">,</span> keepdims<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            vmin<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            vmax<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            annot<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">,</span>\n            cmap<span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;Blues&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h2>Hyperparameter Tuning for RGF</h2></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p>The hyperparameter tuning is done using MLflow and OpenShift (see repos <a href=\"https://github.com/chauhankaranraj/experiment-tracking\">experiment-tracking</a> and <a href=\"https://github.com/chauhankaranraj/training\">training</a>). After tuning the hyperparameters, the RGF model performs very well on the dataset. </p>\n<p><strong>We conclude that RGF is the best model thus far.</strong></p>\n<p>The best parameters are as follows:\n1. l2 = 1e10\n2. learning_rate = 0.1\n3. loss = &quot;Log&quot;\n4. max_leaf = 5000\n5. others = default</p>\n<p>and the corresponding performance metrics on the test dataset (size: (0.2 x 82993, 67)) are as follows:\n1. log_loss = 0.003\n2. precision = 0.985\n3. recall = 0.941\n4. f1_score = 0.962</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><div class=\"sc-bwzfXH jsVRSS prompt\">[ ]</div><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:0.95em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"></code></pre></div></div></div></div>","fields":{"srcLink":"https://github.com/aicoe-aiops/ceph_drive_failure/blob/master/notebooks/step3a_clustering_and_binaryclf.ipynb"}}},"pageContext":{"id":"ac38d250-9295-5a52-9981-5d8d165321a7 >>> JupyterNotebook"}},"staticQueryHashes":["117426894","3000541721"]}