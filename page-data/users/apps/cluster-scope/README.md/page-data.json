{"componentChunkName":"component---src-templates-markdown-js","path":"/users/apps/cluster-scope/README.md","result":{"data":{"site":{"siteMetadata":{"title":"Operate First"}},"markdownRemark":{"id":"6391aabc-f5e4-55c9-a9e1-77609bd3fbbd","html":"<h1 id=\"cluster-management-application-organization\" style=\"position:relative;\"><a href=\"#cluster-management-application-organization\" aria-label=\"cluster management application organization permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cluster management application organization</h1>\n<p>This is just a short addendum to <a href=\"https://www.operate-first.cloud/blueprints/blueprint/docs/adr/0009-cluster-resources.md\">ADR 0009</a> declaring the direct consequences and organization structure of this <code class=\"language-text\">cluster-scope</code> application. These are the best practises we expect every maintainer who does changes to this application to follow.</p>\n<h2 id=\"application-folder-structure\" style=\"position:relative;\"><a href=\"#application-folder-structure\" aria-label=\"application folder structure permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Application folder structure</h2>\n<ul class=\"pf-c-list\">\n<li>\n<p><code class=\"language-text\">base</code>: Contains all the actual resource manifests which can be deployed to any clusters. Manifests are required to be stored in a format that can be applied to all the clusters (no cluster specific <code class=\"language-text\">.spec</code>s).</p>\n<ul class=\"pf-c-list\">\n<li><code class=\"language-text\">&lt;RESOURCE_KIND_PLURAL_NAME&gt;</code>: Each resource kind managed by this application has a folder using the resource name in plural format, e.g. <code class=\"language-text\">clusterroles</code> or <code class=\"language-text\">namespaces</code>.</li>\n<li>\n<p><code class=\"language-text\">&lt;RESOURCE_NAME&gt;</code>: The name of the resource deployed at cluster scope. It must match the resource <code class=\"language-text\">.metadata.name</code> in <code class=\"language-text\">&lt;RESOURCE_KIND_SINGULAR_NAME&gt;.yaml</code>. Since this resource is deployed on cluster scope, its name has to be unique.</p>\n<ul class=\"pf-c-list\">\n<li><code class=\"language-text\">kustomization.yaml</code>: Kustomization file including a single resource, which is a sibling file within the folder. Can pull in <code class=\"language-text\">components</code> for additional bootstrapping.</li>\n<li><code class=\"language-text\">&lt;RESOURCE_KIND_SINGULAR_NAME&gt;.yaml</code>: <strong>Single</strong> resource manifest with a <code class=\"language-text\">.spec</code> that can be deployed to all the clusters.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">components</code>: Bootstrapping components pulled into <code class=\"language-text\">base</code> (this is different to the standard usage in Kustomize!).</p>\n<ul class=\"pf-c-list\">\n<li><code class=\"language-text\">&lt;DESCRIPTIVE_COMPONENT_NAME&gt;</code>: Folder describing intention of the component. Can be a grouping folder for additional nested components (by the subject), e.g. <code class=\"language-text\">project-admin-rolebinding</code> component is expected to define project admin <code class=\"language-text\">RoleBinding</code> and within this folder there are nested components for each specific user group.</li>\n<li><code class=\"language-text\">kustomization.yaml</code>: Kustomization file including a all the resources required for this component. All resources are sibling files to this file.</li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">overlays</code>: Contains an overlay per managed cluster. Does not add any additional manifest. Only overlaying manifests from <code class=\"language-text\">base</code> is supported.</p>\n<ul class=\"pf-c-list\">\n<li><code class=\"language-text\">&lt;MANAGED_CLUSTER_NAME&gt;</code>: A folder per each managed cluster defining. Path to this folder is specified in the <code class=\"language-text\">Application</code> resource for cluster management application.</li>\n<li><code class=\"language-text\">kustomization.yaml</code>: Cluster specific Kustomization file with a list of all resources pulled from base. This resource list is ordered alphabetically so it matches the order as it appears in file tree.</li>\n<li>Additional overlayed files, secret generators etc.</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"creating-new-resources\" style=\"position:relative;\"><a href=\"#creating-new-resources\" aria-label=\"creating new resources permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating new resources</h2>\n<ol class=\"pf-c-list\">\n<li>Create the resource in <code class=\"language-text\">base</code> folder.</li>\n<li>Pull the resource in desired <code class=\"language-text\">overlay</code>s.</li>\n</ol>\n<h2 id=\"updating-existing-resource-in-base\" style=\"position:relative;\"><a href=\"#updating-existing-resource-in-base\" aria-label=\"updating existing resource in base permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Updating existing resource in base</h2>\n<p>If you desire to update a resource in <code class=\"language-text\">base</code>, please consider if your changes are not overlay/cluster specific. If it is, rather update the resource in your cluster overlay.</p>\n<p>If you think this change should be applied to all the clusters, please proceed to update it in the <code class=\"language-text\">base</code>. Verify what clusters are using this resource in their overlays and request an approver for all the effected clusters to review your PR.</p>\n<h2 id=\"updating-existing-resource-in-components\" style=\"position:relative;\"><a href=\"#updating-existing-resource-in-components\" aria-label=\"updating existing resource in components permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Updating existing resource in components</h2>\n<p>Updating a resource in a <code class=\"language-text\">component</code> requires you to verify all the usages of the component and what overlays are transitively affected. Please request review accordingly. This is similar to making changes to <code class=\"language-text\">base</code> resources.</p>","fields":{"srcLink":"https://github.com/operate-first/apps/blob/master/cluster-scope/README.md"},"frontmatter":{"title":"","description":null}}},"pageContext":{"id":"6391aabc-f5e4-55c9-a9e1-77609bd3fbbd"}},"staticQueryHashes":["117426894","3000541721"]}