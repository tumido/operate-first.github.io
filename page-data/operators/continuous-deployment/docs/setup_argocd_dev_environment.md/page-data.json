{"componentChunkName":"component---src-templates-markdown-js","path":"/operators/continuous-deployment/docs/setup_argocd_dev_environment.md","result":{"data":{"site":{"siteMetadata":{"title":"Operate First"}},"markdownRemark":{"id":"b5ddb24d-0284-5229-a758-59b345547747","html":"<h1 id=\"deploying-a-development-environment\" style=\"position:relative;\"><a href=\"#deploying-a-development-environment\" aria-label=\"deploying a development environment permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deploying a development environment</h1>\n<h2 id=\"prequisites\" style=\"position:relative;\"><a href=\"#prequisites\" aria-label=\"prequisites permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Prequisites</h2>\n<ul class=\"pf-c-list\">\n<li>An OCP 4.x Development cluster</li>\n<li>Must have cluster admin (not kube:admin)</li>\n</ul>\n<h2 id=\"instructions\" style=\"position:relative;\"><a href=\"#instructions\" aria-label=\"instructions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Instructions</h2>\n<p>Create the project <code class=\"language-text\">aicoe-argocd-dev</code> and <code class=\"language-text\">argocd-test</code>. The latter will be used\nfor deploying a dev application via ArgoCD.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">oc new-project argocd-test\noc new-project aicoe-argocd-dev</code></pre></div>\n<h3 id=\"deploy-argocd\" style=\"position:relative;\"><a href=\"#deploy-argocd\" aria-label=\"deploy argocd permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deploy ArgoCD</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> clone git@github.com:operate-first/continuous-deployment.git\n<span class=\"token builtin class-name\">cd</span> continuous-deployment\n\n<span class=\"token comment\"># Deploy Cluster objects</span>\nkustomize build manifests/crds --enable_alpha_plugins <span class=\"token operator\">|</span> oc apply -f -\n\n<span class=\"token comment\"># Deploy Non Cluster objects</span>\nkustomize build manifests/overlays/dev --enable_alpha_plugins <span class=\"token operator\">|</span> oc apply -f -</code></pre></div>\n<h2 id=\"configure-auth\" style=\"position:relative;\"><a href=\"#configure-auth\" aria-label=\"configure auth permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Configure Auth</h2>\n<p>Once deployed, there are some additional configurations, run this script:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">examples/configure_development.sh</code></pre></div>\n<p>The script needs to be run under a user with the cluster admin role, but not with <code class=\"language-text\">kube:admin</code>.</p>\n<p>Feel free to look inside the script for detailed comments on what configurations are applied.</p>\n<h2 id=\"cleanup\" style=\"position:relative;\"><a href=\"#cleanup\" aria-label=\"cleanup permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cleanup</h2>\n<p>Run the following commands to clean up your environment.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">kustomize build manifests/overlays/dev --enable_alpha_plugins | oc delete -f -\nkustomize build manifests/crds --enable_alpha_plugins | oc delete -f -\noc delete group dev-group\noc delete project argocd-test\noc delete project aicoe-argocd-dev</code></pre></div>\n<p>You may ignore the following error when removing secrets:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Error from server (NotFound): error when deleting &quot;STDIN&quot;: secrets &quot;argocd-dex-server-oauth-token&quot; not found\nError from server (NotFound): error when deleting &quot;STDIN&quot;: secrets &quot;dev-cluster-spec&quot; not found</code></pre></div>\n<h2 id=\"connecting-from-the-cli\" style=\"position:relative;\"><a href=\"#connecting-from-the-cli\" aria-label=\"connecting from the cli permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Connecting from the CLI</h2>\n<p>If you want to use the ArgoCD CLI, you can download it here: <a href=\"https://argoproj.github.io/argo-cd/cli_installation/\">https://argoproj.github.io/argo-cd/cli_installation/</a>.</p>\n<p>To use the <code class=\"language-text\">argocd</code> tool you need to login first. To login into an ArgoCD running in an environment such as OperateFirst you would first figure the route. Assuming you are logged in your cluster with <code class=\"language-text\">oc</code> you can do:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ARGOCD_ROUTE=$(oc get route argocd-server -o jsonpath=&#39;{.spec.host}&#39;)</code></pre></div>\n<p>then login:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">argocd --insecure --grpc-web login ${ARGOCD_ROUTE}:443 --sso</code></pre></div>\n<p>The login command will open a browser window to take you throught the SSO process. Then you can proceed with using the tool:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ argocd app list\nNAME            CLUSTER  NAMESPACE       PROJECT  STATUS     HEALTH   SYNCPOLICY  CONDITIONS       REPO                                       PATH                               TARGET\nargo                     opf-argo       default  Synced     Healthy  &lt;none&gt;      &lt;none&gt;           https://github.com/operate-first/apps.git  odh/overlays/quicklab/argo         HEAD\nceph                     opf-ceph        default  OutOfSync  Missing  &lt;none&gt;      &lt;none&gt;           https://github.com/operate-first/apps.git  ceph/overlays/quicklab             HEAD\nodh-operator             odh-operator    default  Unknown    Healthy  Auto-Prune  ComparisonError  https://github.com/operate-first/apps.git  odh/base/operator/                 HEAD\nopf-jupyterhub           opf-jupyterhub  default  Synced     Healthy  Auto-Prune  &lt;none&gt;           https://github.com/operate-first/apps.git  odh/overlays/quicklab/jupyterhub/  HEAD\nopf-superset             opf-superset    default  Synced     Healthy  Auto-Prune  &lt;none&gt;           https://github.com/operate-first/apps.git  odh/overlays/quicklab/superset     HEAD</code></pre></div>","fields":{"srcLink":"https://github.com/operate-first/continuous-deployment/blob/master/docs/setup_argocd_dev_environment.md"},"frontmatter":{"title":"","description":null}}},"pageContext":{"id":"b5ddb24d-0284-5229-a758-59b345547747"}},"staticQueryHashes":["117426894","3000541721"]}