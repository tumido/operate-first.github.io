{"componentChunkName":"component---src-templates-markdown-js","path":"/operators/continuous-deployment/docs/downstream/odh-install-crc.md","result":{"data":{"site":{"siteMetadata":{"title":"Operate First"}},"markdownRemark":{"id":"c9d8a43a-0d01-5b29-b0c9-a2a6e8ca6fdd","html":"<h1 id=\"installing-odh-using-argocd\" style=\"position:relative;\"><a href=\"#installing-odh-using-argocd\" aria-label=\"installing odh using argocd permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Installing ODH using ArgoCD</h1>\n<h2 id=\"preparation\" style=\"position:relative;\"><a href=\"#preparation\" aria-label=\"preparation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Preparation</h2>\n<p>First make sure that you have the OpenDataHub operator available in your OpenShift.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">oc get packagemanifests -n openshift-marketplace <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> opendatahub-operator</code></pre></div>\n<p>If it’s not present, then you need to troubleshoot the marketplace: <a href=\"https://github.com/operator-framework/operator-marketplace/issues/344\">https://github.com/operator-framework/operator-marketplace/issues/344</a></p>\n<p>Then we need to create a projects named <code class=\"language-text\">odh-operator</code> and <code class=\"language-text\">opf-*</code>. (The name of the project is hard-coded in the <code class=\"language-text\">kustomize</code> files in <a href=\"https://github.com/operate-first/odh\">https://github.com/operate-first/odh</a> and you can change is there using <code class=\"language-text\">kustomize</code>.)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">oc new-project odh-operator\noc new-project opf-<span class=\"token punctuation\">{</span>jupyterhub,superset<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Our ArgoCD SA <code class=\"language-text\">argocd-manager</code> needs to have access to the new project. On CRC I suggest giving <code class=\"language-text\">argocd-manager</code> access to all projects by creating a ClusterRoleBinding to a ClusterRole.</p>\n<p><code class=\"language-text\">oc apply -f examples/argocd-cluster-binding.yaml</code></p>\n<p>Then you need to change the <code class=\"language-text\">dev-cluster-spec</code> to include all projects/namespace. (This is done by actually removing the value of <code class=\"language-text\">namespace</code>).</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">oc patch secret dev-cluster-spec -n aicoe-argocd-dev --type<span class=\"token operator\">=</span><span class=\"token string\">'json'</span> -p<span class=\"token operator\">=</span><span class=\"token string\">\"[{'op': 'replace', 'path': '/data/namespaces', 'value':''}]\"</span></code></pre></div>\n<p>Be aware that if you change this value in the ArgoCD UI, you might loose the stored credentials for the cluster due to a bug in ArgoCD.</p>\n<h2 id=\"creating-the-argocd-applications\" style=\"position:relative;\"><a href=\"#creating-the-argocd-applications\" aria-label=\"creating the argocd applications permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating the ArgoCD applications</h2>\n<p>Now we can proceed with creating the ArgoCD Applications. We will create 2 applications:</p>\n<ol class=\"pf-c-list\">\n<li>The ODH operator. (Installs the ODH operator itself <code class=\"language-text\">odh-operator</code>.)</li>\n<li>The ODH deployment. (Installs ODH components into <code class=\"language-text\">opf-*</code>.)</li>\n</ol>\n<h3 id=\"creating-the-odh-operator\" style=\"position:relative;\"><a href=\"#creating-the-odh-operator\" aria-label=\"creating the odh operator permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating the ODH operator</h3>\n<p>You can create the Application resource from the command line using</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">oc apply -f examples/odh-operator-app.yaml</code></pre></div>\n<p>Or you can go to <a href=\"https://argocd-server-aicoe-argocd-dev.apps-crc.testing/applications\">https://argocd-server-aicoe-argocd-dev.apps-crc.testing/applications</a> and click “New App” and entering these values:</p>\n<table class=\"pf-c-table\">\n<thead>\n<tr>\n<th>Field</th>\n<th>Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Project:</td>\n<td>Default</td>\n</tr>\n<tr>\n<td>Cluster:</td>\n<td>dev-cluster (<a href=\"https://api.crc.testing.6443\">https://api.crc.testing.6443</a>)</td>\n</tr>\n<tr>\n<td>Namespace:</td>\n<td>odh-operator</td>\n</tr>\n<tr>\n<td>Repo URL:</td>\n<td><a href=\"https://github.com/operate-first/odh.git\">https://github.com/operate-first/odh.git</a></td>\n</tr>\n<tr>\n<td>Target revision:</td>\n<td>HEAD</td>\n</tr>\n<tr>\n<td>Path:</td>\n<td>operator/base</td>\n</tr>\n</tbody>\n</table>\n<p>This creates an app from definition in the repo under the path <code class=\"language-text\">odh-operator/base</code> and deploys it to the <code class=\"language-text\">odh-operator</code> namespace on the <code class=\"language-text\">dev-cluster</code>.</p>\n<p>This app is all about deploying the Open Data Hub operator to your cluster.</p>\n<p>Please note that the namespace is also hard-coded in the repo so changing it requires changing files in the repo.</p>\n<p>Create the app and you will see Argo deploying resources:\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f7abffec7cc29853f46c01d5464a0735/8cae4/odh-operator.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.24324324324324%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABdUlEQVQoz0VQ2U7DMBDMt6OWVjmg5folHnipVIqguZvEjm87aQuBNGHTcFgra/YY74wt21tcXS0m09l8bjuOazuu43iu68EN2Lad6eXsYjJdLm+8+9vbh7u5481sd3Fz53rX1uNmu96GwuzDonz2o2c/Xvvx6jXc+MlLmGyCBNKP5rPv+67/OU17Mk1bnzprR4ip6r7rUiG2BTKmpsasUEakFMpIbXRVf7Vt/386GB6RhYVmuibSAMiZRFyX0mRUZFRmRBRMQToUhcFSwwwE4goqRBnrLcVhwfyMBAWFABye7zOmEWJjHQZizDHXmCug5UxFiFqvSRFjBntyKtNSJJjBw1QaqqodlTGiAxaDnLTkiMliUKdixFLMrKdNsI4zXtX7Y1OqKshKJGR9OFaHI0wHGa72h/ePBqzFiCOhwSDTFWweyEE+6BmlhoiNUuG7BmZOo4KCf3AYnVspETkRQIMWiPonQ/svRue/ePwLGv7Wx5afk28cXdad1bvGWwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ODH operator\"\n        title=\"ODH operator\"\n        src=\"/static/f7abffec7cc29853f46c01d5464a0735/fcda8/odh-operator.png\"\n        srcset=\"/static/f7abffec7cc29853f46c01d5464a0735/12f09/odh-operator.png 148w,\n/static/f7abffec7cc29853f46c01d5464a0735/e4a3f/odh-operator.png 295w,\n/static/f7abffec7cc29853f46c01d5464a0735/fcda8/odh-operator.png 590w,\n/static/f7abffec7cc29853f46c01d5464a0735/efc66/odh-operator.png 885w,\n/static/f7abffec7cc29853f46c01d5464a0735/8cae4/odh-operator.png 1109w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3 id=\"creating-the-odh-deployment\" style=\"position:relative;\"><a href=\"#creating-the-odh-deployment\" aria-label=\"creating the odh deployment permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating the ODH deployment</h3>\n<p>Again, either from the command line:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">oc apply -f examples/odh-deployment-app.yaml</code></pre></div>\n<p>or again going to <a href=\"https://argocd-server-aicoe-argocd-dev.apps-crc.testing/applications\">https://argocd-server-aicoe-argocd-dev.apps-crc.testing/applications</a>, clicking “New App” and entering these values:</p>\n<table class=\"pf-c-table\">\n<thead>\n<tr>\n<th>Field</th>\n<th>Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Project:</td>\n<td>Default</td>\n</tr>\n<tr>\n<td>Cluster:</td>\n<td>dev-cluster (<a href=\"https://api.crc.testing.6443\">https://api.crc.testing.6443</a>)</td>\n</tr>\n<tr>\n<td>Namespace:</td>\n<td>opf-jupyterhub</td>\n</tr>\n<tr>\n<td>Repo URL:</td>\n<td><a href=\"https://github.com/operate-first/odh.git\">https://github.com/operate-first/odh.git</a></td>\n</tr>\n<tr>\n<td>Target revision:</td>\n<td>HEAD</td>\n</tr>\n<tr>\n<td>Path:</td>\n<td>kfdef/jupyterhub</td>\n</tr>\n</tbody>\n</table>\n<table class=\"pf-c-table\">\n<thead>\n<tr>\n<th>Field</th>\n<th>Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Project:</td>\n<td>Default</td>\n</tr>\n<tr>\n<td>Cluster:</td>\n<td>dev-cluster (<a href=\"https://api.crc.testing.6443\">https://api.crc.testing.6443</a>)</td>\n</tr>\n<tr>\n<td>Namespace:</td>\n<td>opf-superset</td>\n</tr>\n<tr>\n<td>Repo URL:</td>\n<td><a href=\"https://github.com/operate-first/odh.git\">https://github.com/operate-first/odh.git</a></td>\n</tr>\n<tr>\n<td>Target revision:</td>\n<td>HEAD</td>\n</tr>\n<tr>\n<td>Path:</td>\n<td>kfdef/superset</td>\n</tr>\n</tbody>\n</table>\n<p>This is about the actual deployment of Open Data Hub to your cluster.</p>\n<p>Based on the content of <code class=\"language-text\">kfdef.yaml</code> (you will see components of ODH being created similar to:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/12cee511a47d5955948e2ed6b1e4432c/b6e34/odh-deployment.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.75675675675676%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAB2klEQVQoz21RyXLTQBDV54Y7B8pxEVwEvsPxEtmVhBDDdyQcIDgWspbRMvuMNNpsgUWrXKE4ZOpJ6hn1636vx3p1cjJd3kym88lktrCXl/ZiDo+9tC8Xc3sB4XQ2H48vrq6ubz+vPn1d3a2+jGf2ZHl9c3tnfTwf3TueF+Fi1/4Mo++Ot/bQN9e732yf/MhFyaMbRoR1XXc4HLrnBdGfrrNeD07zpqmqerff+0LEQtV1g7QKhVSZ0XmRF1VZ1U2z27dt+7tfxw9srcFgSKRBVAIiqkIqQyIQlk6ItwnzUx4ziYUmMoMEKjMoV5SVyAycW4Ph24BKN6a/ngGcDcKPfgKHARZcG5UXypTblMVUQmzKimUG0qw3g9OHTbBGCRTLyzrm2o0JtNKmoto4EYkIBwJsPcz9lMnMNLuWaRNg3pPdhLsJRUQCQKcHajF3ewm9CnARc5Uw5aXggiEqYqaAiYjoZSMG3eg/AAHeP7y49xKREHOuc11UPhYgKuVKmxKrHIpaw7N3AVVHzv9YB4mDiJdwsA2DhGmBENAVUZlyHWLRk89G718kP4UYDEPnhMmiqut9CxfhRgQGnpcNllnveXT+ISAvkIHpIAxImCjqpmp2QS+bHu8F/kLOXyHsPmrlQAEeAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ODH operator\"\n        title=\"ODH operator\"\n        src=\"/static/12cee511a47d5955948e2ed6b1e4432c/fcda8/odh-deployment.png\"\n        srcset=\"/static/12cee511a47d5955948e2ed6b1e4432c/12f09/odh-deployment.png 148w,\n/static/12cee511a47d5955948e2ed6b1e4432c/e4a3f/odh-deployment.png 295w,\n/static/12cee511a47d5955948e2ed6b1e4432c/fcda8/odh-deployment.png 590w,\n/static/12cee511a47d5955948e2ed6b1e4432c/efc66/odh-deployment.png 885w,\n/static/12cee511a47d5955948e2ed6b1e4432c/b6e34/odh-deployment.png 1103w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>You can find routes for your new ODH instance by running:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ oc get routes -n opf-jupyterhub\nNAME         HOST/PORT                                               <span class=\"token environment constant\">PATH</span>   SERVICES     PORT       TERMINATION     WILDCARD\njupyterhub   jupyterhub-opf-jupyterhub.apps-crc.testing          jupyterhub   <span class=\"token number\">8080</span>-tcp   edge/Redirect   None\n\n$ oc get routes -n opf-superset\nNAME         HOST/PORT                                               <span class=\"token environment constant\">PATH</span>   SERVICES     PORT       TERMINATION     WILDCARD\nsuperset     superset-opf-superset.apps-crc.testing              superset     <span class=\"token number\">8088</span>-tcp                   None</code></pre></div>\n<p>To alter components deployed or anything else about the configuration fork <a href=\"https://github.com/operate-first/odh\">https://github.com/operate-first/odh</a> and replace references to this repo with your own fork.</p>","fields":{"srcLink":"https://github.com/operate-first/continuous-deployment/blob/master/docs/downstream/odh-install-crc.md"},"frontmatter":{"title":"","description":null}}},"pageContext":{"id":"c9d8a43a-0d01-5b29-b0c9-a2a6e8ca6fdd"}},"staticQueryHashes":["117426894","3000541721"]}